<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Spatial autocorrelation and dependence | GEOG0114: Principles of Spatial Analysis (2023/24)</title>
  <meta name="description" content="GEOG0114: Principles of Spatial Analysis" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Spatial autocorrelation and dependence | GEOG0114: Principles of Spatial Analysis (2023/24)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="GEOG0114: Principles of Spatial Analysis" />
  <meta name="github-repo" content="UCLPG-MSC-SGDS/GEOG0114" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Spatial autocorrelation and dependence | GEOG0114: Principles of Spatial Analysis (2023/24)" />
  
  <meta name="twitter:description" content="GEOG0114: Principles of Spatial Analysis" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="graphical-representation-of-spatial-data.html"/>
<link rel="next" href="suitability-mapping-part-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="assets/custom.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo">
<a href="https://www.ucl.ac.uk/module-catalogue/modules/GEOG0114"><img src="images/general/ucl_logo.png">
</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i>Structure</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#moodle"><i class="fa fa-check"></i>Moodle</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#module-tutors-and-contacts-for-geog0114"><i class="fa fa-check"></i>Module tutors and contacts for GEOG0114</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html"><i class="fa fa-check"></i>Reading List for GEOG0114 2023/24</a>
<ul>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-1-spatial-analysis-for-data-science"><i class="fa fa-check"></i>Week 1: Spatial analysis for data science</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-2-graphical-representation-of-spatial-data"><i class="fa fa-check"></i>Week 2: Graphical representation of spatial data</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-3-spatial-autocorrelation"><i class="fa fa-check"></i>Week 3: Spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-4-suitability-mapping-part-1"><i class="fa fa-check"></i>Week 4: Suitability Mapping (Part 1)</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-5-suitability-mapping-part-2"><i class="fa fa-check"></i>Week 5: Suitability Mapping (Part 2)</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-6-geostatistical-modelling"><i class="fa fa-check"></i>Week 6: Geostatistical Modelling</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-9-spatial-models-part-1"><i class="fa fa-check"></i>Week 9: Spatial Models (Part 1)</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-10-spatial-models-part-2"><i class="fa fa-check"></i>Week 10: Spatial Models (Part 2)</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="installation-of-r-and-rstudio.html"><a href="installation-of-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Installation of R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="installation-of-r-and-rstudio.html"><a href="installation-of-r-and-rstudio.html#what-is-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> What is R and RStudio?</a></li>
<li class="chapter" data-level="1.2" data-path="installation-of-r-and-rstudio.html"><a href="installation-of-r-and-rstudio.html#downloading-and-install-r-and-rstudio-on-to-your-laptop"><i class="fa fa-check"></i><b>1.2</b> Downloading and install R and RStudio on to your laptop</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="installation-of-r-and-rstudio.html"><a href="installation-of-r-and-rstudio.html#installation-for-macos-users"><i class="fa fa-check"></i><b>1.2.1</b> Installation for MacOS users</a></li>
<li class="chapter" data-level="1.2.2" data-path="installation-of-r-and-rstudio.html"><a href="installation-of-r-and-rstudio.html#installation-for-windows-users"><i class="fa fa-check"></i><b>1.2.2</b> Installation for Windows users</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html"><i class="fa fa-check"></i><b>2</b> Spatial analysis for data sciences</a>
<ul>
<li class="chapter" data-level="2.1" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#lecture-video-length-010001"><i class="fa fa-check"></i><b>2.1.1</b> Lecture video (Length: 01:00:01)</a></li>
<li class="chapter" data-level="2.1.2" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#computer-practical-video-length-015949"><i class="fa fa-check"></i><b>2.1.2</b> Computer practical video (Length: 01:59:49)</a></li>
<li class="chapter" data-level="2.1.3" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#learning-outcomes"><i class="fa fa-check"></i><b>2.1.3</b> Learning outcomes</a></li>
<li class="chapter" data-level="2.1.4" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#becoming-familiar-with-the-panels-in-rstudio"><i class="fa fa-check"></i><b>2.1.4</b> Becoming familiar with the panels in RStudio</a></li>
<li class="chapter" data-level="2.1.5" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#using-r-console-as-a-calculator"><i class="fa fa-check"></i><b>2.1.5</b> Using R Console as a Calculator</a></li>
<li class="chapter" data-level="2.1.6" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#creating-basic-objects-and-assigning-values-to-it"><i class="fa fa-check"></i><b>2.1.6</b> Creating basic objects and assigning values to it</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#basics-of-managing-data-in-rstudio"><i class="fa fa-check"></i><b>2.2</b> Basics of managing data in RStudio</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#how-do-we-enter-data-into-rstudio"><i class="fa fa-check"></i><b>2.2.1</b> How do we enter data into RStudio?</a></li>
<li class="chapter" data-level="2.2.2" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#how-do-we-create-a-variable-based-on-other-existing-variables-in-our-data-frame"><i class="fa fa-check"></i><b>2.2.2</b> How do we create a variable based on other existing variables in our data frame?</a></li>
<li class="chapter" data-level="2.2.3" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#how-do-we-set-the-working-directory-in-our-computer-by-connecting-our-folder-to-rstudio-with-the-setwd-function"><i class="fa fa-check"></i><b>2.2.3</b> How do we set the working directory in our computer by connecting our folder to RStudio with the <code>setwd()</code> function?</a></li>
<li class="chapter" data-level="2.2.4" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#how-do-we-import-merge-and-export-csv-data-with-rstudio"><i class="fa fa-check"></i><b>2.2.4</b> How do we import, merge and export CSV data with RStudio?</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#basic-visualisation-of-spatial-data-in-rstudio"><i class="fa fa-check"></i><b>2.3</b> Basic visualisation of spatial data in RStudio</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#installing-packages-into-rstudio"><i class="fa fa-check"></i><b>2.3.1</b> Installing packages into RStudio</a></li>
<li class="chapter" data-level="2.3.2" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#adding-shapefiles-in-rstudio"><i class="fa fa-check"></i><b>2.3.2</b> Adding shapefiles in RStudio</a></li>
<li class="chapter" data-level="2.3.3" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#mapping-with-tmap-functions-in-rstudio"><i class="fa fa-check"></i><b>2.3.3</b> Mapping with ‘tmap’ functions in RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#references"><i class="fa fa-check"></i><b>2.4</b> References</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#recommended-reading-see-reading-list"><i class="fa fa-check"></i><b>2.4.1</b> Recommended reading (see reading list)</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#data-sources"><i class="fa fa-check"></i><b>2.5</b> Data Sources</a></li>
<li class="chapter" data-level="2.6" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#practical-homework"><i class="fa fa-check"></i><b>2.6</b> Practical homework</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html"><i class="fa fa-check"></i><b>3</b> Graphical representation of spatial data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#lecture-video-length-4313"><i class="fa fa-check"></i><b>3.1.1</b> Lecture video (Length: 43:13)</a></li>
<li class="chapter" data-level="3.1.2" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#computer-practical-video-length-015948"><i class="fa fa-check"></i><b>3.1.2</b> Computer practical video (Length: 01:59:48)</a></li>
<li class="chapter" data-level="3.1.3" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#learning-outcomes-1"><i class="fa fa-check"></i><b>3.1.3</b> Learning outcomes</a></li>
<li class="chapter" data-level="3.1.4" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#getting_started_w03"><i class="fa fa-check"></i><b>3.1.4</b> Getting started</a></li>
<li class="chapter" data-level="3.1.5" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#datasets-setting-up-the-work-directory"><i class="fa fa-check"></i><b>3.1.5</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="3.1.6" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#loading-and-installing-packages"><i class="fa fa-check"></i><b>3.1.6</b> Loading and installing packages</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#case_study_w03"><i class="fa fa-check"></i><b>3.2</b> Case study</a></li>
<li class="chapter" data-level="3.3" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#loading_data_w03"><i class="fa fa-check"></i><b>3.3</b> Loading our data sets for case study</a></li>
<li class="chapter" data-level="3.4" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#data-processing"><i class="fa fa-check"></i><b>3.4</b> Data Processing</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#reprojecting"><i class="fa fa-check"></i><b>3.4.1</b> Reprojecting</a></li>
<li class="chapter" data-level="3.4.2" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#dissolving"><i class="fa fa-check"></i><b>3.4.2</b> Dissolving</a></li>
<li class="chapter" data-level="3.4.3" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#subsetting"><i class="fa fa-check"></i><b>3.4.3</b> Subsetting</a></li>
<li class="chapter" data-level="3.4.4" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#unioning"><i class="fa fa-check"></i><b>3.4.4</b> Unioning</a></li>
<li class="chapter" data-level="3.4.5" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#clipping"><i class="fa fa-check"></i><b>3.4.5</b> Clipping</a></li>
<li class="chapter" data-level="3.4.6" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#attribute-selection"><i class="fa fa-check"></i><b>3.4.6</b> Attribute selection</a></li>
<li class="chapter" data-level="3.4.7" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#buffering"><i class="fa fa-check"></i><b>3.4.7</b> Buffering</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#greenspace-in-london"><i class="fa fa-check"></i><b>3.5</b> Greenspace in London</a></li>
<li class="chapter" data-level="3.6" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#attributions_w03"><i class="fa fa-check"></i><b>3.6</b> Attributions</a></li>
<li class="chapter" data-level="3.7" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#reading_w03"><i class="fa fa-check"></i><b>3.7</b> References (see reading list)</a></li>
<li class="chapter" data-level="3.8" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#data-sources-1"><i class="fa fa-check"></i><b>3.8</b> Data Sources</a></li>
<li class="chapter" data-level="3.9" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#practical-homework-1"><i class="fa fa-check"></i><b>3.9</b> Practical homework</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html"><i class="fa fa-check"></i><b>4</b> Spatial autocorrelation and dependence</a>
<ul>
<li class="chapter" data-level="4.1" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#lecture-video-length-010642"><i class="fa fa-check"></i><b>4.1.1</b> Lecture video (Length: 01:06:42)</a></li>
<li class="chapter" data-level="4.1.2" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#computer-practical-video-length-020001"><i class="fa fa-check"></i><b>4.1.2</b> Computer practical video (Length: 02:00:01)</a></li>
<li class="chapter" data-level="4.1.3" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#learning-outcomes-2"><i class="fa fa-check"></i><b>4.1.3</b> Learning outcomes</a></li>
<li class="chapter" data-level="4.1.4" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#getting-started"><i class="fa fa-check"></i><b>4.1.4</b> Getting started</a></li>
<li class="chapter" data-level="4.1.5" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#datasets-setting-up-the-work-directory-1"><i class="fa fa-check"></i><b>4.1.5</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="4.1.6" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#loading-and-installing-packages-1"><i class="fa fa-check"></i><b>4.1.6</b> Loading and installing packages</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#case-study"><i class="fa fa-check"></i><b>4.2</b> Case study</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#neighbours"><i class="fa fa-check"></i><b>4.2.1</b> Neighbours</a></li>
<li class="chapter" data-level="4.2.2" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#theft-in-camden"><i class="fa fa-check"></i><b>4.2.2</b> Theft in Camden</a></li>
<li class="chapter" data-level="4.2.3" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#global-morans-i"><i class="fa fa-check"></i><b>4.2.3</b> Global Moran’s I</a></li>
<li class="chapter" data-level="4.2.4" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#local-morans-i-or-lisa"><i class="fa fa-check"></i><b>4.2.4</b> Local Moran’s I (or LISA)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#attributions"><i class="fa fa-check"></i><b>4.3</b> Attributions</a></li>
<li class="chapter" data-level="4.4" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#references-see-reading-list"><i class="fa fa-check"></i><b>4.4</b> References (see reading list)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html"><i class="fa fa-check"></i><b>5</b> Suitability Mapping: Part 1</a>
<ul>
<li class="chapter" data-level="5.1" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#lecture-video-tbc"><i class="fa fa-check"></i><b>5.1.1</b> Lecture video (TBC)</a></li>
<li class="chapter" data-level="5.1.2" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#computer-practical-video-length-020001-1"><i class="fa fa-check"></i><b>5.1.2</b> Computer practical video (Length: 02:00:01)</a></li>
<li class="chapter" data-level="5.1.3" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#learning-outcomes-3"><i class="fa fa-check"></i><b>5.1.3</b> Learning outcomes</a></li>
<li class="chapter" data-level="5.1.4" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#datasets-setting-up-the-work-directory-2"><i class="fa fa-check"></i><b>5.1.4</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="5.1.5" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#loading-and-installing-packages-2"><i class="fa fa-check"></i><b>5.1.5</b> Loading and installing packages</a></li>
<li class="chapter" data-level="5.1.6" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#loading-datasets"><i class="fa fa-check"></i><b>5.1.6</b> Loading datasets</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#suitability-mapping-using-simple-overlays"><i class="fa fa-check"></i><b>5.2</b> Suitability mapping using Simple Overlays</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#setting-up-binary-classification-on-raster"><i class="fa fa-check"></i><b>5.2.1</b> Setting up binary classification on raster</a></li>
<li class="chapter" data-level="5.2.2" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#finding-areas-of-suitability-by-multiplying-the-binary-rasters"><i class="fa fa-check"></i><b>5.2.2</b> Finding areas of suitability by multiplying the binary rasters</a></li>
<li class="chapter" data-level="5.2.3" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#finding-areas-of-suitability-by-summing-the-binary-rasters"><i class="fa fa-check"></i><b>5.2.3</b> Finding areas of suitability by summing the binary rasters</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#analytical-hierarchy-process-ahp"><i class="fa fa-check"></i><b>5.3</b> Analytical Hierarchy Process (AHP)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#standardizing-the-raster-variables-to-the-same-scale-from-1-to-10"><i class="fa fa-check"></i><b>5.3.1</b> Standardizing the raster variables to the same scale (from 1 to 10)</a></li>
<li class="chapter" data-level="5.3.2" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#determining-the-weight-of-each-variable-using-saatys-ahp"><i class="fa fa-check"></i><b>5.3.2</b> Determining the weight of each variable using Saaty’s AHP</a></li>
<li class="chapter" data-level="5.3.3" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#weighted-linear-combination-wlc-and-derivation-of-suitability-maps-based-from-ahp-analysis"><i class="fa fa-check"></i><b>5.3.3</b> Weighted Linear Combination (WLC) and derivation of Suitability Maps based from AHP analysis</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#references-see-reading-list-1"><i class="fa fa-check"></i><b>5.4</b> References (see reading list)</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#recommended-reading"><i class="fa fa-check"></i><b>5.4.1</b> Recommended reading</a></li>
<li class="chapter" data-level="5.4.2" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#data-sources-2"><i class="fa fa-check"></i><b>5.4.2</b> Data Sources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html"><i class="fa fa-check"></i><b>6</b> Suitability Mapping: Part 2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#lecture-video-length-010642-1"><i class="fa fa-check"></i><b>6.1.1</b> Lecture video (Length: 01:06:42)</a></li>
<li class="chapter" data-level="6.1.2" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#computer-practical-video-length-020001-2"><i class="fa fa-check"></i><b>6.1.2</b> Computer practical video (Length 02:00:01)</a></li>
<li class="chapter" data-level="6.1.3" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#learning-outcomes-4"><i class="fa fa-check"></i><b>6.1.3</b> Learning outcomes</a></li>
<li class="chapter" data-level="6.1.4" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#datasets-setting-up-the-work-directory-3"><i class="fa fa-check"></i><b>6.1.4</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="6.1.5" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#loading-and-installing-packages-3"><i class="fa fa-check"></i><b>6.1.5</b> Loading and installing packages</a></li>
<li class="chapter" data-level="6.1.6" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#loading-datasets-1"><i class="fa fa-check"></i><b>6.1.6</b> Loading datasets</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#data-preparation-for-the-maxent-analysis"><i class="fa fa-check"></i><b>6.2</b> Data preparation for the MAXENT analysis</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#creating-a-multi-band-raster-using-the-stack-function"><i class="fa fa-check"></i><b>6.2.1</b> Creating a multi-band raster using the stack() function</a></li>
<li class="chapter" data-level="6.2.2" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#preparing-data-for-pseudo-background-points-as-absence"><i class="fa fa-check"></i><b>6.2.2</b> Preparing data for pseudo-background points as absence</a></li>
<li class="chapter" data-level="6.2.3" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#extraction-of-all-raster-values-from-predictor-variables-onto-presence-absence-points"><i class="fa fa-check"></i><b>6.2.3</b> Extraction of all raster values from predictor variables onto presence-absence points</a></li>
<li class="chapter" data-level="6.2.4" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#preparation-of-training-test-data-for-prediction-model-cross-validation"><i class="fa fa-check"></i><b>6.2.4</b> Preparation of training &amp; test data for prediction &amp; model cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#maxent-analysis"><i class="fa fa-check"></i><b>6.3</b> MAXENT Analysis</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#examination-of-the-predictors-contribution-and-response-curves"><i class="fa fa-check"></i><b>6.3.1</b> Examination of the predictor’s contribution and response curves</a></li>
<li class="chapter" data-level="6.3.2" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#model-validation"><i class="fa fa-check"></i><b>6.3.2</b> Model validation</a></li>
<li class="chapter" data-level="6.3.3" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#mapping-the-predicted-probability-and-suitability"><i class="fa fa-check"></i><b>6.3.3</b> Mapping the predicted probability and suitability</a></li>
<li class="chapter" data-level="6.3.4" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#supplementary-code-for-4-fold-analysis"><i class="fa fa-check"></i><b>6.3.4</b> Supplementary code for 4-fold analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#attributions-1"><i class="fa fa-check"></i><b>6.4</b> Attributions</a></li>
<li class="chapter" data-level="6.5" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#references-see-reading-list-2"><i class="fa fa-check"></i><b>6.5</b> References (see reading list)</a></li>
<li class="chapter" data-level="6.6" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#data-sources-3"><i class="fa fa-check"></i><b>6.6</b> Data Sources</a></li>
<li class="chapter" data-level="6.7" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#practical-homework-2"><i class="fa fa-check"></i><b>6.7</b> Practical homework</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html"><i class="fa fa-check"></i><b>7</b> Geostatistical Modelling</a>
<ul>
<li class="chapter" data-level="7.1" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#introduction-5"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#lecture-video-length-010617"><i class="fa fa-check"></i><b>7.1.1</b> Lecture video (Length: 01:06:17)</a></li>
<li class="chapter" data-level="7.1.2" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#computer-practical-video-length-020001-3"><i class="fa fa-check"></i><b>7.1.2</b> Computer practical video (Length: 02:00:01)</a></li>
<li class="chapter" data-level="7.1.3" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#learning-objectives"><i class="fa fa-check"></i><b>7.1.3</b> Learning objectives</a></li>
<li class="chapter" data-level="7.1.4" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#datasets-setting-up-the-work-directory-4"><i class="fa fa-check"></i><b>7.1.4</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="7.1.5" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#loading-and-installing-packages-4"><i class="fa fa-check"></i><b>7.1.5</b> Loading and installing packages</a></li>
<li class="chapter" data-level="7.1.6" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#loading-datasets-2"><i class="fa fa-check"></i><b>7.1.6</b> Loading datasets</a></li>
<li class="chapter" data-level="7.1.7" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#data-preparation"><i class="fa fa-check"></i><b>7.1.7</b> Data preparation</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#semivariogram-analysis"><i class="fa fa-check"></i><b>7.2</b> Semivariogram analysis</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#plotting-the-empirical-semivariogram"><i class="fa fa-check"></i><b>7.2.1</b> Plotting the Empirical Semivariogram</a></li>
<li class="chapter" data-level="7.2.2" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#plotting-the-theoretical-semivariogram"><i class="fa fa-check"></i><b>7.2.2</b> Plotting the Theoretical Semivariogram</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#kriging-modelling-null"><i class="fa fa-check"></i><b>7.3</b> Kriging modelling (null)</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#building-a-blank-raster-template"><i class="fa fa-check"></i><b>7.3.1</b> Building a blank raster template</a></li>
<li class="chapter" data-level="7.3.2" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#implementing-the-spatial-interpolation-on-blank-template-using-kriging"><i class="fa fa-check"></i><b>7.3.2</b> Implementing the spatial interpolation on blank template using Kriging</a></li>
<li class="chapter" data-level="7.3.3" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#how-to-export-the-results-as-.tiff-format-thematic-visualisation-in-tmap"><i class="fa fa-check"></i><b>7.3.3</b> How to export the results as .tiff format thematic visualisation in <code>tmap</code></a></li>
<li class="chapter" data-level="7.3.4" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#thematic-visualisation-of-raster-data-using-tmap"><i class="fa fa-check"></i><b>7.3.4</b> Thematic visualisation of raster data using <code>tmap</code></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#kriging-modelling-non-null"><i class="fa fa-check"></i><b>7.4</b> Kriging modelling (non-null)</a></li>
<li class="chapter" data-level="7.5" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#references-see-reading-list-3"><i class="fa fa-check"></i><b>7.5</b> References (see reading list)</a></li>
<li class="chapter" data-level="7.6" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#data-sources-4"><i class="fa fa-check"></i><b>7.6</b> Data Sources</a></li>
<li class="chapter" data-level="7.7" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#practical-homework-3"><i class="fa fa-check"></i><b>7.7</b> Practical homework</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html"><i class="fa fa-check"></i><b>8</b> Spatial Models: Part 1</a>
<ul>
<li class="chapter" data-level="8.1" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#introduction-6"><i class="fa fa-check"></i><b>8.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#lecture-video-length-004147"><i class="fa fa-check"></i><b>8.1.1</b> Lecture video (Length: 00:41:47)</a></li>
<li class="chapter" data-level="8.1.2" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#computer-practical-video-length-020001-4"><i class="fa fa-check"></i><b>8.1.2</b> Computer practical video (Length: 02:00:01)</a></li>
<li class="chapter" data-level="8.1.3" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#learning-objective"><i class="fa fa-check"></i><b>8.1.3</b> Learning objective</a></li>
<li class="chapter" data-level="8.1.4" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#datasets-setting-up-the-work-directory-5"><i class="fa fa-check"></i><b>8.1.4</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="8.1.5" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#loading-and-installing-packages-5"><i class="fa fa-check"></i><b>8.1.5</b> Loading and installing packages</a></li>
<li class="chapter" data-level="8.1.6" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#loading-datasets-3"><i class="fa fa-check"></i><b>8.1.6</b> Loading datasets</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#diagnostics-of-residuals"><i class="fa fa-check"></i><b>8.2</b> Diagnostics of residuals</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#reporting-basic-summary-statistical-measures"><i class="fa fa-check"></i><b>8.2.1</b> Reporting basic summary statistical measures</a></li>
<li class="chapter" data-level="8.2.2" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#reporting-the-spatial-distribution-of-our-variables"><i class="fa fa-check"></i><b>8.2.2</b> Reporting the spatial distribution of our variables</a></li>
<li class="chapter" data-level="8.2.3" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#fitting-a-non-spatial-linear-regression-on-spatial-data-checking-the-residuals"><i class="fa fa-check"></i><b>8.2.3</b> Fitting a non-spatial Linear Regression on spatial data &amp; checking the residuals</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#spatial-regression-models"><i class="fa fa-check"></i><b>8.3</b> Spatial Regression Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#model-formation-for-spatial-lag-or-error-models"><i class="fa fa-check"></i><b>8.3.1</b> Model formation for spatial lag or error models</a></li>
<li class="chapter" data-level="8.3.2" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#spatial-lag-model-lagged-on-the-dependent-variable"><i class="fa fa-check"></i><b>8.3.2</b> Spatial Lag Model lagged on the dependent variable</a></li>
<li class="chapter" data-level="8.3.3" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#spatial-error-models"><i class="fa fa-check"></i><b>8.3.3</b> Spatial Error Models</a></li>
<li class="chapter" data-level="8.3.4" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#using-a-spatially-lagged-model-based-on-independent-variables"><i class="fa fa-check"></i><b>8.3.4</b> Using a Spatially lagged model based on independent variables</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#references-see-reading-list-4"><i class="fa fa-check"></i><b>8.4</b> References (see reading list)</a></li>
<li class="chapter" data-level="8.5" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#data-sources-5"><i class="fa fa-check"></i><b>8.5</b> Data Sources</a></li>
<li class="chapter" data-level="8.6" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#useful-videos"><i class="fa fa-check"></i><b>8.6</b> Useful videos</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html"><i class="fa fa-check"></i><b>9</b> Spatial Models: Part 2</a>
<ul>
<li class="chapter" data-level="9.1" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#computer-practical-video-length-015753"><i class="fa fa-check"></i><b>9.1</b> Computer practical video (Length: 01:57:53)</a></li>
<li class="chapter" data-level="9.2" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#introduction-7"><i class="fa fa-check"></i><b>9.2</b> Introduction</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#learning-outcomes-5"><i class="fa fa-check"></i><b>9.2.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="9.2.2" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#datasets-setting-up-the-work-directory-6"><i class="fa fa-check"></i><b>9.2.2</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="9.2.3" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#installing-packages"><i class="fa fa-check"></i><b>9.2.3</b> Installing packages</a></li>
<li class="chapter" data-level="9.2.4" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#loading-datasets-4"><i class="fa fa-check"></i><b>9.2.4</b> Loading datasets</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#implementing-the-linear-regression-model"><i class="fa fa-check"></i><b>9.3</b> Implementing the Linear Regression model</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#obtaining-the-residuals-from-a-non-spatial-model"><i class="fa fa-check"></i><b>9.3.1</b> Obtaining the residuals from a non-spatial model</a></li>
<li class="chapter" data-level="9.3.2" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#use-residuals-and-test-for-spatial-autocorrelation"><i class="fa fa-check"></i><b>9.3.2</b> Use residuals and test for spatial autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#geographically-weighted-regression-gwr"><i class="fa fa-check"></i><b>9.4</b> Geographically Weighted Regression (GWR)</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#preparing-the-data-for-gwr-analysis"><i class="fa fa-check"></i><b>9.4.1</b> Preparing the data for GWR analysis</a></li>
<li class="chapter" data-level="9.4.2" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#fitting-a-gwr-using-gwr.sel-and-gwr"><i class="fa fa-check"></i><b>9.4.2</b> Fitting a GWR using <code>gwr.sel()</code> and <code>gwr()</code></a></li>
<li class="chapter" data-level="9.4.3" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#model-results"><i class="fa fa-check"></i><b>9.4.3</b> Model results</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#tasks"><i class="fa fa-check"></i><b>9.5</b> Tasks</a></li>
<li class="chapter" data-level="9.6" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#attributions-2"><i class="fa fa-check"></i><b>9.6</b> Attributions</a></li>
<li class="chapter" data-level="9.7" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#references-see-reading-list-5"><i class="fa fa-check"></i><b>9.7</b> References (see reading list)</a></li>
<li class="chapter" data-level="9.8" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#data-sources-6"><i class="fa fa-check"></i><b>9.8</b> Data Sources</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GEOG0114: Principles of Spatial Analysis (2023/24)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spatial-autocorrelation-and-dependence" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Spatial autocorrelation and dependence<a href="spatial-autocorrelation-and-dependence.html#spatial-autocorrelation-and-dependence" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-2" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Introduction<a href="spatial-autocorrelation-and-dependence.html#introduction-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="lecture-video-length-010642" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Lecture video (Length: 01:06:42)<a href="spatial-autocorrelation-and-dependence.html#lecture-video-length-010642" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/znukVzQEQUQ" width="711" height="400" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p><a href="https://youtu.be/znukVzQEQUQ">[<strong>Watch on YouTube</strong>]</a></p>
</div>
<div id="computer-practical-video-length-020001" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Computer practical video (Length: 02:00:01)<a href="spatial-autocorrelation-and-dependence.html#computer-practical-video-length-020001" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/1QqA1Sqkk0A" width="711" height="400" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p><a href="https://youtu.be/1QqA1Sqkk0A">[<strong>Watch on YouTube</strong>]</a></p>
<p>This week, we focus on the first of two key properties of spatial data: spatial dependence. Spatial dependence is the idea that the observed value of a variable in one location is often dependent (to some degree) on the observed value of the same value in a nearby location. For spatial analysis, this dependence can be assessed and measured statistically by considering the level of spatial autocorrelation between values of a specific variable, observed in either different locations or between pairs of variables observed at the same location. Spatial autocorrelation occurs when these values are not independent of one another and instead cluster together across geographic space.</p>
<p>A critical first step of spatial autocorrelation is to define the criteria under which a spatial unit (e.g. an areal or point unit) can be understood as a “neighbour” to another unit. As highlighted in previous weeks, spatial properties can often take on several meanings, and as a result, have an impact on the validity and accuracy of spatial analysis. This multiplicity also can be applied to the concept of spatial neighbours which can be defined through adjacency, contiguity or distance-based measures. As the specification of these criteria can impact the results, the definition followed therefore need to be grounded in particular theory that aims to represent the process and variable investigated.</p>
</div>
<div id="learning-outcomes-2" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Learning outcomes<a href="spatial-autocorrelation-and-dependence.html#learning-outcomes-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Understanding the notion that spatial dependence refers to the degree of spatial autocorrelation between independently measured values observed in geographical space. We will learn how to estimate global measures of spatial autocorrelation (e.g., Moran’s I) to provide a singular measure of spatial dependence. We will learn how Local indicators of spatial association (LISA) to perform a similar function but yield multiple location-specific measures of spatial dependence.</p>
</div>
<div id="getting-started" class="section level3 hasAnchor" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Getting started<a href="spatial-autocorrelation-and-dependence.html#getting-started" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To enable the efficient, repeatable and reproducible functionality of our work, we will use R-Studio’s ability to create and host code as a script. Before we do anything therefore, we will need to create a new R script: <strong>File</strong> &gt; <strong>New File</strong> &gt; <strong>R Script</strong>. Remember, you can save your script with the quick save shortcuts (e.g. <code>cmd</code> + <code>s</code> (mac) / <code>ctrl</code> + <code>s</code> (windows)).</p>
</div>
<div id="datasets-setting-up-the-work-directory-1" class="section level3 hasAnchor" number="4.1.5">
<h3><span class="header-section-number">4.1.5</span> Datasets &amp; setting up the work directory<a href="spatial-autocorrelation-and-dependence.html#datasets-setting-up-the-work-directory-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before you begin, if you have not done so already, please make sure to download all data by <a href="https://github.com/UCLPG-MSC-SGDS/GEOG0114/raw/main/Week%203%20-%20Dataset.zip"><strong>clicking here</strong></a>. Create a sub folder called “<strong>Week 3</strong>” within your “<strong>GEOG0114</strong>” folder stored in the desktop of your personal computer. Make sure to extract all data from the downloaded zip folder and store it into “<strong>Week 3</strong>” folder. Use your newly open R script and set the work directory to <strong>Week 3’s</strong> folder.</p>
<p>For Windows, the code for setting the work directory will be:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="spatial-autocorrelation-and-dependence.html#cb56-1" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;C:/Users/AccountName/Desktop/GEOG0114/Week 3&quot;</span>)</span></code></pre></div>
<p>For MAC, the code for setting the work directory will be:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="spatial-autocorrelation-and-dependence.html#cb57-1" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;/Users/AccountName/Desktop/GEOG0114/Week 3&quot;</span>)</span></code></pre></div>
</div>
<div id="loading-and-installing-packages-1" class="section level3 hasAnchor" number="4.1.6">
<h3><span class="header-section-number">4.1.6</span> Loading and installing packages<a href="spatial-autocorrelation-and-dependence.html#loading-and-installing-packages-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will need to load the following packages from previous practicals:</p>
<ul>
<li><code>sf</code>: Simple Features</li>
<li><code>tmap</code>: Thematic Mapping</li>
<li><code>tidyverse</code>: Contains a collection of packages to support efficient data managing</li>
</ul>
<p>The above packages <code>sf</code>, <code>tmap</code> and <code>tidyverse</code> should have been installed previously in the last session. Therefore, we do not have to install them again, we only need to activate them using the <code>library()</code> function. There will be some new packages we need to install:</p>
<ul>
<li><code>nngeo</code>: The <code>nngeo</code> package includes functions for spatial join of layers based on k-nearest neighbor relation between features</li>
<li><code>spdep</code>: Provides access to a collection of functions to create spatial weights matrix objects from polygon contiguities, and testing spatial dependence</li>
<li><code>sp</code>: Provides access to a collection of functions for handling different classes and methods for spatial data</li>
<li><code>data.table</code>: Gives us access to function that deals with faster aggregation of large data frames etc.,</li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="spatial-autocorrelation-and-dependence.html#cb58-1" tabindex="-1"></a><span class="co"># install the packages using the install.package()</span></span>
<span id="cb58-2"><a href="spatial-autocorrelation-and-dependence.html#cb58-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;nngeo&quot;</span>)</span>
<span id="cb58-3"><a href="spatial-autocorrelation-and-dependence.html#cb58-3" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;spdep&quot;</span>)</span>
<span id="cb58-4"><a href="spatial-autocorrelation-and-dependence.html#cb58-4" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;sp&quot;</span>)</span>
<span id="cb58-5"><a href="spatial-autocorrelation-and-dependence.html#cb58-5" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;data.table&quot;</span>)</span>
<span id="cb58-6"><a href="spatial-autocorrelation-and-dependence.html#cb58-6" tabindex="-1"></a></span>
<span id="cb58-7"><a href="spatial-autocorrelation-and-dependence.html#cb58-7" tabindex="-1"></a><span class="co"># Load the packages with library()</span></span>
<span id="cb58-8"><a href="spatial-autocorrelation-and-dependence.html#cb58-8" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb58-9"><a href="spatial-autocorrelation-and-dependence.html#cb58-9" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;sf&quot;</span>)</span>
<span id="cb58-10"><a href="spatial-autocorrelation-and-dependence.html#cb58-10" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tmap&quot;</span>)</span>
<span id="cb58-11"><a href="spatial-autocorrelation-and-dependence.html#cb58-11" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;nngeo&quot;</span>)</span>
<span id="cb58-12"><a href="spatial-autocorrelation-and-dependence.html#cb58-12" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;spdep&quot;</span>)</span>
<span id="cb58-13"><a href="spatial-autocorrelation-and-dependence.html#cb58-13" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;sp&quot;</span>)</span>
<span id="cb58-14"><a href="spatial-autocorrelation-and-dependence.html#cb58-14" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;data.table&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="case-study" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Case study<a href="spatial-autocorrelation-and-dependence.html#case-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This week looks at spatial dependence and autocorrelation in detail, focusing on the different methods of assessment. As part of this, we look at the multiple methods to defining spatial neighbours and their suitability of use across different spatial phenomena – and how this approach is used to generate spatial weights for use within these spatial autocorrelation methods as well as their potential to generate spatially-explicit variables.</p>
<p>We put these learnings into practice through an analysis of spatial dependence of areal crime data, experimenting with the deployment of different neighbours and the impact of their analyses. For this practical we will look at the distribution of thefts from persons in the borough of Camden.</p>
<div id="neighbours" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Neighbours<a href="spatial-autocorrelation-and-dependence.html#neighbours" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If we want to come up with quantifiable descriptions of variables and how they vary over space, then we need to find ways of quantifying the distance from point to point. When you attach values to the polygons of wards in London, and visualise them, different patterns appear, and the different shapes and sizes of the polygons effect what these patterns look like. There can appear to be clusters, or the distribution can be random. If you want to explain and discuss variables, the underlying causes, and the possible solutions to issues, it becomes useful to quantify how clustered, or at the opposite end, how random these distributions are. This issue is known as spatial autocorrelation.</p>
<p>In raster data, variables are measured at regular spatial intervals (or interpolated to be represented as such). Each measurement is regularly spaced from its neighbours, like the pixels on the screen you are reading this from. With vector data, the distance of measurement to measurement, and the size and shape of the “pixel” of measurement becomes part of the captured information. Whilst this can allow for more nuanced representations of spatial phenomena, it also means that the quantity and type of distance between measurements needs to be acknowledged.</p>
<p>If you want to calculate the relative spatial relation of distributions, knowledge of what counts as a “neighbour” becomes useful. Neighbours can be neighbours due to euclidean distance (distance in space), or they can be due to shared relationships, like a shared boundary, or they can simply be the nearest neighbour, if there aren’t many other vectors around. Depending on the variable you are measuring the appropriateness of neighbourhood calculation techniques can change.</p>
<div id="loading-our-data-sets" class="section level4 hasAnchor" number="4.2.1.1">
<h4><span class="header-section-number">4.2.1.1</span> Loading our data sets<a href="spatial-autocorrelation-and-dependence.html#loading-our-data-sets" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now we have the data in the correct folders, we can load and plot the shape data.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="spatial-autocorrelation-and-dependence.html#cb59-1" tabindex="-1"></a><span class="co"># load Camden boundaries</span></span>
<span id="cb59-2"><a href="spatial-autocorrelation-and-dependence.html#cb59-2" tabindex="-1"></a>camden_oas <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&#39;OAs_camden_2011.shp&#39;</span>, <span class="at">crs=</span><span class="dv">27700</span>)</span>
<span id="cb59-3"><a href="spatial-autocorrelation-and-dependence.html#cb59-3" tabindex="-1"></a></span>
<span id="cb59-4"><a href="spatial-autocorrelation-and-dependence.html#cb59-4" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb59-5"><a href="spatial-autocorrelation-and-dependence.html#cb59-5" tabindex="-1"></a><span class="fu">tm_shape</span>(camden_oas) <span class="sc">+</span></span>
<span id="cb59-6"><a href="spatial-autocorrelation-and-dependence.html#cb59-6" tabindex="-1"></a>  <span class="fu">tm_polygons</span>()</span></code></pre></div>
<p><img src="images/general/week3/image1_outline.png" width="100%" style="display: block; margin: auto;" /></p>
<p>You can see how one of these output areas could have many more neighbours than others, they vary a great deal in size and shape. The dimensions of these objects change over space, as a result the measurements within them must change too.</p>
<p>Output areas are designed to convey and contain census information, so they are created in a way that maintains a similar number of residents in each one. The more sparsely populated an OA the larger it is. Output Areas are designed to cover the entirety of the land of England and Wales so they stretch over places where there are no people. In the north of Camden the largest Ouput Areas span over Hampstead Heath, a large park.</p>
<p>Let’s explore how to find different kinds of neighbours using the example of one ‘randomly’ selected output area (<strong>E00004174</strong>) that happens to contain the UCL main campus.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="spatial-autocorrelation-and-dependence.html#cb60-1" tabindex="-1"></a><span class="co"># highlight E00004174</span></span>
<span id="cb60-2"><a href="spatial-autocorrelation-and-dependence.html#cb60-2" tabindex="-1"></a><span class="fu">tm_shape</span>(camden_oas) <span class="sc">+</span></span>
<span id="cb60-3"><a href="spatial-autocorrelation-and-dependence.html#cb60-3" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb60-4"><a href="spatial-autocorrelation-and-dependence.html#cb60-4" tabindex="-1"></a><span class="fu">tm_shape</span>(camden_oas[camden_oas<span class="sc">$</span>OA11CD<span class="sc">==</span><span class="st">&#39;E00004174&#39;</span>,]) <span class="sc">+</span></span>
<span id="cb60-5"><a href="spatial-autocorrelation-and-dependence.html#cb60-5" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="images/general/week3/image2_highlight_area_red.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="euclidean-neighbours" class="section level4 hasAnchor" number="4.2.1.2">
<h4><span class="header-section-number">4.2.1.2</span> Euclidean neighbours<a href="spatial-autocorrelation-and-dependence.html#euclidean-neighbours" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The first way we are going to call something a neighbour is by using Euclidean distance. As our OA shapefile is projected in BNG (British National Grid), the coordinates are planar, going up 1 is the same distance as going sideways 1. Even better the coordinates are in metric measurements so it’s easy to make up heuristic distances.</p>
<p>Let’s call every output area with a centroid 500m or less away from the centroid of our chosen OA a neighbour:</p>
<ul>
<li>we select only the the centroid of our chosen output area and all other areas (with <code>st_centroid()</code>)</li>
<li>we set the maximum number of neighbours we want to find to “50” (with parameter <code>k</code>)</li>
<li>we set the maximum distance of calling an OA centroid a neigbour to “500” (with parameter <code>maxdist</code>)</li>
<li>we return a sparse matrix that tells us whether each OA is a neighbour or not (with parameter <code>sparse</code>)</li>
</ul>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="spatial-autocorrelation-and-dependence.html#cb61-1" tabindex="-1"></a><span class="co"># assign our chosen OA to a variable </span></span>
<span id="cb61-2"><a href="spatial-autocorrelation-and-dependence.html#cb61-2" tabindex="-1"></a>chosen_oa <span class="ot">&lt;-</span> <span class="st">&#39;E00004174&#39;</span></span>
<span id="cb61-3"><a href="spatial-autocorrelation-and-dependence.html#cb61-3" tabindex="-1"></a></span>
<span id="cb61-4"><a href="spatial-autocorrelation-and-dependence.html#cb61-4" tabindex="-1"></a><span class="co"># identify neighbours</span></span>
<span id="cb61-5"><a href="spatial-autocorrelation-and-dependence.html#cb61-5" tabindex="-1"></a>chosen_oa_neighbours <span class="ot">&lt;-</span> <span class="fu">st_nn</span>(<span class="fu">st_geometry</span>(<span class="fu">st_centroid</span>(camden_oas[camden_oas<span class="sc">$</span>OA11CD<span class="sc">==</span>chosen_oa,])), </span>
<span id="cb61-6"><a href="spatial-autocorrelation-and-dependence.html#cb61-6" tabindex="-1"></a>                              <span class="fu">st_geometry</span>(<span class="fu">st_centroid</span>(camden_oas)),</span>
<span id="cb61-7"><a href="spatial-autocorrelation-and-dependence.html#cb61-7" tabindex="-1"></a>                              <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb61-8"><a href="spatial-autocorrelation-and-dependence.html#cb61-8" tabindex="-1"></a>                              <span class="at">k =</span> <span class="dv">50</span>,</span>
<span id="cb61-9"><a href="spatial-autocorrelation-and-dependence.html#cb61-9" tabindex="-1"></a>                              <span class="at">maxdist =</span> <span class="dv">500</span>) </span>
<span id="cb61-10"><a href="spatial-autocorrelation-and-dependence.html#cb61-10" tabindex="-1"></a></span>
<span id="cb61-11"><a href="spatial-autocorrelation-and-dependence.html#cb61-11" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb61-12"><a href="spatial-autocorrelation-and-dependence.html#cb61-12" tabindex="-1"></a><span class="fu">class</span>(chosen_oa_neighbours)</span>
<span id="cb61-13"><a href="spatial-autocorrelation-and-dependence.html#cb61-13" tabindex="-1"></a></span>
<span id="cb61-14"><a href="spatial-autocorrelation-and-dependence.html#cb61-14" tabindex="-1"></a><span class="co"># get the names (codes) of these neighbours</span></span>
<span id="cb61-15"><a href="spatial-autocorrelation-and-dependence.html#cb61-15" tabindex="-1"></a>neighbour_names <span class="ot">&lt;-</span> camden_oas[chosen_oa_neighbours[[<span class="dv">1</span>]],]</span>
<span id="cb61-16"><a href="spatial-autocorrelation-and-dependence.html#cb61-16" tabindex="-1"></a>neighbour_names <span class="ot">&lt;-</span> neighbour_names<span class="sc">$</span>OA11CD</span>
<span id="cb61-17"><a href="spatial-autocorrelation-and-dependence.html#cb61-17" tabindex="-1"></a></span>
<span id="cb61-18"><a href="spatial-autocorrelation-and-dependence.html#cb61-18" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb61-19"><a href="spatial-autocorrelation-and-dependence.html#cb61-19" tabindex="-1"></a><span class="fu">tm_shape</span>(camden_oas) <span class="sc">+</span> </span>
<span id="cb61-20"><a href="spatial-autocorrelation-and-dependence.html#cb61-20" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb61-21"><a href="spatial-autocorrelation-and-dependence.html#cb61-21" tabindex="-1"></a>  <span class="co"># highlight only the neighbours</span></span>
<span id="cb61-22"><a href="spatial-autocorrelation-and-dependence.html#cb61-22" tabindex="-1"></a>  <span class="fu">tm_shape</span>(camden_oas[camden_oas<span class="sc">$</span>OA11CD <span class="sc">%in%</span> neighbour_names,]) <span class="sc">+</span> </span>
<span id="cb61-23"><a href="spatial-autocorrelation-and-dependence.html#cb61-23" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">&#39;green&#39;</span>) <span class="sc">+</span></span>
<span id="cb61-24"><a href="spatial-autocorrelation-and-dependence.html#cb61-24" tabindex="-1"></a>  <span class="co"># highlight only the chosen OA</span></span>
<span id="cb61-25"><a href="spatial-autocorrelation-and-dependence.html#cb61-25" tabindex="-1"></a>  <span class="fu">tm_shape</span>(camden_oas[camden_oas<span class="sc">$</span>OA11CD<span class="sc">==</span>chosen_oa,]) <span class="sc">+</span> </span>
<span id="cb61-26"><a href="spatial-autocorrelation-and-dependence.html#cb61-26" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb61-27"><a href="spatial-autocorrelation-and-dependence.html#cb61-27" tabindex="-1"></a>  <span class="fu">tm_shape</span>(camden_oas) <span class="sc">+</span> </span>
<span id="cb61-28"><a href="spatial-autocorrelation-and-dependence.html#cb61-28" tabindex="-1"></a>  <span class="co"># overlay the borders</span></span>
<span id="cb61-29"><a href="spatial-autocorrelation-and-dependence.html#cb61-29" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">&#39;black&#39;</span>)</span></code></pre></div>
<p><img src="images/general/week3/image3_highlight_areas_red_green.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="shared-boundary-neighbours" class="section level4 hasAnchor" number="4.2.1.3">
<h4><span class="header-section-number">4.2.1.3</span> Shared boundary neighbours<a href="spatial-autocorrelation-and-dependence.html#shared-boundary-neighbours" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The next way of calculating neighbours takes into account the actual shape and location of the polygons in our shapefile. This has only recently been added to the world of <code>sf()</code>, previously we would have reverted to using the <code>sp()</code> package and others that depend on it such as <code>spdep()</code>.</p>
<p>We can create two functions that check whether any polygons share boundaries or overlap one another, and then also check by how much. These new functions are based on the <code>st_relate()</code> function. The different cases of these are known as queen, and rook. These describe the relations in a similar way to the possible chess board movements of these pieces.</p>
<div class="note">
<p><strong>Note</strong><br/>
Do have a look at the short lectures by Luc Anselin on <a href="https://www.youtube.com/watch?v=qWQ1Pa5cbtw">Moran’s I</a>, the <a href="https://www.youtube.com/watch?v=_J_bmWmOF3I">interpretation of Moran’s I</a>, and <a href="https://www.youtube.com/watch?v=xMXFvRO4cEM">neighbours and spatial weights</a> for some additional explanation on measuring spatial autocorrelation with Moran’s I.</p>
</div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="spatial-autocorrelation-and-dependence.html#cb62-1" tabindex="-1"></a><span class="co"># for rook case</span></span>
<span id="cb62-2"><a href="spatial-autocorrelation-and-dependence.html#cb62-2" tabindex="-1"></a>st_rook <span class="ot">=</span> <span class="cf">function</span>(a, <span class="at">b =</span> a) <span class="fu">st_relate</span>(a, b, <span class="at">pattern =</span> <span class="st">&#39;F***1****&#39;</span>)</span>
<span id="cb62-3"><a href="spatial-autocorrelation-and-dependence.html#cb62-3" tabindex="-1"></a></span>
<span id="cb62-4"><a href="spatial-autocorrelation-and-dependence.html#cb62-4" tabindex="-1"></a><span class="co"># for queen case</span></span>
<span id="cb62-5"><a href="spatial-autocorrelation-and-dependence.html#cb62-5" tabindex="-1"></a>st_queen <span class="ot">&lt;-</span> <span class="cf">function</span>(a, <span class="at">b =</span> a) <span class="fu">st_relate</span>(a, b, <span class="at">pattern =</span> <span class="st">&#39;F***T****&#39;</span>)</span></code></pre></div>
<p>Now that we’ve created the functions lets try them out.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="spatial-autocorrelation-and-dependence.html#cb63-1" tabindex="-1"></a><span class="co"># identify neighbours</span></span>
<span id="cb63-2"><a href="spatial-autocorrelation-and-dependence.html#cb63-2" tabindex="-1"></a>chosen_oa_neighbours <span class="ot">&lt;-</span> <span class="fu">st_rook</span>(<span class="fu">st_geometry</span>(camden_oas[camden_oas<span class="sc">$</span>OA11CD<span class="sc">==</span>chosen_oa,]), </span>
<span id="cb63-3"><a href="spatial-autocorrelation-and-dependence.html#cb63-3" tabindex="-1"></a>                                <span class="fu">st_geometry</span>(camden_oas))</span>
<span id="cb63-4"><a href="spatial-autocorrelation-and-dependence.html#cb63-4" tabindex="-1"></a></span>
<span id="cb63-5"><a href="spatial-autocorrelation-and-dependence.html#cb63-5" tabindex="-1"></a><span class="co"># get the names (codes) of these neighbours</span></span>
<span id="cb63-6"><a href="spatial-autocorrelation-and-dependence.html#cb63-6" tabindex="-1"></a>neighbour_names <span class="ot">&lt;-</span> camden_oas[chosen_oa_neighbours[[<span class="dv">1</span>]],]</span>
<span id="cb63-7"><a href="spatial-autocorrelation-and-dependence.html#cb63-7" tabindex="-1"></a>neighbour_names <span class="ot">&lt;-</span> neighbour_names<span class="sc">$</span>OA11CD</span>
<span id="cb63-8"><a href="spatial-autocorrelation-and-dependence.html#cb63-8" tabindex="-1"></a></span>
<span id="cb63-9"><a href="spatial-autocorrelation-and-dependence.html#cb63-9" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb63-10"><a href="spatial-autocorrelation-and-dependence.html#cb63-10" tabindex="-1"></a><span class="fu">tm_shape</span>(camden_oas) <span class="sc">+</span> </span>
<span id="cb63-11"><a href="spatial-autocorrelation-and-dependence.html#cb63-11" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb63-12"><a href="spatial-autocorrelation-and-dependence.html#cb63-12" tabindex="-1"></a>  <span class="co"># highlight only the neighbours</span></span>
<span id="cb63-13"><a href="spatial-autocorrelation-and-dependence.html#cb63-13" tabindex="-1"></a>  <span class="fu">tm_shape</span>(camden_oas[camden_oas<span class="sc">$</span>OA11CD <span class="sc">%in%</span> neighbour_names,]) <span class="sc">+</span> </span>
<span id="cb63-14"><a href="spatial-autocorrelation-and-dependence.html#cb63-14" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">&#39;green&#39;</span>) <span class="sc">+</span></span>
<span id="cb63-15"><a href="spatial-autocorrelation-and-dependence.html#cb63-15" tabindex="-1"></a>  <span class="fu">tm_shape</span>(camden_oas[camden_oas<span class="sc">$</span>OA11CD<span class="sc">==</span>chosen_oa,]) <span class="sc">+</span> </span>
<span id="cb63-16"><a href="spatial-autocorrelation-and-dependence.html#cb63-16" tabindex="-1"></a>  <span class="co"># highlight only the chosen OA</span></span>
<span id="cb63-17"><a href="spatial-autocorrelation-and-dependence.html#cb63-17" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb63-18"><a href="spatial-autocorrelation-and-dependence.html#cb63-18" tabindex="-1"></a>  <span class="fu">tm_shape</span>(camden_oas) <span class="sc">+</span> </span>
<span id="cb63-19"><a href="spatial-autocorrelation-and-dependence.html#cb63-19" tabindex="-1"></a>  <span class="co"># overlay the borders</span></span>
<span id="cb63-20"><a href="spatial-autocorrelation-and-dependence.html#cb63-20" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">&#39;black&#39;</span>)</span></code></pre></div>
<p><img src="images/general/week3/image4_highlight_areas_with_functions.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="note">
<p><strong>Note</strong><br/>
Because the tolerance of the shared boundaries in the <code>st_rook()</code> pattern and the <code>st_queen()</code> pattern, in this example they both assign the same neighbours. This is true for many non-square polygons as the difference is often given as whether two shapes share one or more points. Therefore the difference can have more to do with the resolution and alignment of your polygons than the actual spatial properties they represent. They can and do find different neighbours in other situations. Follow the grid example in the <code>st_relate()</code> documentation if you want to see it working.</p>
</div>
</div>
</div>
<div id="theft-in-camden" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Theft in Camden<a href="spatial-autocorrelation-and-dependence.html#theft-in-camden" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have found the different ways of finding neighbours we can consider how they relate to one another. There are two ways of looking at spatial autocorrelation:</p>
<ul>
<li><strong>Global:</strong> This is a way of creating a metric of how regularly or irregularly clustered the variables are over the entire area studied.</li>
<li><strong>Local:</strong> This is the difference between an area and its neighbours. You would expect neighbours to be similar, but you can find exceptional places and results by seeing if places are quantifiably more like or dislike their neighbours than the average other place.</li>
</ul>
<p>But before we start that let’s get into the data we are going to use! We’ll be using personal theft data from around Camden. Our neighbourhood analysis of spatial autocorrelation should allow us to quantify the pattern of distribution of reported theft from persons in Camden in 2019.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="spatial-autocorrelation-and-dependence.html#cb64-1" tabindex="-1"></a><span class="co"># load theft data</span></span>
<span id="cb64-2"><a href="spatial-autocorrelation-and-dependence.html#cb64-2" tabindex="-1"></a>camden_theft <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;2019_camden_theft_from_person.csv&#39;</span>)</span>
<span id="cb64-3"><a href="spatial-autocorrelation-and-dependence.html#cb64-3" tabindex="-1"></a></span>
<span id="cb64-4"><a href="spatial-autocorrelation-and-dependence.html#cb64-4" tabindex="-1"></a><span class="co"># convert csv to sf object</span></span>
<span id="cb64-5"><a href="spatial-autocorrelation-and-dependence.html#cb64-5" tabindex="-1"></a>camden_theft <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(camden_theft, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&#39;X&#39;</span>,<span class="st">&#39;Y&#39;</span>), <span class="at">crs =</span> <span class="dv">27700</span>)</span>
<span id="cb64-6"><a href="spatial-autocorrelation-and-dependence.html#cb64-6" tabindex="-1"></a></span>
<span id="cb64-7"><a href="spatial-autocorrelation-and-dependence.html#cb64-7" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb64-8"><a href="spatial-autocorrelation-and-dependence.html#cb64-8" tabindex="-1"></a><span class="fu">tm_shape</span>(camden_oas) <span class="sc">+</span></span>
<span id="cb64-9"><a href="spatial-autocorrelation-and-dependence.html#cb64-9" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb64-10"><a href="spatial-autocorrelation-and-dependence.html#cb64-10" tabindex="-1"></a><span class="fu">tm_shape</span>(camden_theft) <span class="sc">+</span></span>
<span id="cb64-11"><a href="spatial-autocorrelation-and-dependence.html#cb64-11" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code></pre></div>
<p><img src="images/general/week3/image5_theft_points.png" width="100%" style="display: block; margin: auto;" /></p>
<p>This is point data, but we are interested in the polygons and how this data relates to the administrative boundaries it is within. Let’s count the number of thefts in each OA. This is a spatial operation that is often called “point in polygon”. As we are just counting the number of occurrences in each polygon it is quite easy. In the future you may often want to aggregate over points for an area, or in reverse assign values from the polygon to the points.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="spatial-autocorrelation-and-dependence.html#cb65-1" tabindex="-1"></a><span class="co"># thefts in Camden</span></span>
<span id="cb65-2"><a href="spatial-autocorrelation-and-dependence.html#cb65-2" tabindex="-1"></a>camden_oas<span class="sc">$</span>n_thefts <span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(camden_oas, camden_theft))</span>
<span id="cb65-3"><a href="spatial-autocorrelation-and-dependence.html#cb65-3" tabindex="-1"></a></span>
<span id="cb65-4"><a href="spatial-autocorrelation-and-dependence.html#cb65-4" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb65-5"><a href="spatial-autocorrelation-and-dependence.html#cb65-5" tabindex="-1"></a><span class="fu">tm_shape</span>(camden_oas) <span class="sc">+</span></span>
<span id="cb65-6"><a href="spatial-autocorrelation-and-dependence.html#cb65-6" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col=</span><span class="st">&#39;n_thefts&#39;</span>) <span class="sc">+</span></span>
<span id="cb65-7"><a href="spatial-autocorrelation-and-dependence.html#cb65-7" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">lty=</span><span class="st">&quot;solid&quot;</span>)</span></code></pre></div>
<p><img src="images/general/week3/image6_counts.png" width="100%" style="display: block; margin: auto;" /></p>
<p>You can see our map is skewed by central London, meaning that the results in central London (the south of Camden) are so much larger than those in the north that it makes it harder to see the smaller differences between other areas. We’ll take the square root of the number of thefts to remedy this.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="spatial-autocorrelation-and-dependence.html#cb66-1" tabindex="-1"></a><span class="co"># square root of thefts</span></span>
<span id="cb66-2"><a href="spatial-autocorrelation-and-dependence.html#cb66-2" tabindex="-1"></a>camden_oas<span class="sc">$</span>sqrt_n_thefts <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(camden_oas<span class="sc">$</span>n_thefts)</span>
<span id="cb66-3"><a href="spatial-autocorrelation-and-dependence.html#cb66-3" tabindex="-1"></a></span>
<span id="cb66-4"><a href="spatial-autocorrelation-and-dependence.html#cb66-4" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb66-5"><a href="spatial-autocorrelation-and-dependence.html#cb66-5" tabindex="-1"></a><span class="fu">tm_shape</span>(camden_oas) <span class="sc">+</span></span>
<span id="cb66-6"><a href="spatial-autocorrelation-and-dependence.html#cb66-6" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col=</span><span class="st">&#39;sqrt_n_thefts&#39;</span>) <span class="sc">+</span></span>
<span id="cb66-7"><a href="spatial-autocorrelation-and-dependence.html#cb66-7" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">lty=</span><span class="st">&quot;solid&quot;</span>)</span></code></pre></div>
<p><img src="images/general/week3/image7_sqrtroot_counts.png" width="100%" style="display: block; margin: auto;" /></p>
<p>There: a slightly more nuanced picture</p>
</div>
<div id="global-morans-i" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Global Moran’s I<a href="spatial-autocorrelation-and-dependence.html#global-morans-i" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With a <a href="https://en.wikipedia.org/wiki/Moran%27s_I">Global Moran’s I</a> we can test how “random” the spatial distribution of these values is. Global Moran’s I is a metric between -1 and 1. -1 is a completely even spatial distribution of values, 0 is a “random” distribution, and 1 is a “non-random” distribution of clearly defined clusters.</p>
<p>To calculate the Global Moran’s I you need an adjacency matrix that contains the information of whether or not an OA is next to another. For an even more nuanced view you can include distance, or a distance weighting in the matrix rather than just the <code>TRUE</code> or <code>FALSE</code>, to take into account the strength of the neighbourhoodness. Because of the way Moran’s I functions in R it is necessary to use the <code>sp</code> and <code>spdep</code> libraries (which we have loaded earlier). As you will see these methods and functions have quite esoteric and complicated syntax. Some of the operations they will do will be similar to the examples shown earlier, but the way they assign and store variables makes it much quicker to run complex spatial operations.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="spatial-autocorrelation-and-dependence.html#cb67-1" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb67-2"><a href="spatial-autocorrelation-and-dependence.html#cb67-2" tabindex="-1"></a><span class="fu">class</span>(camden_oas)</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="spatial-autocorrelation-and-dependence.html#cb68-1" tabindex="-1"></a><span class="do">## [1] &quot;sf&quot;         &quot;data.frame&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="spatial-autocorrelation-and-dependence.html#cb69-1" tabindex="-1"></a><span class="co"># convert to sp</span></span>
<span id="cb69-2"><a href="spatial-autocorrelation-and-dependence.html#cb69-2" tabindex="-1"></a>camden_oas_sp <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(camden_oas, <span class="at">IDs=</span>camden_oas<span class="sc">$</span>OA11CD)</span>
<span id="cb69-3"><a href="spatial-autocorrelation-and-dependence.html#cb69-3" tabindex="-1"></a></span>
<span id="cb69-4"><a href="spatial-autocorrelation-and-dependence.html#cb69-4" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb69-5"><a href="spatial-autocorrelation-and-dependence.html#cb69-5" tabindex="-1"></a><span class="fu">class</span>(camden_oas_sp)</span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="spatial-autocorrelation-and-dependence.html#cb70-1" tabindex="-1"></a><span class="do">## [1] &quot;SpatialPolygonsDataFrame&quot;</span></span>
<span id="cb70-2"><a href="spatial-autocorrelation-and-dependence.html#cb70-2" tabindex="-1"></a><span class="do">## attr(,&quot;package&quot;)</span></span>
<span id="cb70-3"><a href="spatial-autocorrelation-and-dependence.html#cb70-3" tabindex="-1"></a><span class="do">## [1] &quot;sp&quot;</span></span></code></pre></div>
<p>Now we can make the esoteric and timesaving “nb” object in which we store for each OA which other OAs are considered to be neighbours.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="spatial-autocorrelation-and-dependence.html#cb71-1" tabindex="-1"></a><span class="co"># create an nb object</span></span>
<span id="cb71-2"><a href="spatial-autocorrelation-and-dependence.html#cb71-2" tabindex="-1"></a>camden_oas_nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(camden_oas_sp, <span class="at">row.names=</span>camden_oas_sp<span class="sc">$</span>OA11CD)</span>
<span id="cb71-3"><a href="spatial-autocorrelation-and-dependence.html#cb71-3" tabindex="-1"></a></span>
<span id="cb71-4"><a href="spatial-autocorrelation-and-dependence.html#cb71-4" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb71-5"><a href="spatial-autocorrelation-and-dependence.html#cb71-5" tabindex="-1"></a><span class="fu">class</span>(camden_oas_nb)</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="spatial-autocorrelation-and-dependence.html#cb72-1" tabindex="-1"></a><span class="do">## [1] &quot;nb&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="spatial-autocorrelation-and-dependence.html#cb73-1" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb73-2"><a href="spatial-autocorrelation-and-dependence.html#cb73-2" tabindex="-1"></a><span class="fu">str</span>(camden_oas_nb,<span class="at">list.len=</span><span class="dv">10</span>)</span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="spatial-autocorrelation-and-dependence.html#cb74-1" tabindex="-1"></a><span class="do">## List of 749</span></span>
<span id="cb74-2"><a href="spatial-autocorrelation-and-dependence.html#cb74-2" tabindex="-1"></a><span class="do">##  $ : int [1:7] 10 15 215 303 327 375 464</span></span>
<span id="cb74-3"><a href="spatial-autocorrelation-and-dependence.html#cb74-3" tabindex="-1"></a><span class="do">##  $ : int [1:5] 19 72 309 365 430</span></span>
<span id="cb74-4"><a href="spatial-autocorrelation-and-dependence.html#cb74-4" tabindex="-1"></a><span class="do">##  $ : int [1:3] 133 152 709</span></span>
<span id="cb74-5"><a href="spatial-autocorrelation-and-dependence.html#cb74-5" tabindex="-1"></a><span class="do">##  $ : int [1:7] 78 131 152 286 314 582 651</span></span>
<span id="cb74-6"><a href="spatial-autocorrelation-and-dependence.html#cb74-6" tabindex="-1"></a><span class="do">##  $ : int [1:5] 67 316 486 492 703</span></span>
<span id="cb74-7"><a href="spatial-autocorrelation-and-dependence.html#cb74-7" tabindex="-1"></a><span class="do">##  $ : int [1:8] 7 68 317 487 556 612 625 638</span></span>
<span id="cb74-8"><a href="spatial-autocorrelation-and-dependence.html#cb74-8" tabindex="-1"></a><span class="do">##  $ : int [1:3] 6 68 317</span></span>
<span id="cb74-9"><a href="spatial-autocorrelation-and-dependence.html#cb74-9" tabindex="-1"></a><span class="do">##  $ : int [1:7] 57 58 164 358 429 605 684</span></span>
<span id="cb74-10"><a href="spatial-autocorrelation-and-dependence.html#cb74-10" tabindex="-1"></a><span class="do">##  $ : int [1:5] 58 164 489 609 700</span></span>
<span id="cb74-11"><a href="spatial-autocorrelation-and-dependence.html#cb74-11" tabindex="-1"></a><span class="do">##  $ : int [1:7] 1 215 245 311 327 366 644</span></span>
<span id="cb74-12"><a href="spatial-autocorrelation-and-dependence.html#cb74-12" tabindex="-1"></a><span class="do">##   [list output truncated]</span></span>
<span id="cb74-13"><a href="spatial-autocorrelation-and-dependence.html#cb74-13" tabindex="-1"></a><span class="do">##  - attr(*, &quot;class&quot;)= chr &quot;nb&quot;</span></span>
<span id="cb74-14"><a href="spatial-autocorrelation-and-dependence.html#cb74-14" tabindex="-1"></a><span class="do">##  - attr(*, &quot;region.id&quot;)= chr [1:749] &quot;E00004395&quot; &quot;E00004314&quot; &quot;E00004578&quot; &quot;E00004579&quot; ...</span></span>
<span id="cb74-15"><a href="spatial-autocorrelation-and-dependence.html#cb74-15" tabindex="-1"></a><span class="do">##  - attr(*, &quot;call&quot;)= language poly2nb(pl = camden_oas_sp, row.names = camden_oas_sp$OA11CD)</span></span>
<span id="cb74-16"><a href="spatial-autocorrelation-and-dependence.html#cb74-16" tabindex="-1"></a><span class="do">##  - attr(*, &quot;type&quot;)= chr &quot;queen&quot;</span></span>
<span id="cb74-17"><a href="spatial-autocorrelation-and-dependence.html#cb74-17" tabindex="-1"></a><span class="do">##  - attr(*, &quot;sym&quot;)= logi TRUE</span></span></code></pre></div>
<p>Next, we need to assign weights to each neighbouring polygon. In our case, each neighbouring polygon will be assigned equal weight with <code>style='W'</code>. After this, we can calculate a value for the Global Moran’s I.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="spatial-autocorrelation-and-dependence.html#cb75-1" tabindex="-1"></a><span class="co"># create the list weights object</span></span>
<span id="cb75-2"><a href="spatial-autocorrelation-and-dependence.html#cb75-2" tabindex="-1"></a>nb_weights_list <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(camden_oas_nb, <span class="at">style=</span><span class="st">&#39;W&#39;</span>)</span>
<span id="cb75-3"><a href="spatial-autocorrelation-and-dependence.html#cb75-3" tabindex="-1"></a></span>
<span id="cb75-4"><a href="spatial-autocorrelation-and-dependence.html#cb75-4" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb75-5"><a href="spatial-autocorrelation-and-dependence.html#cb75-5" tabindex="-1"></a><span class="fu">class</span>(nb_weights_list)</span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="spatial-autocorrelation-and-dependence.html#cb76-1" tabindex="-1"></a><span class="do">## [1] &quot;listw&quot; &quot;nb&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="spatial-autocorrelation-and-dependence.html#cb77-1" tabindex="-1"></a><span class="co"># Moran&#39;s I</span></span>
<span id="cb77-2"><a href="spatial-autocorrelation-and-dependence.html#cb77-2" tabindex="-1"></a>mi_value <span class="ot">&lt;-</span> <span class="fu">moran</span>(camden_oas_sp<span class="sc">$</span>n_thefts,nb_weights_list,<span class="at">n=</span><span class="fu">length</span>(nb_weights_list<span class="sc">$</span>neighbours),<span class="at">S0=</span><span class="fu">Szero</span>(nb_weights_list))</span>
<span id="cb77-3"><a href="spatial-autocorrelation-and-dependence.html#cb77-3" tabindex="-1"></a></span>
<span id="cb77-4"><a href="spatial-autocorrelation-and-dependence.html#cb77-4" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb77-5"><a href="spatial-autocorrelation-and-dependence.html#cb77-5" tabindex="-1"></a>mi_value</span></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="spatial-autocorrelation-and-dependence.html#cb78-1" tabindex="-1"></a><span class="do">## $I</span></span>
<span id="cb78-2"><a href="spatial-autocorrelation-and-dependence.html#cb78-2" tabindex="-1"></a><span class="do">## [1] 0.4772137</span></span>
<span id="cb78-3"><a href="spatial-autocorrelation-and-dependence.html#cb78-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb78-4"><a href="spatial-autocorrelation-and-dependence.html#cb78-4" tabindex="-1"></a><span class="do">## $K</span></span>
<span id="cb78-5"><a href="spatial-autocorrelation-and-dependence.html#cb78-5" tabindex="-1"></a><span class="do">## [1] 75.21583</span></span></code></pre></div>
<p>The Global Moran’s I seems to indicate that there is indeed some spatial autocorrelation in our data, however, this is just a quick way to check the score. To do so properly we need to compare our score a randomly distributed version of the variables. We can do this by using something called a <a href="https://en.wikipedia.org/wiki/Monte_Carlo_method">Monte Carlo simulation</a>.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="spatial-autocorrelation-and-dependence.html#cb79-1" tabindex="-1"></a><span class="co"># run a Monte Carlo simulation 599 times</span></span>
<span id="cb79-2"><a href="spatial-autocorrelation-and-dependence.html#cb79-2" tabindex="-1"></a>mc_model <span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(camden_oas_sp<span class="sc">$</span>n_thefts, nb_weights_list, <span class="at">nsim=</span><span class="dv">599</span>)</span>
<span id="cb79-3"><a href="spatial-autocorrelation-and-dependence.html#cb79-3" tabindex="-1"></a></span>
<span id="cb79-4"><a href="spatial-autocorrelation-and-dependence.html#cb79-4" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb79-5"><a href="spatial-autocorrelation-and-dependence.html#cb79-5" tabindex="-1"></a>mc_model</span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="spatial-autocorrelation-and-dependence.html#cb80-1" tabindex="-1"></a><span class="do">## Monte-Carlo simulation of Moran I</span></span>
<span id="cb80-2"><a href="spatial-autocorrelation-and-dependence.html#cb80-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb80-3"><a href="spatial-autocorrelation-and-dependence.html#cb80-3" tabindex="-1"></a><span class="do">## data:  camden_oas_sp$n_thefts </span></span>
<span id="cb80-4"><a href="spatial-autocorrelation-and-dependence.html#cb80-4" tabindex="-1"></a><span class="do">## weights: nb_weights_list  </span></span>
<span id="cb80-5"><a href="spatial-autocorrelation-and-dependence.html#cb80-5" tabindex="-1"></a><span class="do">## number of simulations + 1: 600 </span></span>
<span id="cb80-6"><a href="spatial-autocorrelation-and-dependence.html#cb80-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb80-7"><a href="spatial-autocorrelation-and-dependence.html#cb80-7" tabindex="-1"></a><span class="do">## statistic = 0.47721, observed rank = 600, p-value = 0.001667</span></span>
<span id="cb80-8"><a href="spatial-autocorrelation-and-dependence.html#cb80-8" tabindex="-1"></a><span class="do">## alternative hypothesis: greater</span></span></code></pre></div>
<p>This model shows that our distribution of thefts differs significantly from a random distribution. As such, we can conclude that there is significant spatial autocorrelation in our theft data set.</p>
</div>
<div id="local-morans-i-or-lisa" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Local Moran’s I (or LISA)<a href="spatial-autocorrelation-and-dependence.html#local-morans-i-or-lisa" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With a measurement of local spatial autocorrelation we could find hotspots of theft that are surrounded by areas of much lower theft. According to the previous global statistic these are not randomly distributed pockets but would be outliers against the general trend of clusteredness! These could be areas that contain very specific locations, where interventions could be made that drastically reduce the rate of crime rather than other areas where there is a high level of ambient crime.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="spatial-autocorrelation-and-dependence.html#cb81-1" tabindex="-1"></a><span class="co"># create an nb object</span></span>
<span id="cb81-2"><a href="spatial-autocorrelation-and-dependence.html#cb81-2" tabindex="-1"></a>camden_oas_nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(camden_oas_sp, <span class="at">row.names=</span>camden_oas_sp<span class="sc">$</span>OA11CD)</span>
<span id="cb81-3"><a href="spatial-autocorrelation-and-dependence.html#cb81-3" tabindex="-1"></a></span>
<span id="cb81-4"><a href="spatial-autocorrelation-and-dependence.html#cb81-4" tabindex="-1"></a><span class="co"># create the list weights object</span></span>
<span id="cb81-5"><a href="spatial-autocorrelation-and-dependence.html#cb81-5" tabindex="-1"></a>nb_weights_list <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(camden_oas_nb, <span class="at">style=</span><span class="st">&#39;W&#39;</span>)</span>
<span id="cb81-6"><a href="spatial-autocorrelation-and-dependence.html#cb81-6" tabindex="-1"></a></span>
<span id="cb81-7"><a href="spatial-autocorrelation-and-dependence.html#cb81-7" tabindex="-1"></a><span class="co"># Local Moran&#39;s I</span></span>
<span id="cb81-8"><a href="spatial-autocorrelation-and-dependence.html#cb81-8" tabindex="-1"></a>local_moran_camden_oa_theft <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(camden_oas_sp<span class="sc">$</span>n_thefts, nb_weights_list)</span></code></pre></div>
<p>To properly utilise these local statistics and make an intuitively useful map, we need to combine them with our crime count variable. Because of the way the new variable will be calculated, we first need to rescale our variable so that the mean is 0.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="spatial-autocorrelation-and-dependence.html#cb82-1" tabindex="-1"></a><span class="co"># rescale</span></span>
<span id="cb82-2"><a href="spatial-autocorrelation-and-dependence.html#cb82-2" tabindex="-1"></a>camden_oas_sp<span class="sc">$</span>scale_n_thefts <span class="ot">&lt;-</span> <span class="fu">scale</span>(camden_oas_sp<span class="sc">$</span>n_thefts)</span></code></pre></div>
<p>To compare this rescaled value against its neighbours, we subsequently need to create a new column that carries information about the neighbours. This is called a spatial lag function. The “lag” just refers to the fact you are comparing one observation against another, this can also be used between timed observations. In this case, the “lag” we are looking at is between neighbours.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="spatial-autocorrelation-and-dependence.html#cb83-1" tabindex="-1"></a><span class="co"># create a spatial lag variable </span></span>
<span id="cb83-2"><a href="spatial-autocorrelation-and-dependence.html#cb83-2" tabindex="-1"></a>camden_oas_sp<span class="sc">$</span>lag_scale_n_thefts <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(nb_weights_list, camden_oas_sp<span class="sc">$</span>scale_n_thefts)</span></code></pre></div>
<p>Now we have used <code>sp</code> for all it is worth it’s time to head back to the safety of <code>sf()</code> before exploring any forms of more localised patterns.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="spatial-autocorrelation-and-dependence.html#cb84-1" tabindex="-1"></a><span class="co"># convert to sf</span></span>
<span id="cb84-2"><a href="spatial-autocorrelation-and-dependence.html#cb84-2" tabindex="-1"></a>camden_oas_moran_stats <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(camden_oas_sp)</span></code></pre></div>
<p>To make a human readable version of the map we will generate some labels for our findings from the <a href="https://en.wikipedia.org/wiki/Indicators_of_spatial_association">Local Moran’s I</a> stats. This process calculates what the value of each polygon is compared to its neighbours and works out if they are similar or dissimilar and in which way, then gives them a text label to describe the relationship.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="spatial-autocorrelation-and-dependence.html#cb85-1" tabindex="-1"></a><span class="co"># set a significance value</span></span>
<span id="cb85-2"><a href="spatial-autocorrelation-and-dependence.html#cb85-2" tabindex="-1"></a>sig_level <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb85-3"><a href="spatial-autocorrelation-and-dependence.html#cb85-3" tabindex="-1"></a></span>
<span id="cb85-4"><a href="spatial-autocorrelation-and-dependence.html#cb85-4" tabindex="-1"></a><span class="co"># classification with significance value</span></span>
<span id="cb85-5"><a href="spatial-autocorrelation-and-dependence.html#cb85-5" tabindex="-1"></a>camden_oas_moran_stats<span class="sc">$</span>quad_sig <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(camden_oas_moran_stats<span class="sc">$</span>scale_n_thefts <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb85-6"><a href="spatial-autocorrelation-and-dependence.html#cb85-6" tabindex="-1"></a>                                          camden_oas_moran_stats<span class="sc">$</span>lag_scale_n_thefts <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb85-7"><a href="spatial-autocorrelation-and-dependence.html#cb85-7" tabindex="-1"></a>                                          local_moran_camden_oa_theft[,<span class="dv">5</span>] <span class="sc">&lt;=</span> sig_level, </span>
<span id="cb85-8"><a href="spatial-autocorrelation-and-dependence.html#cb85-8" tabindex="-1"></a>                                          <span class="st">&#39;high-high&#39;</span>, </span>
<span id="cb85-9"><a href="spatial-autocorrelation-and-dependence.html#cb85-9" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(camden_oas_moran_stats<span class="sc">$</span>scale_n_thefts <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb85-10"><a href="spatial-autocorrelation-and-dependence.html#cb85-10" tabindex="-1"></a>                                          camden_oas_moran_stats<span class="sc">$</span>lag_scale_n_thefts <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb85-11"><a href="spatial-autocorrelation-and-dependence.html#cb85-11" tabindex="-1"></a>                                          local_moran_camden_oa_theft[,<span class="dv">5</span>] <span class="sc">&lt;=</span> sig_level, </span>
<span id="cb85-12"><a href="spatial-autocorrelation-and-dependence.html#cb85-12" tabindex="-1"></a>                                          <span class="st">&#39;low-low&#39;</span>, </span>
<span id="cb85-13"><a href="spatial-autocorrelation-and-dependence.html#cb85-13" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(camden_oas_moran_stats<span class="sc">$</span>scale_n_thefts <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb85-14"><a href="spatial-autocorrelation-and-dependence.html#cb85-14" tabindex="-1"></a>                                          camden_oas_moran_stats<span class="sc">$</span>lag_scale_n_thefts <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb85-15"><a href="spatial-autocorrelation-and-dependence.html#cb85-15" tabindex="-1"></a>                                          local_moran_camden_oa_theft[,<span class="dv">5</span>] <span class="sc">&lt;=</span> sig_level, </span>
<span id="cb85-16"><a href="spatial-autocorrelation-and-dependence.html#cb85-16" tabindex="-1"></a>                                          <span class="st">&#39;high-low&#39;</span>, </span>
<span id="cb85-17"><a href="spatial-autocorrelation-and-dependence.html#cb85-17" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(camden_oas_moran_stats<span class="sc">$</span>scale_n_thefts <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb85-18"><a href="spatial-autocorrelation-and-dependence.html#cb85-18" tabindex="-1"></a>                                          camden_oas_moran_stats<span class="sc">$</span>lag_scale_n_thefts <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb85-19"><a href="spatial-autocorrelation-and-dependence.html#cb85-19" tabindex="-1"></a>                                          local_moran_camden_oa_theft[,<span class="dv">5</span>] <span class="sc">&lt;=</span> sig_level, </span>
<span id="cb85-20"><a href="spatial-autocorrelation-and-dependence.html#cb85-20" tabindex="-1"></a>                                          <span class="st">&#39;low-high&#39;</span>,</span>
<span id="cb85-21"><a href="spatial-autocorrelation-and-dependence.html#cb85-21" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(local_moran_camden_oa_theft[,<span class="dv">5</span>] <span class="sc">&gt;</span> sig_level, </span>
<span id="cb85-22"><a href="spatial-autocorrelation-and-dependence.html#cb85-22" tabindex="-1"></a>                                          <span class="st">&#39;not-significant&#39;</span>, </span>
<span id="cb85-23"><a href="spatial-autocorrelation-and-dependence.html#cb85-23" tabindex="-1"></a>                                          <span class="st">&#39;not-significant&#39;</span>)))))</span>
<span id="cb85-24"><a href="spatial-autocorrelation-and-dependence.html#cb85-24" tabindex="-1"></a></span>
<span id="cb85-25"><a href="spatial-autocorrelation-and-dependence.html#cb85-25" tabindex="-1"></a><span class="co"># classification without significance value</span></span>
<span id="cb85-26"><a href="spatial-autocorrelation-and-dependence.html#cb85-26" tabindex="-1"></a>camden_oas_moran_stats<span class="sc">$</span>quad_non_sig <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(camden_oas_moran_stats<span class="sc">$</span>scale_n_thefts <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb85-27"><a href="spatial-autocorrelation-and-dependence.html#cb85-27" tabindex="-1"></a>                                              camden_oas_moran_stats<span class="sc">$</span>lag_scale_n_thefts <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb85-28"><a href="spatial-autocorrelation-and-dependence.html#cb85-28" tabindex="-1"></a>                                              <span class="st">&#39;high-high&#39;</span>, </span>
<span id="cb85-29"><a href="spatial-autocorrelation-and-dependence.html#cb85-29" tabindex="-1"></a>                                       <span class="fu">ifelse</span>(camden_oas_moran_stats<span class="sc">$</span>scale_n_thefts <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb85-30"><a href="spatial-autocorrelation-and-dependence.html#cb85-30" tabindex="-1"></a>                                              camden_oas_moran_stats<span class="sc">$</span>lag_scale_n_thefts <span class="sc">&lt;=</span> <span class="dv">0</span>, </span>
<span id="cb85-31"><a href="spatial-autocorrelation-and-dependence.html#cb85-31" tabindex="-1"></a>                                              <span class="st">&#39;low-low&#39;</span>, </span>
<span id="cb85-32"><a href="spatial-autocorrelation-and-dependence.html#cb85-32" tabindex="-1"></a>                                       <span class="fu">ifelse</span>(camden_oas_moran_stats<span class="sc">$</span>scale_n_thefts <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb85-33"><a href="spatial-autocorrelation-and-dependence.html#cb85-33" tabindex="-1"></a>                                              camden_oas_moran_stats<span class="sc">$</span>lag_scale_n_thefts <span class="sc">&lt;=</span> <span class="dv">0</span>, </span>
<span id="cb85-34"><a href="spatial-autocorrelation-and-dependence.html#cb85-34" tabindex="-1"></a>                                              <span class="st">&#39;high-low&#39;</span>, </span>
<span id="cb85-35"><a href="spatial-autocorrelation-and-dependence.html#cb85-35" tabindex="-1"></a>                                       <span class="fu">ifelse</span>(camden_oas_moran_stats<span class="sc">$</span>scale_n_thefts <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb85-36"><a href="spatial-autocorrelation-and-dependence.html#cb85-36" tabindex="-1"></a>                                              camden_oas_moran_stats<span class="sc">$</span>lag_scale_n_thefts <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb85-37"><a href="spatial-autocorrelation-and-dependence.html#cb85-37" tabindex="-1"></a>                                              <span class="st">&#39;low-high&#39;</span>,<span class="cn">NA</span>))))</span></code></pre></div>
<p>To understand how this is working we can look at the data non-spatially. As we rescaled the data, our axes should split the data neatly into their different area vs spatial lag relationship categories. Let’s make the scatterplot using the scaled number of thefts for the areas in the x axis and their spatially lagged results in the y axis.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="spatial-autocorrelation-and-dependence.html#cb86-1" tabindex="-1"></a><span class="co"># plot 1</span></span>
<span id="cb86-2"><a href="spatial-autocorrelation-and-dependence.html#cb86-2" tabindex="-1"></a><span class="co"># plot the results without the statistical significance</span></span>
<span id="cb86-3"><a href="spatial-autocorrelation-and-dependence.html#cb86-3" tabindex="-1"></a><span class="fu">ggplot</span>(camden_oas_moran_stats, <span class="fu">aes</span>(<span class="at">x =</span> scale_n_thefts, </span>
<span id="cb86-4"><a href="spatial-autocorrelation-and-dependence.html#cb86-4" tabindex="-1"></a>                                   <span class="at">y =</span> lag_scale_n_thefts, </span>
<span id="cb86-5"><a href="spatial-autocorrelation-and-dependence.html#cb86-5" tabindex="-1"></a>                                   <span class="at">color =</span> quad_non_sig)) <span class="sc">+</span></span>
<span id="cb86-6"><a href="spatial-autocorrelation-and-dependence.html#cb86-6" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="co"># plot vertical line</span></span>
<span id="cb86-7"><a href="spatial-autocorrelation-and-dependence.html#cb86-7" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="co"># plot horizontal line</span></span>
<span id="cb86-8"><a href="spatial-autocorrelation-and-dependence.html#cb86-8" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Scaled Thefts (n)&#39;</span>) <span class="sc">+</span></span>
<span id="cb86-9"><a href="spatial-autocorrelation-and-dependence.html#cb86-9" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Lagged Scaled Thefts (n)&#39;</span>) <span class="sc">+</span></span>
<span id="cb86-10"><a href="spatial-autocorrelation-and-dependence.html#cb86-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">&#39;Relative to neighbours&#39;</span>) <span class="sc">+</span></span>
<span id="cb86-11"><a href="spatial-autocorrelation-and-dependence.html#cb86-11" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="images/general/week3/image8_plot_hotcold.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="spatial-autocorrelation-and-dependence.html#cb87-1" tabindex="-1"></a><span class="co"># plot 2</span></span>
<span id="cb87-2"><a href="spatial-autocorrelation-and-dependence.html#cb87-2" tabindex="-1"></a><span class="co"># plot the results with the statistical significance</span></span>
<span id="cb87-3"><a href="spatial-autocorrelation-and-dependence.html#cb87-3" tabindex="-1"></a><span class="fu">ggplot</span>(camden_oas_moran_stats, <span class="fu">aes</span>(<span class="at">x =</span> scale_n_thefts, </span>
<span id="cb87-4"><a href="spatial-autocorrelation-and-dependence.html#cb87-4" tabindex="-1"></a>                                   <span class="at">y =</span> lag_scale_n_thefts, </span>
<span id="cb87-5"><a href="spatial-autocorrelation-and-dependence.html#cb87-5" tabindex="-1"></a>                                   <span class="at">color =</span> quad_sig)) <span class="sc">+</span></span>
<span id="cb87-6"><a href="spatial-autocorrelation-and-dependence.html#cb87-6" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="co"># plot vertical line</span></span>
<span id="cb87-7"><a href="spatial-autocorrelation-and-dependence.html#cb87-7" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="co"># plot horizontal line</span></span>
<span id="cb87-8"><a href="spatial-autocorrelation-and-dependence.html#cb87-8" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Scaled Thefts (n)&#39;</span>) <span class="sc">+</span></span>
<span id="cb87-9"><a href="spatial-autocorrelation-and-dependence.html#cb87-9" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Lagged Scaled Thefts (n)&#39;</span>) <span class="sc">+</span></span>
<span id="cb87-10"><a href="spatial-autocorrelation-and-dependence.html#cb87-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">&#39;Relative to neighbours&#39;</span>) <span class="sc">+</span></span>
<span id="cb87-11"><a href="spatial-autocorrelation-and-dependence.html#cb87-11" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="images/general/week3/image9_plot_significance.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Now let’s see how they are arranged spatially.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="spatial-autocorrelation-and-dependence.html#cb88-1" tabindex="-1"></a><span class="co"># map all of the results here</span></span>
<span id="cb88-2"><a href="spatial-autocorrelation-and-dependence.html#cb88-2" tabindex="-1"></a><span class="fu">tm_shape</span>(camden_oas_moran_stats) <span class="sc">+</span></span>
<span id="cb88-3"><a href="spatial-autocorrelation-and-dependence.html#cb88-3" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">&#39;quad_non_sig&#39;</span>, <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#de2d26&quot;</span>, <span class="st">&quot;#fee0d2&quot;</span>, <span class="st">&quot;#deebf7&quot;</span>, <span class="st">&quot;#3182bd&quot;</span>))</span></code></pre></div>
<p><img src="images/general/week3/image10_map_hotcold.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="spatial-autocorrelation-and-dependence.html#cb89-1" tabindex="-1"></a><span class="co"># map only the statistically significant results here</span></span>
<span id="cb89-2"><a href="spatial-autocorrelation-and-dependence.html#cb89-2" tabindex="-1"></a><span class="co"># map only the statistically significant results here</span></span>
<span id="cb89-3"><a href="spatial-autocorrelation-and-dependence.html#cb89-3" tabindex="-1"></a><span class="fu">tm_shape</span>(camden_oas_moran_stats) <span class="sc">+</span></span>
<span id="cb89-4"><a href="spatial-autocorrelation-and-dependence.html#cb89-4" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">&#39;quad_sig&#39;</span>, <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#de2d26&quot;</span>, <span class="st">&quot;#fee0d2&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="sc">+</span></span>
<span id="cb89-5"><a href="spatial-autocorrelation-and-dependence.html#cb89-5" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;grey&quot;</span>)</span></code></pre></div>
<p><img src="images/general/week3/image11_map_significance.png" width="100%" style="display: block; margin: auto;" /></p>
<p>As our data are so spatially clustered we can’t see any outlier places (once we have ignored the non-significant results). This suggests that the pattern of theft from persons is not highly concentrated in very small areas or particular Output Areas, and instead is spread on a larger scale than we have used here. To go further than we have today it would be possible to run the exact same code but using a larger scale, perhaps LSOA, or Ward, and compare how this changes the Moran’s I statistics globally and locally. Or, to gain statistical significance in looking at the difference between areas getting more data perhaps over a longer timescale, where there are less areas with 0 thefts.</p>
</div>
</div>
<div id="attributions" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Attributions<a href="spatial-autocorrelation-and-dependence.html#attributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This week’s practical uses content and inspiration from:</p>
<ol style="list-style-type: decimal">
<li>Long, A. 2020. Spatial autocorrelation. <a href="https://github.com/jtvandijk/GEOG0114_20202021/blob/master/04-week04.Rmd"><strong>[Source]</strong></a></li>
<li>Dijk, J.V. 2021. Spatial autocorrelation. <a href="https://github.com/jtvandijk/GEOG0114_20212022/blob/master/02-spatial-autocorrelation.Rmd"><strong>[Source]</strong></a></li>
<li>Gimond, M. 2021. Spatial autocorrelation in R. <a href="https://mgimond.github.io/Spatial/spatial-autocorrelation-in-r.html"><strong>[Source]</strong></a></li>
</ol>
</div>
<div id="references-see-reading-list" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> References (see reading list)<a href="spatial-autocorrelation-and-dependence.html#references-see-reading-list" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><strong>Gitbook</strong>: [R Programming] Gimond, M. (2021) Intro to GIS and spatial analysis. <strong>Chapter 13: Spatial autocorrelation</strong> <a href="https://mgimond.github.io/Spatial/spatial-autocorrelation.html"><strong>Click link</strong></a></li>
<li><strong>Book</strong>: [Theory] Longley, P. <em>et al</em> (2015) Geographic Information Science &amp; systems (4th Edition); <strong>Chapter 2: The Nature of Geographic Data</strong> <a href="https://rl.talis.com/3/ucl/items/ea2386fb-19dc-460a-acba-bda3737546c2.html?lang=en-gb&amp;login=1"><strong>Click link</strong></a></li>
<li><strong>Book</strong>: [Theory] Longley, P. _*et al_ (2015) Geographic Information Science &amp; systems (4th Edition); <strong>Chapter 13: Spatial Analysis</strong> <a href="https://rl.talis.com/3/ucl/items/fd38ec78-2bea-4165-aab3-0e9d9093db8e.html?lang=en-gb&amp;login=1"><strong>Click link</strong></a></li>
<li><strong>Paper</strong>: [Research] Radil, S. 2016. Spatial analysis of crime. In: Huebner, B. and Bynum, T. <em>The Handbook of Measurement Issues in Criminology and Criminal Justice</em>, Chapter 24, pp.536-554. <a href="https://doi.org/10.1002/9781118868799.ch24"><strong>Click link</strong></a> (Note: use of your UCL login via institutional organisation (<strong>UK Federation</strong>) is required to access the digital paper)</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="graphical-representation-of-spatial-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="suitability-mapping-part-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": true
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/UCLPG-MSC-SGDS/GEOG0114/edit/main/04-Spatial_autocorrelation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
