<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Spatial Models: Part 2 | GEOG0114: Principles of Spatial Analysis (2023/24)</title>
  <meta name="description" content="GEOG0114: Principles of Spatial Analysis" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Spatial Models: Part 2 | GEOG0114: Principles of Spatial Analysis (2023/24)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="GEOG0114: Principles of Spatial Analysis" />
  <meta name="github-repo" content="UCLPG-MSC-SGDS/GEOG0114" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Spatial Models: Part 2 | GEOG0114: Principles of Spatial Analysis (2023/24)" />
  
  <meta name="twitter:description" content="GEOG0114: Principles of Spatial Analysis" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spatial-models-part-1.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="assets/custom.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo">
<a href="https://www.ucl.ac.uk/module-catalogue/modules/GEOG0114"><img src="images/general/ucl_logo.png">
</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i>Structure</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#moodle"><i class="fa fa-check"></i>Moodle</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#module-tutors-and-contacts-for-geog0114"><i class="fa fa-check"></i>Module tutors and contacts for GEOG0114</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html"><i class="fa fa-check"></i>Reading List for GEOG0114 2023/24</a>
<ul>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-1-spatial-analysis-for-data-science"><i class="fa fa-check"></i>Week 1: Spatial analysis for data science</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-2-graphical-representation-of-spatial-data"><i class="fa fa-check"></i>Week 2: Graphical representation of spatial data</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-3-spatial-autocorrelation"><i class="fa fa-check"></i>Week 3: Spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-4-suitability-mapping-part-1"><i class="fa fa-check"></i>Week 4: Suitability Mapping (Part 1)</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-5-suitability-mapping-part-2"><i class="fa fa-check"></i>Week 5: Suitability Mapping (Part 2)</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-6-geostatistical-modelling"><i class="fa fa-check"></i>Week 6: Geostatistical Modelling</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-9-spatial-models-part-1"><i class="fa fa-check"></i>Week 9: Spatial Models (Part 1)</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-10-spatial-models-part-2"><i class="fa fa-check"></i>Week 10: Spatial Models (Part 2)</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="installation-of-r-and-rstudio.html"><a href="installation-of-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Installation of R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="installation-of-r-and-rstudio.html"><a href="installation-of-r-and-rstudio.html#what-is-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> What is R and RStudio?</a></li>
<li class="chapter" data-level="1.2" data-path="installation-of-r-and-rstudio.html"><a href="installation-of-r-and-rstudio.html#downloading-and-install-r-and-rstudio-on-to-your-laptop"><i class="fa fa-check"></i><b>1.2</b> Downloading and install R and RStudio on to your laptop</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="installation-of-r-and-rstudio.html"><a href="installation-of-r-and-rstudio.html#installation-for-macos-users"><i class="fa fa-check"></i><b>1.2.1</b> Installation for MacOS users</a></li>
<li class="chapter" data-level="1.2.2" data-path="installation-of-r-and-rstudio.html"><a href="installation-of-r-and-rstudio.html#installation-for-windows-users"><i class="fa fa-check"></i><b>1.2.2</b> Installation for Windows users</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html"><i class="fa fa-check"></i><b>2</b> Spatial analysis for data sciences</a>
<ul>
<li class="chapter" data-level="2.1" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#lecture-video-length-010001"><i class="fa fa-check"></i><b>2.1.1</b> Lecture video (Length: 01:00:01)</a></li>
<li class="chapter" data-level="2.1.2" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#computer-practical-video-length-015949"><i class="fa fa-check"></i><b>2.1.2</b> Computer practical video (Length: 01:59:49)</a></li>
<li class="chapter" data-level="2.1.3" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#learning-outcomes"><i class="fa fa-check"></i><b>2.1.3</b> Learning outcomes</a></li>
<li class="chapter" data-level="2.1.4" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#becoming-familiar-with-the-panels-in-rstudio"><i class="fa fa-check"></i><b>2.1.4</b> Becoming familiar with the panels in RStudio</a></li>
<li class="chapter" data-level="2.1.5" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#using-r-console-as-a-calculator"><i class="fa fa-check"></i><b>2.1.5</b> Using R Console as a Calculator</a></li>
<li class="chapter" data-level="2.1.6" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#creating-basic-objects-and-assigning-values-to-it"><i class="fa fa-check"></i><b>2.1.6</b> Creating basic objects and assigning values to it</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#basics-of-managing-data-in-rstudio"><i class="fa fa-check"></i><b>2.2</b> Basics of managing data in RStudio</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#how-do-we-enter-data-into-rstudio"><i class="fa fa-check"></i><b>2.2.1</b> How do we enter data into RStudio?</a></li>
<li class="chapter" data-level="2.2.2" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#how-do-we-create-a-variable-based-on-other-existing-variables-in-our-data-frame"><i class="fa fa-check"></i><b>2.2.2</b> How do we create a variable based on other existing variables in our data frame?</a></li>
<li class="chapter" data-level="2.2.3" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#how-do-we-set-the-working-directory-in-our-computer-by-connecting-our-folder-to-rstudio-with-the-setwd-function"><i class="fa fa-check"></i><b>2.2.3</b> How do we set the working directory in our computer by connecting our folder to RStudio with the <code>setwd()</code> function?</a></li>
<li class="chapter" data-level="2.2.4" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#how-do-we-import-merge-and-export-csv-data-with-rstudio"><i class="fa fa-check"></i><b>2.2.4</b> How do we import, merge and export CSV data with RStudio?</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#basic-visualisation-of-spatial-data-in-rstudio"><i class="fa fa-check"></i><b>2.3</b> Basic visualisation of spatial data in RStudio</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#installing-packages-into-rstudio"><i class="fa fa-check"></i><b>2.3.1</b> Installing packages into RStudio</a></li>
<li class="chapter" data-level="2.3.2" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#adding-shapefiles-in-rstudio"><i class="fa fa-check"></i><b>2.3.2</b> Adding shapefiles in RStudio</a></li>
<li class="chapter" data-level="2.3.3" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#mapping-with-tmap-functions-in-rstudio"><i class="fa fa-check"></i><b>2.3.3</b> Mapping with ‘tmap’ functions in RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#references"><i class="fa fa-check"></i><b>2.4</b> References</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#recommended-reading-see-reading-list"><i class="fa fa-check"></i><b>2.4.1</b> Recommended reading (see reading list)</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#data-sources"><i class="fa fa-check"></i><b>2.5</b> Data Sources</a></li>
<li class="chapter" data-level="2.6" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#practical-homework"><i class="fa fa-check"></i><b>2.6</b> Practical homework</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html"><i class="fa fa-check"></i><b>3</b> Graphical representation of spatial data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#lecture-video-length-4313"><i class="fa fa-check"></i><b>3.1.1</b> Lecture video (Length: 43:13)</a></li>
<li class="chapter" data-level="3.1.2" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#computer-practical-video-length-015948"><i class="fa fa-check"></i><b>3.1.2</b> Computer practical video (Length: 01:59:48)</a></li>
<li class="chapter" data-level="3.1.3" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#learning-outcomes-1"><i class="fa fa-check"></i><b>3.1.3</b> Learning outcomes</a></li>
<li class="chapter" data-level="3.1.4" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#getting_started_w03"><i class="fa fa-check"></i><b>3.1.4</b> Getting started</a></li>
<li class="chapter" data-level="3.1.5" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#datasets-setting-up-the-work-directory"><i class="fa fa-check"></i><b>3.1.5</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="3.1.6" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#loading-and-installing-packages"><i class="fa fa-check"></i><b>3.1.6</b> Loading and installing packages</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#case_study_w03"><i class="fa fa-check"></i><b>3.2</b> Case study</a></li>
<li class="chapter" data-level="3.3" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#loading_data_w03"><i class="fa fa-check"></i><b>3.3</b> Loading our data sets for case study</a></li>
<li class="chapter" data-level="3.4" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#data-processing"><i class="fa fa-check"></i><b>3.4</b> Data Processing</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#reprojecting"><i class="fa fa-check"></i><b>3.4.1</b> Reprojecting</a></li>
<li class="chapter" data-level="3.4.2" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#dissolving"><i class="fa fa-check"></i><b>3.4.2</b> Dissolving</a></li>
<li class="chapter" data-level="3.4.3" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#subsetting"><i class="fa fa-check"></i><b>3.4.3</b> Subsetting</a></li>
<li class="chapter" data-level="3.4.4" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#unioning"><i class="fa fa-check"></i><b>3.4.4</b> Unioning</a></li>
<li class="chapter" data-level="3.4.5" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#clipping"><i class="fa fa-check"></i><b>3.4.5</b> Clipping</a></li>
<li class="chapter" data-level="3.4.6" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#attribute-selection"><i class="fa fa-check"></i><b>3.4.6</b> Attribute selection</a></li>
<li class="chapter" data-level="3.4.7" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#buffering"><i class="fa fa-check"></i><b>3.4.7</b> Buffering</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#greenspace-in-london"><i class="fa fa-check"></i><b>3.5</b> Greenspace in London</a></li>
<li class="chapter" data-level="3.6" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#attributions_w03"><i class="fa fa-check"></i><b>3.6</b> Attributions</a></li>
<li class="chapter" data-level="3.7" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#reading_w03"><i class="fa fa-check"></i><b>3.7</b> References (see reading list)</a></li>
<li class="chapter" data-level="3.8" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#data-sources-1"><i class="fa fa-check"></i><b>3.8</b> Data Sources</a></li>
<li class="chapter" data-level="3.9" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#practical-homework-1"><i class="fa fa-check"></i><b>3.9</b> Practical homework</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html"><i class="fa fa-check"></i><b>4</b> Spatial autocorrelation and dependence</a>
<ul>
<li class="chapter" data-level="4.1" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#lecture-video-length-010642"><i class="fa fa-check"></i><b>4.1.1</b> Lecture video (Length: 01:06:42)</a></li>
<li class="chapter" data-level="4.1.2" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#computer-practical-video-length-020001"><i class="fa fa-check"></i><b>4.1.2</b> Computer practical video (Length: 02:00:01)</a></li>
<li class="chapter" data-level="4.1.3" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#learning-outcomes-2"><i class="fa fa-check"></i><b>4.1.3</b> Learning outcomes</a></li>
<li class="chapter" data-level="4.1.4" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#getting-started"><i class="fa fa-check"></i><b>4.1.4</b> Getting started</a></li>
<li class="chapter" data-level="4.1.5" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#datasets-setting-up-the-work-directory-1"><i class="fa fa-check"></i><b>4.1.5</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="4.1.6" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#loading-and-installing-packages-1"><i class="fa fa-check"></i><b>4.1.6</b> Loading and installing packages</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#case-study"><i class="fa fa-check"></i><b>4.2</b> Case study</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#neighbours"><i class="fa fa-check"></i><b>4.2.1</b> Neighbours</a></li>
<li class="chapter" data-level="4.2.2" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#theft-in-camden"><i class="fa fa-check"></i><b>4.2.2</b> Theft in Camden</a></li>
<li class="chapter" data-level="4.2.3" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#global-morans-i"><i class="fa fa-check"></i><b>4.2.3</b> Global Moran’s I</a></li>
<li class="chapter" data-level="4.2.4" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#local-morans-i-or-lisa"><i class="fa fa-check"></i><b>4.2.4</b> Local Moran’s I (or LISA)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#attributions"><i class="fa fa-check"></i><b>4.3</b> Attributions</a></li>
<li class="chapter" data-level="4.4" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#references-see-reading-list"><i class="fa fa-check"></i><b>4.4</b> References (see reading list)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html"><i class="fa fa-check"></i><b>5</b> Suitability Mapping: Part 1</a>
<ul>
<li class="chapter" data-level="5.1" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#lecture-video-tbc"><i class="fa fa-check"></i><b>5.1.1</b> Lecture video (TBC)</a></li>
<li class="chapter" data-level="5.1.2" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#computer-practical-video-length-020001-1"><i class="fa fa-check"></i><b>5.1.2</b> Computer practical video (Length: 02:00:01)</a></li>
<li class="chapter" data-level="5.1.3" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#learning-outcomes-3"><i class="fa fa-check"></i><b>5.1.3</b> Learning outcomes</a></li>
<li class="chapter" data-level="5.1.4" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#datasets-setting-up-the-work-directory-2"><i class="fa fa-check"></i><b>5.1.4</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="5.1.5" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#loading-and-installing-packages-2"><i class="fa fa-check"></i><b>5.1.5</b> Loading and installing packages</a></li>
<li class="chapter" data-level="5.1.6" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#loading-datasets"><i class="fa fa-check"></i><b>5.1.6</b> Loading datasets</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#suitability-mapping-using-simple-overlays"><i class="fa fa-check"></i><b>5.2</b> Suitability mapping using Simple Overlays</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#setting-up-binary-classification-on-raster"><i class="fa fa-check"></i><b>5.2.1</b> Setting up binary classification on raster</a></li>
<li class="chapter" data-level="5.2.2" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#finding-areas-of-suitability-by-multiplying-the-binary-rasters"><i class="fa fa-check"></i><b>5.2.2</b> Finding areas of suitability by multiplying the binary rasters</a></li>
<li class="chapter" data-level="5.2.3" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#finding-areas-of-suitability-by-summing-the-binary-rasters"><i class="fa fa-check"></i><b>5.2.3</b> Finding areas of suitability by summing the binary rasters</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#analytical-hierarchy-process-ahp"><i class="fa fa-check"></i><b>5.3</b> Analytical Hierarchy Process (AHP)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#standardizing-the-raster-variables-to-the-same-scale-from-1-to-10"><i class="fa fa-check"></i><b>5.3.1</b> Standardizing the raster variables to the same scale (from 1 to 10)</a></li>
<li class="chapter" data-level="5.3.2" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#determining-the-weight-of-each-variable-using-saatys-ahp"><i class="fa fa-check"></i><b>5.3.2</b> Determining the weight of each variable using Saaty’s AHP</a></li>
<li class="chapter" data-level="5.3.3" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#weighted-linear-combination-wlc-and-derivation-of-suitability-maps-based-from-ahp-analysis"><i class="fa fa-check"></i><b>5.3.3</b> Weighted Linear Combination (WLC) and derivation of Suitability Maps based from AHP analysis</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#references-see-reading-list-1"><i class="fa fa-check"></i><b>5.4</b> References (see reading list)</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#recommended-reading"><i class="fa fa-check"></i><b>5.4.1</b> Recommended reading</a></li>
<li class="chapter" data-level="5.4.2" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#data-sources-2"><i class="fa fa-check"></i><b>5.4.2</b> Data Sources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html"><i class="fa fa-check"></i><b>6</b> Suitability Mapping: Part 2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#lecture-video-length-010642-1"><i class="fa fa-check"></i><b>6.1.1</b> Lecture video (Length: 01:06:42)</a></li>
<li class="chapter" data-level="6.1.2" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#computer-practical-video-length-020001-2"><i class="fa fa-check"></i><b>6.1.2</b> Computer practical video (Length 02:00:01)</a></li>
<li class="chapter" data-level="6.1.3" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#learning-outcomes-4"><i class="fa fa-check"></i><b>6.1.3</b> Learning outcomes</a></li>
<li class="chapter" data-level="6.1.4" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#datasets-setting-up-the-work-directory-3"><i class="fa fa-check"></i><b>6.1.4</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="6.1.5" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#loading-and-installing-packages-3"><i class="fa fa-check"></i><b>6.1.5</b> Loading and installing packages</a></li>
<li class="chapter" data-level="6.1.6" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#loading-datasets-1"><i class="fa fa-check"></i><b>6.1.6</b> Loading datasets</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#data-preparation-for-the-maxent-analysis"><i class="fa fa-check"></i><b>6.2</b> Data preparation for the MAXENT analysis</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#creating-a-multi-band-raster-using-the-stack-function"><i class="fa fa-check"></i><b>6.2.1</b> Creating a multi-band raster using the stack() function</a></li>
<li class="chapter" data-level="6.2.2" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#preparing-data-for-pseudo-background-points-as-absence"><i class="fa fa-check"></i><b>6.2.2</b> Preparing data for pseudo-background points as absence</a></li>
<li class="chapter" data-level="6.2.3" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#extraction-of-all-raster-values-from-predictor-variables-onto-presence-absence-points"><i class="fa fa-check"></i><b>6.2.3</b> Extraction of all raster values from predictor variables onto presence-absence points</a></li>
<li class="chapter" data-level="6.2.4" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#preparation-of-training-test-data-for-prediction-model-cross-validation"><i class="fa fa-check"></i><b>6.2.4</b> Preparation of training &amp; test data for prediction &amp; model cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#maxent-analysis"><i class="fa fa-check"></i><b>6.3</b> MAXENT Analysis</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#examination-of-the-predictors-contribution-and-response-curves"><i class="fa fa-check"></i><b>6.3.1</b> Examination of the predictor’s contribution and response curves</a></li>
<li class="chapter" data-level="6.3.2" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#model-validation"><i class="fa fa-check"></i><b>6.3.2</b> Model validation</a></li>
<li class="chapter" data-level="6.3.3" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#mapping-the-predicted-probability-and-suitability"><i class="fa fa-check"></i><b>6.3.3</b> Mapping the predicted probability and suitability</a></li>
<li class="chapter" data-level="6.3.4" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#supplementary-code-for-4-fold-analysis"><i class="fa fa-check"></i><b>6.3.4</b> Supplementary code for 4-fold analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#attributions-1"><i class="fa fa-check"></i><b>6.4</b> Attributions</a></li>
<li class="chapter" data-level="6.5" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#references-see-reading-list-2"><i class="fa fa-check"></i><b>6.5</b> References (see reading list)</a></li>
<li class="chapter" data-level="6.6" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#data-sources-3"><i class="fa fa-check"></i><b>6.6</b> Data Sources</a></li>
<li class="chapter" data-level="6.7" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#practical-homework-2"><i class="fa fa-check"></i><b>6.7</b> Practical homework</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html"><i class="fa fa-check"></i><b>7</b> Geostatistical Modelling</a>
<ul>
<li class="chapter" data-level="7.1" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#introduction-5"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#lecture-video-length-010617"><i class="fa fa-check"></i><b>7.1.1</b> Lecture video (Length: 01:06:17)</a></li>
<li class="chapter" data-level="7.1.2" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#computer-practical-video-length-020001-3"><i class="fa fa-check"></i><b>7.1.2</b> Computer practical video (Length: 02:00:01)</a></li>
<li class="chapter" data-level="7.1.3" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#learning-objectives"><i class="fa fa-check"></i><b>7.1.3</b> Learning objectives</a></li>
<li class="chapter" data-level="7.1.4" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#datasets-setting-up-the-work-directory-4"><i class="fa fa-check"></i><b>7.1.4</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="7.1.5" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#loading-and-installing-packages-4"><i class="fa fa-check"></i><b>7.1.5</b> Loading and installing packages</a></li>
<li class="chapter" data-level="7.1.6" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#loading-datasets-2"><i class="fa fa-check"></i><b>7.1.6</b> Loading datasets</a></li>
<li class="chapter" data-level="7.1.7" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#data-preparation"><i class="fa fa-check"></i><b>7.1.7</b> Data preparation</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#semivariogram-analysis"><i class="fa fa-check"></i><b>7.2</b> Semivariogram analysis</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#plotting-the-empirical-semivariogram"><i class="fa fa-check"></i><b>7.2.1</b> Plotting the Empirical Semivariogram</a></li>
<li class="chapter" data-level="7.2.2" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#plotting-the-theoretical-semivariogram"><i class="fa fa-check"></i><b>7.2.2</b> Plotting the Theoretical Semivariogram</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#kriging-modelling-null"><i class="fa fa-check"></i><b>7.3</b> Kriging modelling (null)</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#building-a-blank-raster-template"><i class="fa fa-check"></i><b>7.3.1</b> Building a blank raster template</a></li>
<li class="chapter" data-level="7.3.2" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#implementing-the-spatial-interpolation-on-blank-template-using-kriging"><i class="fa fa-check"></i><b>7.3.2</b> Implementing the spatial interpolation on blank template using Kriging</a></li>
<li class="chapter" data-level="7.3.3" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#how-to-export-the-results-as-.tiff-format-thematic-visualisation-in-tmap"><i class="fa fa-check"></i><b>7.3.3</b> How to export the results as .tiff format thematic visualisation in <code>tmap</code></a></li>
<li class="chapter" data-level="7.3.4" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#thematic-visualisation-of-raster-data-using-tmap"><i class="fa fa-check"></i><b>7.3.4</b> Thematic visualisation of raster data using <code>tmap</code></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#kriging-modelling-non-null"><i class="fa fa-check"></i><b>7.4</b> Kriging modelling (non-null)</a></li>
<li class="chapter" data-level="7.5" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#references-see-reading-list-3"><i class="fa fa-check"></i><b>7.5</b> References (see reading list)</a></li>
<li class="chapter" data-level="7.6" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#data-sources-4"><i class="fa fa-check"></i><b>7.6</b> Data Sources</a></li>
<li class="chapter" data-level="7.7" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#practical-homework-3"><i class="fa fa-check"></i><b>7.7</b> Practical homework</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html"><i class="fa fa-check"></i><b>8</b> Spatial Models: Part 1</a>
<ul>
<li class="chapter" data-level="8.1" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#introduction-6"><i class="fa fa-check"></i><b>8.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#lecture-video-length-004147"><i class="fa fa-check"></i><b>8.1.1</b> Lecture video (Length: 00:41:47)</a></li>
<li class="chapter" data-level="8.1.2" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#computer-practical-video-length-020001-4"><i class="fa fa-check"></i><b>8.1.2</b> Computer practical video (Length: 02:00:01)</a></li>
<li class="chapter" data-level="8.1.3" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#learning-objective"><i class="fa fa-check"></i><b>8.1.3</b> Learning objective</a></li>
<li class="chapter" data-level="8.1.4" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#datasets-setting-up-the-work-directory-5"><i class="fa fa-check"></i><b>8.1.4</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="8.1.5" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#loading-and-installing-packages-5"><i class="fa fa-check"></i><b>8.1.5</b> Loading and installing packages</a></li>
<li class="chapter" data-level="8.1.6" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#loading-datasets-3"><i class="fa fa-check"></i><b>8.1.6</b> Loading datasets</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#diagnostics-of-residuals"><i class="fa fa-check"></i><b>8.2</b> Diagnostics of residuals</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#reporting-basic-summary-statistical-measures"><i class="fa fa-check"></i><b>8.2.1</b> Reporting basic summary statistical measures</a></li>
<li class="chapter" data-level="8.2.2" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#reporting-the-spatial-distribution-of-our-variables"><i class="fa fa-check"></i><b>8.2.2</b> Reporting the spatial distribution of our variables</a></li>
<li class="chapter" data-level="8.2.3" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#fitting-a-non-spatial-linear-regression-on-spatial-data-checking-the-residuals"><i class="fa fa-check"></i><b>8.2.3</b> Fitting a non-spatial Linear Regression on spatial data &amp; checking the residuals</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#spatial-regression-models"><i class="fa fa-check"></i><b>8.3</b> Spatial Regression Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#model-formation-for-spatial-lag-or-error-models"><i class="fa fa-check"></i><b>8.3.1</b> Model formation for spatial lag or error models</a></li>
<li class="chapter" data-level="8.3.2" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#spatial-lag-model-lagged-on-the-dependent-variable"><i class="fa fa-check"></i><b>8.3.2</b> Spatial Lag Model lagged on the dependent variable</a></li>
<li class="chapter" data-level="8.3.3" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#spatial-error-models"><i class="fa fa-check"></i><b>8.3.3</b> Spatial Error Models</a></li>
<li class="chapter" data-level="8.3.4" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#using-a-spatially-lagged-model-based-on-independent-variables"><i class="fa fa-check"></i><b>8.3.4</b> Using a Spatially lagged model based on independent variables</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#references-see-reading-list-4"><i class="fa fa-check"></i><b>8.4</b> References (see reading list)</a></li>
<li class="chapter" data-level="8.5" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#data-sources-5"><i class="fa fa-check"></i><b>8.5</b> Data Sources</a></li>
<li class="chapter" data-level="8.6" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#useful-videos"><i class="fa fa-check"></i><b>8.6</b> Useful videos</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html"><i class="fa fa-check"></i><b>9</b> Spatial Models: Part 2</a>
<ul>
<li class="chapter" data-level="9.1" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#computer-practical-video-length-015753"><i class="fa fa-check"></i><b>9.1</b> Computer practical video (Length: 01:57:53)</a></li>
<li class="chapter" data-level="9.2" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#introduction-7"><i class="fa fa-check"></i><b>9.2</b> Introduction</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#learning-outcomes-5"><i class="fa fa-check"></i><b>9.2.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="9.2.2" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#datasets-setting-up-the-work-directory-6"><i class="fa fa-check"></i><b>9.2.2</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="9.2.3" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#installing-packages"><i class="fa fa-check"></i><b>9.2.3</b> Installing packages</a></li>
<li class="chapter" data-level="9.2.4" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#loading-datasets-4"><i class="fa fa-check"></i><b>9.2.4</b> Loading datasets</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#implementing-the-linear-regression-model"><i class="fa fa-check"></i><b>9.3</b> Implementing the Linear Regression model</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#obtaining-the-residuals-from-a-non-spatial-model"><i class="fa fa-check"></i><b>9.3.1</b> Obtaining the residuals from a non-spatial model</a></li>
<li class="chapter" data-level="9.3.2" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#use-residuals-and-test-for-spatial-autocorrelation"><i class="fa fa-check"></i><b>9.3.2</b> Use residuals and test for spatial autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#geographically-weighted-regression-gwr"><i class="fa fa-check"></i><b>9.4</b> Geographically Weighted Regression (GWR)</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#preparing-the-data-for-gwr-analysis"><i class="fa fa-check"></i><b>9.4.1</b> Preparing the data for GWR analysis</a></li>
<li class="chapter" data-level="9.4.2" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#fitting-a-gwr-using-gwr.sel-and-gwr"><i class="fa fa-check"></i><b>9.4.2</b> Fitting a GWR using <code>gwr.sel()</code> and <code>gwr()</code></a></li>
<li class="chapter" data-level="9.4.3" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#model-results"><i class="fa fa-check"></i><b>9.4.3</b> Model results</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#tasks"><i class="fa fa-check"></i><b>9.5</b> Tasks</a></li>
<li class="chapter" data-level="9.6" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#attributions-2"><i class="fa fa-check"></i><b>9.6</b> Attributions</a></li>
<li class="chapter" data-level="9.7" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#references-see-reading-list-5"><i class="fa fa-check"></i><b>9.7</b> References (see reading list)</a></li>
<li class="chapter" data-level="9.8" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#data-sources-6"><i class="fa fa-check"></i><b>9.8</b> Data Sources</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GEOG0114: Principles of Spatial Analysis (2023/24)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spatial-models-part-2" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">9</span> Spatial Models: Part 2<a href="spatial-models-part-2.html#spatial-models-part-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="computer-practical-video-length-015753" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Computer practical video (Length: 01:57:53)<a href="spatial-models-part-2.html#computer-practical-video-length-015753" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/T-SgrbzisgM" width="711" height="400" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p><a href="https://youtu.be/T-SgrbzisgM">[<strong>Watch on YouTube</strong>]</a></p>
</div>
<div id="introduction-7" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Introduction<a href="spatial-models-part-2.html#introduction-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The goal for this week’s session is to introduce you to a type of spatial model known as the <strong>Geographically Weighted Regression (GWR)</strong>. GWR is a statistical model which can indicate where non-stationarity may take place across space; it can be used to identify how <strong>locally</strong> weighted regression coefficients may vary across the study area (unlike its counterpart i.e., the <strong>Spatial Lagged and/or Error Models</strong> which provides <strong>global coefficients</strong>). Similar to last week’s sessions, we will first need to explore the residuals from a linear regression model to identify evidence of <strong>spatial autocorrelation</strong> before implementing a spatial model. But, this time round, we will run a GWR and observe how the coefficients for a set of independent variables vary across space.</p>
<div id="learning-outcomes-5" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Learning outcomes<a href="spatial-models-part-2.html#learning-outcomes-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this tutorial we will be using last week’s on the house price dataset in London, alongside the social-risk factor variables such as public transport accessibility (PTA), average income and socioeconomic deprivation (IMD) to see how their association with house prices vary across space. This will be achieved using the GWR model.</p>
</div>
<div id="datasets-setting-up-the-work-directory-6" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Datasets &amp; setting up the work directory<a href="spatial-models-part-2.html#datasets-setting-up-the-work-directory-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will be using the data from last week. You should have already downloaded all this data for last week’s practical lesson - if you have not done so already you can access them by <a href="https://github.com/UCLPG-MSC-SGDS/GEOG0114/raw/main/Week%209%20-%20Dataset.zip"><strong>clicking here</strong></a>.</p>
</div>
<div id="installing-packages" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Installing packages<a href="spatial-models-part-2.html#installing-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will need to load the following packages:</p>
<ul>
<li><code>sf</code>: Simple Features</li>
<li><code>tmap</code>: Thematic Mapping</li>
<li><code>spdep</code>: Spatial Dependence (Weighting schemes &amp; Spatial Statistics)</li>
<li><code>sp</code>: Package for providing classes for spatial data (points, lines, polygons and grids)</li>
</ul>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="spatial-models-part-2.html#cb207-1" tabindex="-1"></a><span class="co"># Load packages using library() function</span></span>
<span id="cb207-2"><a href="spatial-models-part-2.html#cb207-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;sf&quot;</span>)</span>
<span id="cb207-3"><a href="spatial-models-part-2.html#cb207-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tmap&quot;</span>)</span>
<span id="cb207-4"><a href="spatial-models-part-2.html#cb207-4" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;spdep&quot;</span>)</span>
<span id="cb207-5"><a href="spatial-models-part-2.html#cb207-5" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;sp&quot;</span>)</span></code></pre></div>
<p>There is a new package we will need to install:</p>
<ul>
<li><code>spgwr</code>: this library enable functions for computing geographically weighted regression models in RStudio. This is based on the work by Chris Brunsdon, Martin Charlton and Stewart Fotheringham. The <code>spgwr</code> package will need the following packages installed in the background for it to work: <code>terra</code> and <code>spDataLarge</code></li>
<li><code>car</code>: this library enable functions for assessing multicollinearity among independent variables within a regression. A common test is the variance inflation factor (VIF) using the function <code>vif()</code> with threshold of 10.</li>
</ul>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="spatial-models-part-2.html#cb208-1" tabindex="-1"></a><span class="co"># install the packages using the install.package()</span></span>
<span id="cb208-2"><a href="spatial-models-part-2.html#cb208-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;spgwr&quot;</span>)</span>
<span id="cb208-3"><a href="spatial-models-part-2.html#cb208-3" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;terra&quot;</span>)</span>
<span id="cb208-4"><a href="spatial-models-part-2.html#cb208-4" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;spDataLarge&quot;</span>, <span class="at">repos=</span><span class="st">&quot;https://nowosad.github.io/drat/&quot;</span>, <span class="at">type=</span><span class="st">&quot;source&quot;</span>)</span>
<span id="cb208-5"><a href="spatial-models-part-2.html#cb208-5" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;car&quot;</span>)</span>
<span id="cb208-6"><a href="spatial-models-part-2.html#cb208-6" tabindex="-1"></a></span>
<span id="cb208-7"><a href="spatial-models-part-2.html#cb208-7" tabindex="-1"></a><span class="co"># load the packages with library()</span></span>
<span id="cb208-8"><a href="spatial-models-part-2.html#cb208-8" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;spgwr&quot;</span>)</span>
<span id="cb208-9"><a href="spatial-models-part-2.html#cb208-9" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;car&quot;</span>)</span></code></pre></div>
<p>You will see the following message after using the <code>library()</code> function <code>spgwr</code> package:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="spatial-models-part-2.html#cb209-1" tabindex="-1"></a>NOTE<span class="sc">:</span> This package does not constitute approval of GWR</span>
<span id="cb209-2"><a href="spatial-models-part-2.html#cb209-2" tabindex="-1"></a>as a method of spatial analysis; see <span class="fu">example</span>(gwr)</span></code></pre></div>
<p>You can ignore this message.</p>
</div>
<div id="loading-datasets-4" class="section level3 hasAnchor" number="9.2.4">
<h3><span class="header-section-number">9.2.4</span> Loading datasets<a href="spatial-models-part-2.html#loading-datasets-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Remember, in last week’s practical, we used the <code>London LSOA 2015 data.csv</code> in RStudio to implement a spatial lag and error model. It contained the following the description for each column as follows:</p>
<table>
<colgroup>
<col width="48%" />
<col width="52%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Column Name</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>LSOACODE</code></td>
<td>Unique identification code for the geographic area</td>
</tr>
<tr class="even">
<td><code>AVEPRICE</code> (Dependent variable)</td>
<td>Average house price estimated for the LSOA in 2015</td>
</tr>
<tr class="odd">
<td><code>AVEINCOME</code></td>
<td>Estimated average annual income for households within an LSOA in 2015</td>
</tr>
<tr class="even">
<td><code>IMDSCORE</code></td>
<td>Deprivation score for an LSOA in 2015</td>
</tr>
<tr class="odd">
<td><code>PTAINDEX</code></td>
<td>Measures levels of access/connectivity to public transport</td>
</tr>
<tr class="even">
<td><code>PTACAT</code></td>
<td><code>PTAINDEX</code> rendered into a categorical variable</td>
</tr>
</tbody>
</table>
<p>You were also provided two sets of spatial data, one that is LSOA-level required for the statistical analysis and the other for Boroughs which is for customising your map. The shapefile names are as follows:</p>
<ul>
<li>London LSOA shape file: <code>London LSOA Areas.shp</code></li>
<li>London Borough shape file: <code>London Borough Areas.shp</code></li>
</ul>
<p>Use the following functions <code>read.csv()</code> and <code>read_sf()</code> to import the above datasets into RStudio’s memory. The codes are essentially the same as last week’s practical:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="spatial-models-part-2.html#cb210-1" tabindex="-1"></a><span class="co"># add house price and covariate data </span></span>
<span id="cb210-2"><a href="spatial-models-part-2.html#cb210-2" tabindex="-1"></a>data.london <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;London LSOA 2015 data.csv&quot;</span>)</span>
<span id="cb210-3"><a href="spatial-models-part-2.html#cb210-3" tabindex="-1"></a></span>
<span id="cb210-4"><a href="spatial-models-part-2.html#cb210-4" tabindex="-1"></a><span class="co"># import shapefile data</span></span>
<span id="cb210-5"><a href="spatial-models-part-2.html#cb210-5" tabindex="-1"></a>lsoa.shp <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">&quot;London LSOA Areas.shp&quot;</span>)</span>
<span id="cb210-6"><a href="spatial-models-part-2.html#cb210-6" tabindex="-1"></a>borough.shp <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">&quot;London Borough Areas.shp&quot;</span>)</span></code></pre></div>
<p>The code chunk below generates an empty map with the <code>tmap</code> functions. It inspects the spatial configuration of London’s LSOA with the Boroughs superimposed.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="spatial-models-part-2.html#cb211-1" tabindex="-1"></a><span class="fu">tm_shape</span>(LSOAshp) <span class="sc">+</span> <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb211-2"><a href="spatial-models-part-2.html#cb211-2" tabindex="-1"></a><span class="fu">tm_shape</span>(BOROUGHshp) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">border.alpha =</span> <span class="dv">1</span>, <span class="at">border.col =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb211-3"><a href="spatial-models-part-2.html#cb211-3" tabindex="-1"></a><span class="fu">tm_compass</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>)) <span class="sc">+</span> <span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>))</span></code></pre></div>
<p>Output from the above <code>tmap()</code> functions:</p>
<p><img src="images/general/week10/Tab1-image1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Use the <code>merge()</code> function to bring together the LSOA shapefile and house price dataset create a spatial data frame object.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="spatial-models-part-2.html#cb212-1" tabindex="-1"></a><span class="co"># Merge the two files using the &quot;LSOACODE&quot; column</span></span>
<span id="cb212-2"><a href="spatial-models-part-2.html#cb212-2" tabindex="-1"></a>spatialdatafile <span class="ot">&lt;-</span> <span class="fu">merge</span>(lsoa.shp, data.london, <span class="at">by.x =</span> <span class="st">&quot;LSOACODE&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;LSOACODE&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="implementing-the-linear-regression-model" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Implementing the Linear Regression model<a href="spatial-models-part-2.html#implementing-the-linear-regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="obtaining-the-residuals-from-a-non-spatial-model" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Obtaining the residuals from a non-spatial model<a href="spatial-models-part-2.html#obtaining-the-residuals-from-a-non-spatial-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The GWR is a spatial regression model akin to the lag and error models taught last week. Similarly, in order to implement a GWR, we need to first test the residuals for evidence of spatial autocorrelation. To do this, we must first run a linear regression model get the residuals.</p>
<p>Recall from last week, we can do this for the log-transformed <code>house price</code> against the independent variables (i.e., income, deprivation and accessibility) using the <code>lm()</code> function:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="spatial-models-part-2.html#cb213-1" tabindex="-1"></a><span class="co"># lm() function builds a regression model and stores model output into the object &#39;modelMLR&#39;</span></span>
<span id="cb213-2"><a href="spatial-models-part-2.html#cb213-2" tabindex="-1"></a>modelMLR <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log10</span>(AVEPRICE) <span class="sc">~</span> <span class="fu">log10</span>(AVEINCOME) <span class="sc">+</span> <span class="fu">log10</span>(IMDSCORE) <span class="sc">+</span> <span class="fu">log10</span>(PTAINDEX), <span class="at">data =</span> spatialdatafile)</span>
<span id="cb213-3"><a href="spatial-models-part-2.html#cb213-3" tabindex="-1"></a><span class="co"># Include the &#39;scipen=7&#39; argument in the summary() function remove those annoying scientific notation!</span></span>
<span id="cb213-4"><a href="spatial-models-part-2.html#cb213-4" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">7</span>)</span>
<span id="cb213-5"><a href="spatial-models-part-2.html#cb213-5" tabindex="-1"></a><span class="co"># summary() calls report the output stored in object &#39;modelMLR&#39;</span></span>
<span id="cb213-6"><a href="spatial-models-part-2.html#cb213-6" tabindex="-1"></a><span class="fu">summary</span>(modelMLR)</span></code></pre></div>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="spatial-models-part-2.html#cb214-1" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb214-2"><a href="spatial-models-part-2.html#cb214-2" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> <span class="fu">log10</span>(AVEPRICE) <span class="sc">~</span> <span class="fu">log10</span>(IMDSCORE) <span class="sc">+</span> <span class="fu">log10</span>(AVEINCOME) <span class="sc">+</span> </span>
<span id="cb214-3"><a href="spatial-models-part-2.html#cb214-3" tabindex="-1"></a>    <span class="fu">log10</span>(PTAINDEX), <span class="at">data =</span> spatialdatafile)</span>
<span id="cb214-4"><a href="spatial-models-part-2.html#cb214-4" tabindex="-1"></a></span>
<span id="cb214-5"><a href="spatial-models-part-2.html#cb214-5" tabindex="-1"></a>Residuals<span class="sc">:</span></span>
<span id="cb214-6"><a href="spatial-models-part-2.html#cb214-6" tabindex="-1"></a>     Min       1Q   Median       3Q      Max </span>
<span id="cb214-7"><a href="spatial-models-part-2.html#cb214-7" tabindex="-1"></a><span class="sc">-</span><span class="fl">0.39249</span> <span class="sc">-</span><span class="fl">0.06489</span> <span class="sc">-</span><span class="fl">0.00572</span>  <span class="fl">0.06046</span>  <span class="fl">0.62993</span> </span>
<span id="cb214-8"><a href="spatial-models-part-2.html#cb214-8" tabindex="-1"></a></span>
<span id="cb214-9"><a href="spatial-models-part-2.html#cb214-9" tabindex="-1"></a>Coefficients<span class="sc">:</span></span>
<span id="cb214-10"><a href="spatial-models-part-2.html#cb214-10" tabindex="-1"></a>                  Estimate Std. Error t value       <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>t<span class="sc">|</span>)    </span>
<span id="cb214-11"><a href="spatial-models-part-2.html#cb214-11" tabindex="-1"></a>(Intercept)      <span class="sc">-</span><span class="fl">4.100992</span>   <span class="fl">0.095592</span> <span class="sc">-</span><span class="fl">42.901</span>        <span class="sc">&lt;</span> <span class="fl">2e-16</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb214-12"><a href="spatial-models-part-2.html#cb214-12" tabindex="-1"></a><span class="fu">log10</span>(IMDSCORE)   <span class="fl">0.136713</span>   <span class="fl">0.007681</span>  <span class="fl">17.798</span>        <span class="sc">&lt;</span> <span class="fl">2e-16</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb214-13"><a href="spatial-models-part-2.html#cb214-13" tabindex="-1"></a><span class="fu">log10</span>(AVEINCOME)  <span class="fl">2.036354</span>   <span class="fl">0.019340</span> <span class="fl">105.292</span>        <span class="sc">&lt;</span> <span class="fl">2e-16</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb214-14"><a href="spatial-models-part-2.html#cb214-14" tabindex="-1"></a><span class="fu">log10</span>(PTAINDEX)   <span class="fl">0.030055</span>   <span class="fl">0.004816</span>   <span class="fl">6.241</span> <span class="fl">0.000000000471</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb214-15"><a href="spatial-models-part-2.html#cb214-15" tabindex="-1"></a><span class="sc">---</span></span>
<span id="cb214-16"><a href="spatial-models-part-2.html#cb214-16" tabindex="-1"></a>Signif. codes<span class="sc">:</span>  <span class="dv">0</span> ‘<span class="sc">**</span><span class="er">*</span>’ <span class="fl">0.001</span> ‘<span class="sc">**</span>’ <span class="fl">0.01</span> ‘<span class="sc">*</span>’ <span class="fl">0.05</span> ‘.’ <span class="fl">0.1</span> ‘ ’ <span class="dv">1</span></span>
<span id="cb214-17"><a href="spatial-models-part-2.html#cb214-17" tabindex="-1"></a></span>
<span id="cb214-18"><a href="spatial-models-part-2.html#cb214-18" tabindex="-1"></a>Residual standard error<span class="sc">:</span> <span class="fl">0.1027</span> on <span class="dv">4964</span> degrees of freedom</span>
<span id="cb214-19"><a href="spatial-models-part-2.html#cb214-19" tabindex="-1"></a>Multiple R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.789</span>, Adjusted R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.7889</span> </span>
<span id="cb214-20"><a href="spatial-models-part-2.html#cb214-20" tabindex="-1"></a>F<span class="sc">-</span>statistic<span class="sc">:</span>  <span class="dv">6189</span> on <span class="dv">3</span> and <span class="dv">4964</span> DF,  p<span class="sc">-</span>value<span class="sc">:</span> <span class="er">&lt;</span> <span class="fl">2.2e-16</span></span></code></pre></div>
<p>For interpretation of the above global coefficients (see last week’s practical in <a href="https://uclpg-msc-sgds.github.io/GEOG0114/spatial-models-part-1.html#fitting-a-non-spatial-linear-regression-on-spatial-data-checking-the-residuals"><strong>section 7.3.3</strong></a>)</p>
<p>You can check if presence of <strong>multicollinearity</strong> among the independent variable by using the <code>vif()</code> to ensure the independent variables are not co-linear with each other by ensuring their <strong>Variance Inflation Factor (VIF)</strong> is less than 10. If it exceeds 10, then those variables will have to be discarded from the model, and such regression will need to be re-run again without those discarded variables.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="spatial-models-part-2.html#cb215-1" tabindex="-1"></a><span class="fu">vif</span>(modelMLR)</span></code></pre></div>
<p>Output from <code>vif()</code> function:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="spatial-models-part-2.html#cb216-1" tabindex="-1"></a><span class="fu">log10</span>(AVEINCOME)  <span class="fu">log10</span>(IMDSCORE)  <span class="fu">log10</span>(PTAINDEX) </span>
<span id="cb216-2"><a href="spatial-models-part-2.html#cb216-2" tabindex="-1"></a>        <span class="fl">1.963519</span>         <span class="fl">2.066221</span>         <span class="fl">1.403051</span> </span></code></pre></div>
<p>All variables are not co-linear with each other since the VIFs are all less than 10. No need to discard any of the variables.</p>
<p>Now, extract the residuals and deposit them into our spatial data frame <code>spatialdatafile</code></p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="spatial-models-part-2.html#cb217-1" tabindex="-1"></a><span class="co"># Extract residuals from &quot;modelLMR&quot; object and dump into &quot;spatialdatafile&quot; and call the column &quot;RESIDUALS&quot;</span></span>
<span id="cb217-2"><a href="spatial-models-part-2.html#cb217-2" tabindex="-1"></a>spatialdatafile<span class="sc">$</span>RESIDUALS <span class="ot">&lt;-</span> modelMLR<span class="sc">$</span>residuals</span></code></pre></div>
<p>Output shows mapped residuals:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="spatial-models-part-2.html#cb218-1" tabindex="-1"></a><span class="fu">tm_shape</span>(spatialdatafile) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">&quot;RESIDUALS&quot;</span>, <span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">palette =</span> <span class="st">&quot;-RdBu&quot;</span>) <span class="sc">+</span></span>
<span id="cb218-2"><a href="spatial-models-part-2.html#cb218-2" tabindex="-1"></a><span class="fu">tm_shape</span>(BOROUGHshp) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">border.alpha =</span> <span class="dv">1</span>, <span class="at">border.col =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb218-3"><a href="spatial-models-part-2.html#cb218-3" tabindex="-1"></a><span class="fu">tm_text</span>(<span class="st">&quot;BOROUGHN&quot;</span>, <span class="at">size =</span> <span class="st">&quot;AREA&quot;</span>) <span class="sc">+</span></span>
<span id="cb218-4"><a href="spatial-models-part-2.html#cb218-4" tabindex="-1"></a><span class="fu">tm_compass</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>)) <span class="sc">+</span></span>
<span id="cb218-5"><a href="spatial-models-part-2.html#cb218-5" tabindex="-1"></a><span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb218-6"><a href="spatial-models-part-2.html#cb218-6" tabindex="-1"></a><span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">legend.title.size =</span> <span class="fl">0.5</span>, <span class="at">legend.text.size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="images/general/week10/Tab2-image3.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Notice the spatial patterning and clusters of the LSOA areas where there’s an over-prediction of the house prices (i.e., areas that have negative residuals, or blue tones) and under-prediction (i.e., areas that positive residuals, or red tones). This visual inspection of the residuals is an indication that spatial autocorrelation may be present. We can confirm by using an Moran’s I test.</p>
</div>
<div id="use-residuals-and-test-for-spatial-autocorrelation" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Use residuals and test for spatial autocorrelation<a href="spatial-models-part-2.html#use-residuals-and-test-for-spatial-autocorrelation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Create an adjacency spatial weight matrix apply Moran’s I test using the <code>lm.morantest()</code>:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="spatial-models-part-2.html#cb219-1" tabindex="-1"></a><span class="co">#generate unique number for each row</span></span>
<span id="cb219-2"><a href="spatial-models-part-2.html#cb219-2" tabindex="-1"></a>spatialdatafile<span class="sc">$</span>ROWNUM <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(spatialdatafile)</span>
<span id="cb219-3"><a href="spatial-models-part-2.html#cb219-3" tabindex="-1"></a><span class="co"># We need to coerce the sf spatialdatafile object into a new sp object</span></span>
<span id="cb219-4"><a href="spatial-models-part-2.html#cb219-4" tabindex="-1"></a>spatialdatafile_2<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">as</span>(spatialdatafile, <span class="st">&quot;Spatial&quot;</span>)</span>
<span id="cb219-5"><a href="spatial-models-part-2.html#cb219-5" tabindex="-1"></a><span class="co"># Create spatial weights matrix for areas</span></span>
<span id="cb219-6"><a href="spatial-models-part-2.html#cb219-6" tabindex="-1"></a>Weights <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(spatialdatafile_2<span class="fl">.0</span>, <span class="at">row.names =</span> spatialdatafile_2<span class="fl">.0</span><span class="sc">$</span>ROWNUM)</span>
<span id="cb219-7"><a href="spatial-models-part-2.html#cb219-7" tabindex="-1"></a>WeightsMatrix <span class="ot">&lt;-</span> <span class="fu">nb2mat</span>(Weights, <span class="at">style=</span><span class="st">&#39;B&#39;</span>)</span>
<span id="cb219-8"><a href="spatial-models-part-2.html#cb219-8" tabindex="-1"></a>Residual_WeightMatrix <span class="ot">&lt;-</span> <span class="fu">mat2listw</span>(WeightsMatrix , <span class="at">style=</span><span class="st">&#39;W&#39;</span>)</span>
<span id="cb219-9"><a href="spatial-models-part-2.html#cb219-9" tabindex="-1"></a><span class="co"># Run the test on the regression model output object &quot;modelMLR&quot; using lm.morantest()</span></span>
<span id="cb219-10"><a href="spatial-models-part-2.html#cb219-10" tabindex="-1"></a><span class="fu">lm.morantest</span>(modelMLR, Residual_WeightMatrix, <span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<p>Output from <code>lm.morantest()</code>:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="spatial-models-part-2.html#cb220-1" tabindex="-1"></a>Global Moran I <span class="cf">for</span> regression residuals</span>
<span id="cb220-2"><a href="spatial-models-part-2.html#cb220-2" tabindex="-1"></a></span>
<span id="cb220-3"><a href="spatial-models-part-2.html#cb220-3" tabindex="-1"></a>data<span class="sc">:</span>  </span>
<span id="cb220-4"><a href="spatial-models-part-2.html#cb220-4" tabindex="-1"></a>model<span class="sc">:</span> <span class="fu">lm</span>(<span class="at">formula =</span> <span class="fu">log10</span>(AVEPRICE) <span class="sc">~</span> <span class="fu">log10</span>(AVEINCOME) <span class="sc">+</span> <span class="fu">log10</span>(IMDSCORE) <span class="sc">+</span> <span class="fu">log10</span>(PTAINDEX),</span>
<span id="cb220-5"><a href="spatial-models-part-2.html#cb220-5" tabindex="-1"></a><span class="at">data =</span> spatialdatafile)</span>
<span id="cb220-6"><a href="spatial-models-part-2.html#cb220-6" tabindex="-1"></a>weights<span class="sc">:</span> Residual_WeightMatrix</span>
<span id="cb220-7"><a href="spatial-models-part-2.html#cb220-7" tabindex="-1"></a></span>
<span id="cb220-8"><a href="spatial-models-part-2.html#cb220-8" tabindex="-1"></a>Moran I statistic standard deviate <span class="ot">=</span> <span class="fl">56.28</span>, p<span class="sc">-</span>value <span class="sc">&lt;</span> <span class="fl">2.2e-16</span></span>
<span id="cb220-9"><a href="spatial-models-part-2.html#cb220-9" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> two.sided</span>
<span id="cb220-10"><a href="spatial-models-part-2.html#cb220-10" tabindex="-1"></a>sample estimates<span class="sc">:</span></span>
<span id="cb220-11"><a href="spatial-models-part-2.html#cb220-11" tabindex="-1"></a>Observed Moran I      Expectation         Variance </span>
<span id="cb220-12"><a href="spatial-models-part-2.html#cb220-12" tabindex="-1"></a>   <span class="fl">0.47489527088</span>   <span class="sc">-</span><span class="fl">0.00060260241</span>    <span class="fl">0.00007138138</span> </span></code></pre></div>
<p>The Moran’s I value is <code>0.475</code>, which is a statistically significant value (i.e., p-value <code>&lt;0.001</code>). This indicates strong evidence of spatial autocorrelation. Now, let’s see how we can use a different spatial model such as a GWR to derive <strong>local</strong> associations for each area.</p>
</div>
</div>
<div id="geographically-weighted-regression-gwr" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Geographically Weighted Regression (GWR)<a href="spatial-models-part-2.html#geographically-weighted-regression-gwr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>GWR overcomes the limitation of the the <strong>standard linear</strong>, and <strong>spatial lag and error regression models</strong> of generating a global set of estimates. The basic idea behind GWR is to examine the way in which the relationships between a dependent variable and a set of predictors might vary over space. As explained in the lecture, the GWR operates by moving a search window from one regression point to the next, working sequentially through all the existing regression points in the dataset. A set of regions is then defined around each regression point and within the search window. A regression model is then fitted to all data contained in each of the identified regions around a regression point, with data points closer to the sample point being weighted more heavily than are those farther away. This process is repeated for all samples points in the dataset. For a data set of 4968 observations GWR will fit 4968 weighted regression models. The resulting local estimates can then be mapped at the locations of the regression points to view possible variations in the relationships between variables.</p>
<div id="preparing-the-data-for-gwr-analysis" class="section level3 hasAnchor" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> Preparing the data for GWR analysis<a href="spatial-models-part-2.html#preparing-the-data-for-gwr-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The analysis requires points since the weights are distance-based and thus, to appropriately implement a GWR model on LSOA area data, we will need to calculate the centroids from the LSOAs and then deposit them as coordinates within the spatial data frame.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="spatial-models-part-2.html#cb221-1" tabindex="-1"></a><span class="co"># calculate the centroids from geometries</span></span>
<span id="cb221-2"><a href="spatial-models-part-2.html#cb221-2" tabindex="-1"></a>spatialdatafile <span class="ot">&lt;-</span> <span class="fu">st_centroid</span>(spatialdatafile)</span>
<span id="cb221-3"><a href="spatial-models-part-2.html#cb221-3" tabindex="-1"></a><span class="co"># insert coordinates into spatialdatafile note longitude column is X and latitude column is Y</span></span>
<span id="cb221-4"><a href="spatial-models-part-2.html#cb221-4" tabindex="-1"></a>spatialdatafile <span class="ot">&lt;-</span> <span class="fu">cbind</span>(spatialdatafile, <span class="fu">st_coordinates</span>(spatialdatafile))</span></code></pre></div>
</div>
<div id="fitting-a-gwr-using-gwr.sel-and-gwr" class="section level3 hasAnchor" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> Fitting a GWR using <code>gwr.sel()</code> and <code>gwr()</code><a href="spatial-models-part-2.html#fitting-a-gwr-using-gwr.sel-and-gwr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let demonstrate with an example using the <strong>Adaptive Bandwidth</strong>, which is the preferred approach since the algorithm will compute and specify the adaptive kernel that involves using varying bandwidth to define a region around regression points - instead of using some <strong>Fixed Bandwidth</strong>.</p>
<p>Let’s find the optimal bandwidth using the <strong>Adaptive Bandwidth</strong> approach using <code>gwr.sel()</code> function:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="spatial-models-part-2.html#cb222-1" tabindex="-1"></a><span class="co"># finding the bandwidth </span></span>
<span id="cb222-2"><a href="spatial-models-part-2.html#cb222-2" tabindex="-1"></a>BwG <span class="ot">&lt;-</span> <span class="fu">gwr.sel</span>(<span class="fu">log10</span>(AVEPRICE) <span class="sc">~</span> <span class="fu">log10</span>(AVEINCOME) <span class="sc">+</span> <span class="fu">log10</span>(IMDSCORE) <span class="sc">+</span> <span class="fu">log10</span>(PTAINDEX), <span class="at">data =</span> spatialdatafile, <span class="at">coords =</span> <span class="fu">cbind</span>(spatialdatafile<span class="sc">$</span>X, spatialdatafile<span class="sc">$</span>Y), <span class="at">adapt =</span> <span class="cn">TRUE</span>)</span>
<span id="cb222-3"><a href="spatial-models-part-2.html#cb222-3" tabindex="-1"></a></span>
<span id="cb222-4"><a href="spatial-models-part-2.html#cb222-4" tabindex="-1"></a><span class="co"># see optimal bandwidth</span></span>
<span id="cb222-5"><a href="spatial-models-part-2.html#cb222-5" tabindex="-1"></a>BwG</span></code></pre></div>
<p>The optimal bandwidth is <code>0.001270292</code> indicating the proportion of observations (or k-nearest neighbours) to be included in the weighting scheme. In this example, the optimal bandwidth indicates that for a given LSOA, <code>0.127%</code> of its nearest neighbours should be used to calibrate the relevant local regression; that is about 6 LSOAs. The search window will thus be variable in size depending on the extent of LSOAs.</p>
<div class="note">
<p><strong>Important note</strong>: Here the optimal bandwidth is defined based on a data point’s k-nearest neighbours. It can also be defined by geographical distance as done above for the fixed spatial kernel.</p>
</div>
<p>We next fit a GWR based on an adaptive bandwidth using the <code>gwr()</code> function:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="spatial-models-part-2.html#cb223-1" tabindex="-1"></a><span class="co"># start timer to time how long it takes to run a gwr() on computer</span></span>
<span id="cb223-2"><a href="spatial-models-part-2.html#cb223-2" tabindex="-1"></a>start.timer <span class="ot">&lt;-</span> <span class="fu">proc.time</span>()</span>
<span id="cb223-3"><a href="spatial-models-part-2.html#cb223-3" tabindex="-1"></a></span>
<span id="cb223-4"><a href="spatial-models-part-2.html#cb223-4" tabindex="-1"></a><span class="co"># gwr() model. You need hatmatrix and se.fit specified as TRUE for testing statistical significance </span></span>
<span id="cb223-5"><a href="spatial-models-part-2.html#cb223-5" tabindex="-1"></a>gwr.model <span class="ot">&lt;-</span> <span class="fu">gwr</span>(<span class="fu">log10</span>(AVEPRICE) <span class="sc">~</span> <span class="fu">log10</span>(AVEINCOME) <span class="sc">+</span> <span class="fu">log10</span>(IMDSCORE) <span class="sc">+</span> <span class="fu">log10</span>(PTAINDEX), <span class="at">data =</span> spatialdatafile, <span class="at">coords =</span> <span class="fu">cbind</span>(spatialdatafile<span class="sc">$</span>X, spatialdatafile<span class="sc">$</span>Y), <span class="at">adapt=</span>BwG, <span class="at">hatmatrix=</span><span class="cn">TRUE</span>, <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb223-6"><a href="spatial-models-part-2.html#cb223-6" tabindex="-1"></a></span>
<span id="cb223-7"><a href="spatial-models-part-2.html#cb223-7" tabindex="-1"></a><span class="co"># end timer and calculate how it took for model to complete churning</span></span>
<span id="cb223-8"><a href="spatial-models-part-2.html#cb223-8" tabindex="-1"></a>end.timer <span class="ot">&lt;-</span> <span class="fu">proc.time</span>() <span class="sc">-</span> start.timer</span>
<span id="cb223-9"><a href="spatial-models-part-2.html#cb223-9" tabindex="-1"></a><span class="co"># report time taken</span></span>
<span id="cb223-10"><a href="spatial-models-part-2.html#cb223-10" tabindex="-1"></a>end.timer</span></code></pre></div>
<p>Output on time taken:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="spatial-models-part-2.html#cb224-1" tabindex="-1"></a>    user   system  elapsed </span>
<span id="cb224-2"><a href="spatial-models-part-2.html#cb224-2" tabindex="-1"></a><span class="fl">1490.684</span>   <span class="fl">96.123</span> <span class="fl">1586.152</span> </span></code></pre></div>
<div class="note">
<p><strong>IMPORTANT NOTE:</strong> Due to the following options specified in the <code>gwr()</code> (i.e., <code>hatmatrix</code> and <code>se.fit</code> as TRUE) it might take sometime for the <code>gwr()</code> to complete the estimation of local <strong>coefficients</strong>, <strong>area-specific R2</strong>, and <strong>standard error</strong>. This take approximately <code>1490.684</code> seconds (<code>24.84</code> minutes) on a desktop with 3 GHz 6-core Intel Core i5 processor with 32 GB of RAM memory. It will be interesting to see how long it takes on a standard UCL desktop or on your personal laptops. Here is the ideal time for you to have a second coffee break while it churns.</p>
</div>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="spatial-models-part-2.html#cb225-1" tabindex="-1"></a><span class="co"># see results, finally!</span></span>
<span id="cb225-2"><a href="spatial-models-part-2.html#cb225-2" tabindex="-1"></a>gwr.model</span></code></pre></div>
<p>Output of <code>gwr.model</code> object:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="spatial-models-part-2.html#cb226-1" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb226-2"><a href="spatial-models-part-2.html#cb226-2" tabindex="-1"></a><span class="fu">gwr</span>(<span class="at">formula =</span> <span class="fu">log10</span>(AVEPRICE) <span class="sc">~</span> <span class="fu">log10</span>(AVEINCOME) <span class="sc">+</span> <span class="fu">log10</span>(IMDSCORE) <span class="sc">+</span> </span>
<span id="cb226-3"><a href="spatial-models-part-2.html#cb226-3" tabindex="-1"></a>    <span class="fu">log10</span>(PTAINDEX), <span class="at">data =</span> spatialdatafile, <span class="at">coords =</span> <span class="fu">cbind</span>(spatialdatafile<span class="sc">$</span>X, </span>
<span id="cb226-4"><a href="spatial-models-part-2.html#cb226-4" tabindex="-1"></a>    spatialdatafile<span class="sc">$</span>Y), <span class="at">adapt =</span> BwG, <span class="at">hatmatrix =</span> <span class="cn">TRUE</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb226-5"><a href="spatial-models-part-2.html#cb226-5" tabindex="-1"></a>Kernel <span class="cf">function</span><span class="sc">:</span> gwr.Gauss </span>
<span id="cb226-6"><a href="spatial-models-part-2.html#cb226-6" tabindex="-1"></a>Adaptive quantile<span class="sc">:</span> <span class="fl">0.001270292</span> (about <span class="dv">6</span> of <span class="dv">4968</span> data points)</span>
<span id="cb226-7"><a href="spatial-models-part-2.html#cb226-7" tabindex="-1"></a>Summary of GWR coefficient estimates at data points<span class="sc">:</span></span>
<span id="cb226-8"><a href="spatial-models-part-2.html#cb226-8" tabindex="-1"></a>                         Min.      1st Qu.       Median      3rd Qu.         Max.  Global</span>
<span id="cb226-9"><a href="spatial-models-part-2.html#cb226-9" tabindex="-1"></a>X.Intercept.     <span class="sc">-</span><span class="fl">15.43999209</span>  <span class="sc">-</span><span class="fl">4.26990561</span>  <span class="sc">-</span><span class="fl">1.88765409</span>   <span class="fl">0.41755910</span>  <span class="fl">17.35599732</span> <span class="sc">-</span><span class="fl">4.1010</span></span>
<span id="cb226-10"><a href="spatial-models-part-2.html#cb226-10" tabindex="-1"></a>log10.AVEINCOME.  <span class="sc">-</span><span class="fl">2.44598947</span>   <span class="fl">1.14890387</span>   <span class="fl">1.61696094</span>   <span class="fl">2.08452831</span>   <span class="fl">4.27148364</span>  <span class="fl">2.0364</span></span>
<span id="cb226-11"><a href="spatial-models-part-2.html#cb226-11" tabindex="-1"></a>log10.IMDSCORE.   <span class="sc">-</span><span class="fl">0.94681986</span>  <span class="sc">-</span><span class="fl">0.10975325</span>  <span class="sc">-</span><span class="fl">0.00013244</span>   <span class="fl">0.12469522</span>   <span class="fl">1.08510758</span>  <span class="fl">0.1367</span></span>
<span id="cb226-12"><a href="spatial-models-part-2.html#cb226-12" tabindex="-1"></a>log10.PTAINDEX.   <span class="sc">-</span><span class="fl">0.58629189</span>  <span class="sc">-</span><span class="fl">0.07460266</span>  <span class="sc">-</span><span class="fl">0.02198655</span>   <span class="fl">0.02452116</span>   <span class="fl">0.33555611</span>  <span class="fl">0.0301</span></span>
<span id="cb226-13"><a href="spatial-models-part-2.html#cb226-13" tabindex="-1"></a>Number of data points<span class="sc">:</span> <span class="dv">4968</span> </span>
<span id="cb226-14"><a href="spatial-models-part-2.html#cb226-14" tabindex="-1"></a>Effective number of <span class="fu">parameters</span> (residual<span class="sc">:</span> 2traceS <span class="sc">-</span> traceS<span class="st">&#39;S): 1549.125 </span></span>
<span id="cb226-15"><a href="spatial-models-part-2.html#cb226-15" tabindex="-1"></a><span class="st">Effective degrees of freedom (residual: 2traceS - traceS&#39;</span>S)<span class="sc">:</span> <span class="fl">3418.875</span> </span>
<span id="cb226-16"><a href="spatial-models-part-2.html#cb226-16" tabindex="-1"></a><span class="fu">Sigma</span> (residual<span class="sc">:</span> 2traceS <span class="sc">-</span> traceS<span class="st">&#39;S): 0.07033289 </span></span>
<span id="cb226-17"><a href="spatial-models-part-2.html#cb226-17" tabindex="-1"></a><span class="st">Effective number of parameters (model: traceS): 1118.3 </span></span>
<span id="cb226-18"><a href="spatial-models-part-2.html#cb226-18" tabindex="-1"></a><span class="st">Effective degrees of freedom (model: traceS): 3849.7 </span></span>
<span id="cb226-19"><a href="spatial-models-part-2.html#cb226-19" tabindex="-1"></a><span class="st">Sigma (model: traceS): 0.06628063 </span></span>
<span id="cb226-20"><a href="spatial-models-part-2.html#cb226-20" tabindex="-1"></a><span class="st">Sigma (ML): 0.05834576 </span></span>
<span id="cb226-21"><a href="spatial-models-part-2.html#cb226-21" tabindex="-1"></a><span class="st">AICc (GWR p. 61, eq 2.33; p. 96, eq. 4.21): -11242.87 </span></span>
<span id="cb226-22"><a href="spatial-models-part-2.html#cb226-22" tabindex="-1"></a><span class="st">AIC (GWR p. 96, eq. 4.22): -13014.96 </span></span>
<span id="cb226-23"><a href="spatial-models-part-2.html#cb226-23" tabindex="-1"></a><span class="st">Residual sum of squares: 16.9122 </span></span>
<span id="cb226-24"><a href="spatial-models-part-2.html#cb226-24" tabindex="-1"></a><span class="st">Quasi-global R2: 0.9318326 </span></span></code></pre></div>
<p>Upon first glance, much of the outputs, especially the global coefficients, are identical to the outputs of the linear model. However, if we compare the Global R-square values we can see that GWR performs way better than the linear model (i.e, GWR: <code>0.9318 (93.18%)</code> versus LM: <code>0.7889 (78.89%)</code>). Let’s proceed to now report the various outputs of this model across each polygon.</p>
</div>
<div id="model-results" class="section level3 hasAnchor" number="9.4.3">
<h3><span class="header-section-number">9.4.3</span> Model results<a href="spatial-models-part-2.html#model-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The results are always stored as a <code>SDF</code> object within the <code>gwr.model</code> output we generated from the <code>gwr()</code>. We can extract the <code>SDF</code> object according with the code below:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="spatial-models-part-2.html#cb227-1" tabindex="-1"></a>gwr.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(gwr.model<span class="sc">$</span>SDF)</span>
<span id="cb227-2"><a href="spatial-models-part-2.html#cb227-2" tabindex="-1"></a></span>
<span id="cb227-3"><a href="spatial-models-part-2.html#cb227-3" tabindex="-1"></a><span class="co"># save the output as a csv so you don&#39;t have to run the model again and use in the future!</span></span>
<span id="cb227-4"><a href="spatial-models-part-2.html#cb227-4" tabindex="-1"></a><span class="fu">write.csv</span>(gwr.data, <span class="at">file =</span> <span class="st">&quot;gwr output.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><strong>Very important notes</strong> about the <code>gwr.data</code> object:</p>
<ol style="list-style-type: decimal">
<li>The following columns in the <code>gwr.data</code> contain our LSOA-specific coefficients for log-transformed income, deprivation and accessibility: <code>log10.AVEINCOME.</code>, <code>log10.IMDSCORE.</code> and <code>log10.PTAINDEX.</code> respectively. These results tell us the association between the dependent and independent variable within an LSOA.</li>
<li>The following columns in the <code>gwr.data</code> contain our LSOA-specific standard error estimates for log-transformed income, deprivation and accessibility: <code>log10.AVEINCOME._se</code>, <code>log10.IMDSCORE._se</code> and <code>log10.PTAINDEX._se</code>. These results helps us calculate a test statistic for assessing whether an association found between the dependent and independent variable in an LSOA is statistically significant or not.</li>
<li>The following column <code>localR2</code> in the <code>gwr.data</code> helps us to assess the model’s performance. Values close to 1 is an indication of a very good model and vice versa.</li>
</ol>
<p>We can generate these results as maps. Now, let us bring the results together into one clean spatial data frame:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="spatial-models-part-2.html#cb228-1" tabindex="-1"></a><span class="co"># create neat spatial data frame by keeping first two columns</span></span>
<span id="cb228-2"><a href="spatial-models-part-2.html#cb228-2" tabindex="-1"></a>lsoa_result <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(spatialdatafile[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)])</span>
<span id="cb228-3"><a href="spatial-models-part-2.html#cb228-3" tabindex="-1"></a></span>
<span id="cb228-4"><a href="spatial-models-part-2.html#cb228-4" tabindex="-1"></a><span class="co"># insert coefficients into lsoa_result object</span></span>
<span id="cb228-5"><a href="spatial-models-part-2.html#cb228-5" tabindex="-1"></a>lsoa_result<span class="sc">$</span>CoefLogInc <span class="ot">&lt;-</span> gwr.data[,<span class="st">&quot;log10.AVEINCOME.&quot;</span>]</span>
<span id="cb228-6"><a href="spatial-models-part-2.html#cb228-6" tabindex="-1"></a>lsoa_result<span class="sc">$</span>CoefLogIMD <span class="ot">&lt;-</span> gwr.data[,<span class="st">&quot;log10.IMDSCORE.&quot;</span>]</span>
<span id="cb228-7"><a href="spatial-models-part-2.html#cb228-7" tabindex="-1"></a>lsoa_result<span class="sc">$</span>CoefLogPTAL <span class="ot">&lt;-</span> gwr.data[,<span class="st">&quot;log10.PTAINDEX.&quot;</span>]</span>
<span id="cb228-8"><a href="spatial-models-part-2.html#cb228-8" tabindex="-1"></a></span>
<span id="cb228-9"><a href="spatial-models-part-2.html#cb228-9" tabindex="-1"></a><span class="co"># insert standard errors into lsoa_result object</span></span>
<span id="cb228-10"><a href="spatial-models-part-2.html#cb228-10" tabindex="-1"></a>lsoa_result<span class="sc">$</span>SELogInc <span class="ot">&lt;-</span> gwr.data[,<span class="st">&quot;log10.AVEINCOME._se&quot;</span>]</span>
<span id="cb228-11"><a href="spatial-models-part-2.html#cb228-11" tabindex="-1"></a>lsoa_result<span class="sc">$</span>SELogIMD <span class="ot">&lt;-</span> gwr.data[,<span class="st">&quot;log10.IMDSCORE._se&quot;</span>]</span>
<span id="cb228-12"><a href="spatial-models-part-2.html#cb228-12" tabindex="-1"></a>lsoa_result<span class="sc">$</span>SELogPTAL <span class="ot">&lt;-</span> gwr.data[,<span class="st">&quot;log10.PTAINDEX._se&quot;</span>]</span>
<span id="cb228-13"><a href="spatial-models-part-2.html#cb228-13" tabindex="-1"></a></span>
<span id="cb228-14"><a href="spatial-models-part-2.html#cb228-14" tabindex="-1"></a><span class="co"># insert localR2 estimates into lsoa_result object</span></span>
<span id="cb228-15"><a href="spatial-models-part-2.html#cb228-15" tabindex="-1"></a>lsoa_result<span class="sc">$</span>localR2 <span class="ot">&lt;-</span> gwr.data[,<span class="st">&quot;localR2&quot;</span>]</span></code></pre></div>
<p>Using deprivation score, we report its associated impact on house prices across the LSOAs in London by mapping its LSOA-specific coefficients using the code:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="spatial-models-part-2.html#cb229-1" tabindex="-1"></a><span class="fu">tm_shape</span>(lsoa_result) <span class="sc">+</span> </span>
<span id="cb229-2"><a href="spatial-models-part-2.html#cb229-2" tabindex="-1"></a><span class="fu">tm_fill</span>(<span class="st">&quot;CoefLogIMD&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Coefficient: Log(IMD) [%]&quot;</span>, <span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">palette =</span> <span class="st">&quot;RdBu&quot;</span>) <span class="sc">+</span></span>
<span id="cb229-3"><a href="spatial-models-part-2.html#cb229-3" tabindex="-1"></a><span class="fu">tm_shape</span>(borough.shp) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">border.alpha =</span> <span class="dv">1</span>, <span class="at">border.col =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb229-4"><a href="spatial-models-part-2.html#cb229-4" tabindex="-1"></a><span class="fu">tm_text</span>(<span class="st">&quot;BOROUGHN&quot;</span>, <span class="at">size =</span> <span class="st">&quot;AREA&quot;</span>) <span class="sc">+</span></span>
<span id="cb229-5"><a href="spatial-models-part-2.html#cb229-5" tabindex="-1"></a><span class="fu">tm_compass</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>)) <span class="sc">+</span></span>
<span id="cb229-6"><a href="spatial-models-part-2.html#cb229-6" tabindex="-1"></a><span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb229-7"><a href="spatial-models-part-2.html#cb229-7" tabindex="-1"></a><span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">legend.title.size =</span> <span class="dv">1</span>, <span class="at">legend.text.size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Output from the above <code>tmap()</code> functions:</p>
<p><img src="images/general/week10/Coef_IMD.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Also use the <code>summary()</code> to help with the interpretation:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="spatial-models-part-2.html#cb230-1" tabindex="-1"></a><span class="fu">summary</span>(lsoa_result<span class="sc">$</span>CoefLogIMD)</span></code></pre></div>
<p>Output from the above <code>summary()</code> function:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="spatial-models-part-2.html#cb231-1" tabindex="-1"></a>      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. </span>
<span id="cb231-2"><a href="spatial-models-part-2.html#cb231-2" tabindex="-1"></a><span class="sc">-</span><span class="fl">0.9468199</span> <span class="sc">-</span><span class="fl">0.1097532</span> <span class="sc">-</span><span class="fl">0.0001324</span>  <span class="fl">0.0066443</span>  <span class="fl">0.1246952</span>  <span class="fl">1.0851076</span></span></code></pre></div>
<div class="note">
<p><strong>INTEPRETATION:</strong> There is spatial variability in the relationship between our variable socioeconomic deprivation (transformed) and averaged house price (transformed) in London. The GWR outputs reveals that local coefficients range from a minimum value of <code>-0.946</code> to a maximum value of <code>1.085</code>, indicating that one percentage point increase in the levels of deprivation in LSOAs of London is associated with a reduction of <code>0.946%</code> in house prices in some LSOAs and (weirdly) an increase of <code>1.085%</code> in others. Broadly, the relationship are opposing.</p>
</div>
<p>Now, while the above map offer some valuable insights to understand the spatial pattering of relationships, they do not identify whether these associations are <strong>statistically significant</strong>. They may or may not be. Roughly, for a sample that is sufficiently large - if take a coefficient estimate and divide it by its corresponding standard error to get an absolute value (i.e., t-score) that exceeds either <code>-1.96</code> or <code>+1.96</code>, then it is statistically significant.</p>
<p>We can easily compute estimates to determine significance:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="spatial-models-part-2.html#cb232-1" tabindex="-1"></a><span class="co"># compute t-score statistic</span></span>
<span id="cb232-2"><a href="spatial-models-part-2.html#cb232-2" tabindex="-1"></a>lsoa_result<span class="sc">$</span>tstatIMD <span class="ot">&lt;-</span> lsoa_result<span class="sc">$</span>CoefLogIMD <span class="sc">/</span> lsoa_result<span class="sc">$</span>SELogIMD</span>
<span id="cb232-3"><a href="spatial-models-part-2.html#cb232-3" tabindex="-1"></a><span class="co"># create significance column with: &quot;Reduction: Significant&quot;, &quot;Not Significant&quot;, &quot;Increase: Significant&quot; </span></span>
<span id="cb232-4"><a href="spatial-models-part-2.html#cb232-4" tabindex="-1"></a>lsoa_result<span class="sc">$</span>significant <span class="ot">&lt;-</span> <span class="fu">cut</span>(lsoa_result<span class="sc">$</span>tstatIMD,</span>
<span id="cb232-5"><a href="spatial-models-part-2.html#cb232-5" tabindex="-1"></a>    <span class="at">breaks=</span><span class="fu">c</span>(<span class="fu">min</span>(lsoa_result<span class="sc">$</span>tstatIMD), <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="fu">max</span>(lsoa_result<span class="sc">$</span>tstatIMD)),</span>
<span id="cb232-6"><a href="spatial-models-part-2.html#cb232-6" tabindex="-1"></a>    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Reduction: Significant&quot;</span>,<span class="st">&quot;Not Significant&quot;</span>, <span class="st">&quot;Increase: Significant&quot;</span>))</span></code></pre></div>
<p>Now, let us report which relationship are significant or not by mapping the significance categories using the code:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="spatial-models-part-2.html#cb233-1" tabindex="-1"></a><span class="fu">tm_shape</span>(lsoa_result) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">&quot;significant&quot;</span>, <span class="at">title =</span> <span class="st">&quot;&quot;</span>, <span class="at">style =</span> <span class="st">&quot;cat&quot;</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Reduction: Significant&quot;</span>, <span class="st">&quot;Not Significant&quot;</span>, <span class="st">&quot;Increase: Significant&quot;</span>), <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb233-2"><a href="spatial-models-part-2.html#cb233-2" tabindex="-1"></a>    <span class="fu">tm_shape</span>(borough.shp) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">border.alpha =</span> <span class="dv">1</span>, <span class="at">border.col =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb233-3"><a href="spatial-models-part-2.html#cb233-3" tabindex="-1"></a>    <span class="fu">tm_text</span>(<span class="st">&quot;BOROUGHN&quot;</span>, <span class="at">size =</span> <span class="st">&quot;AREA&quot;</span>) <span class="sc">+</span></span>
<span id="cb233-4"><a href="spatial-models-part-2.html#cb233-4" tabindex="-1"></a>    <span class="fu">tm_compass</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>)) <span class="sc">+</span></span>
<span id="cb233-5"><a href="spatial-models-part-2.html#cb233-5" tabindex="-1"></a>    <span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb233-6"><a href="spatial-models-part-2.html#cb233-6" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">legend.title.size =</span> <span class="dv">1</span>, <span class="at">legend.text.size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Output from the above <code>tmap()</code> functions:</p>
<p><img src="images/general/week10/Sig_IMD.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="note">
<p><strong>INTEPRETATION:</strong> For instance, in the Borough of Hounslow, we can see a significant reduction in house prices in relation to increased levels of socioeconomic deprivation (adjusted for income and accessibility). Such reduction are clustered in the <strong>mid-section</strong> of Borough of Hounslow which were coloured <strong>red</strong>. Note that in <strong>far north eastern</strong> section of the Borough of Hounslow with pockets of LSOA’s coloured <strong>blue</strong> shows a significant increase in house price in relationship to IMD which is difficult to explain and thus can be interpreted as a chance finding. All sections that are <strong>white</strong> are not significant.</p>
</div>
<p>Let finally map the local r-square values to examine model performance:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="spatial-models-part-2.html#cb234-1" tabindex="-1"></a><span class="co"># map localR2 to examine model performance</span></span>
<span id="cb234-2"><a href="spatial-models-part-2.html#cb234-2" tabindex="-1"></a><span class="fu">tm_shape</span>(lsoa_result) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">&quot;localR2&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Adaptive: Local R2&quot;</span>, <span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">midpoint =</span> <span class="fl">0.5</span>, <span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>) <span class="sc">+</span></span>
<span id="cb234-3"><a href="spatial-models-part-2.html#cb234-3" tabindex="-1"></a>    <span class="fu">tm_shape</span>(borough.shp) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">border.alpha =</span> <span class="dv">1</span>, <span class="at">border.col =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb234-4"><a href="spatial-models-part-2.html#cb234-4" tabindex="-1"></a>    <span class="fu">tm_text</span>(<span class="st">&quot;BOROUGHN&quot;</span>, <span class="at">size =</span> <span class="st">&quot;AREA&quot;</span>) <span class="sc">+</span></span>
<span id="cb234-5"><a href="spatial-models-part-2.html#cb234-5" tabindex="-1"></a>    <span class="fu">tm_compass</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>)) <span class="sc">+</span></span>
<span id="cb234-6"><a href="spatial-models-part-2.html#cb234-6" tabindex="-1"></a>    <span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb234-7"><a href="spatial-models-part-2.html#cb234-7" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">legend.title.size =</span> <span class="dv">1</span>, <span class="at">legend.text.size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Output from the above <code>tmap()</code> functions:</p>
<p><img src="images/general/week10/LocalR2.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="note">
<p><strong>INTEPRETATION:</strong> The areas that are going towards the shade of dark reds are local regression models that have broadly performed poorly in its prediction for house price and its association with the three variables (income, deprivation and PTAL). Likewise, the areas that are going towards the shade of dark blues are local regression models that have broadly performed very well in its prediction for house price and its association with the three variables (income, deprivation and PTAL).</p>
</div>
</div>
</div>
<div id="tasks" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Tasks<a href="spatial-models-part-2.html#tasks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Map the local coefficients and significance categories for <strong>average income</strong> and <strong>PTAL</strong>. What is the interpretation for the spatial patterning and association with house prices in London?</p>
</div>
<div id="attributions-2" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Attributions<a href="spatial-models-part-2.html#attributions-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This week’s practical was inspired from:</p>
<ol style="list-style-type: decimal">
<li>Cheshire, J. &amp; Lansley, G. (2016). An Introduction to Spatial Data Analysis and Visualisation in R. (A) GWR tutorials were originally hosted on the CDRC website (Requires a log in account) <a href="https://data.cdrc.ac.uk/dataset/introduction-spatial-data-analysis-and-visualisation-r"><strong>LINK</strong></a>. (B) Direct link to the GWR tutorials posted by Professor James Cheshire as a Bookdown via his Github account <a href="https://jamescheshire.github.io/learningR/geographically-weighted-regression.html"><strong>LINK</strong></a></li>
<li>Rowe, F. &amp; Arribas-Bel, D. (2022). Spatial Modelling for Data Scientists, Chapter 9: Geographically Weighted Regression <a href="https://gdsl-ul.github.io/san/gwr.html"><strong>LINK</strong></a></li>
</ol>
</div>
<div id="references-see-reading-list-5" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">9.7</span> References (see reading list)<a href="spatial-models-part-2.html#references-see-reading-list-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><strong>Book</strong>: [R Programming] Brunsdon, C. <em>et al</em> (2018) An Introduction to R for Spatial Analysis and Mapping; <strong>Chapter 7: Spatial Attribute Analysis with R</strong>, (See pages 257 to 262) <a href="https://ucl.primo.exlibrisgroup.com/discovery/search?query=any,contains,An%20Introduction%20to%20R%20for%20Spatial%20Analysis%20and%20Mapping&amp;tab=Everything&amp;search_scope=MyInst_and_CI&amp;sortby=date_d&amp;vid=44UCL_INST:UCL_VU2&amp;facet=frbrgroupid,include,9076326046905167101&amp;offset=0"><strong>Click link</strong></a> (Note: Books can be borrowed from UCL’s Library)</li>
<li><strong>Book</strong>: [R Programming] Brunsdon, C. <em>et al</em> (2018) An Introduction to R for Spatial Analysis and Mapping; <strong>Chapter 8: Localised Spatial Analysis</strong>, (See pages 281 to 289) <a href="https://ucl.primo.exlibrisgroup.com/discovery/search?query=any,contains,An%20Introduction%20to%20R%20for%20Spatial%20Analysis%20and%20Mapping&amp;tab=Everything&amp;search_scope=MyInst_and_CI&amp;sortby=date_d&amp;vid=44UCL_INST:UCL_VU2&amp;facet=frbrgroupid,include,9076326046905167101&amp;offset=0"><strong>Click link</strong></a> (Note: Books can be borrowed from UCL’s Library)</li>
<li><strong>Book</strong>: [Theory] Lloyd, C.D., <em>et al</em> (2010) Spatial Data Analysis: An Introduction for GIS Users; <strong>Chapter 8: Exploring spatial patterning in data values</strong>, (See section 8.5.3. [Geographically Weighted Regression] on pages 115 to 123)</li>
<li><strong>Book</strong>: [R Programming] Roger S. Bivand, Edzer J. Pebesma and Virgilio Gomez-Rubio, (2008), Applied Spatial Data Analysis with R; <strong>Chapter 10: Modelling of Areal Data</strong>, (See section 10.5.3. [Geographically Weighted Regression] on pages 305 to 309)</li>
<li><strong>Paper</strong> [Theory] Comber, A. <em>et al</em> (2022) A Route Map for Successful Application of Geographically Weighted Regression; Geographical Analysis; <a href="https://doi.org/10.1111/gean.12316" class="uri">https://doi.org/10.1111/gean.12316</a> <a href="https://onlinelibrary.wiley.com/doi/epdf/10.1111/gean.12316"><strong>Click link</strong></a></li>
</ol>
</div>
<div id="data-sources-6" class="section level2 hasAnchor" number="9.8">
<h2><span class="header-section-number">9.8</span> Data Sources<a href="spatial-models-part-2.html#data-sources-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>English indices for Multiple Deprivation (IMD) for 2019 [Source: <strong>UK Gov</strong>] <a href="https://www.gov.uk/government/statistics/english-indices-of-deprivation-2019"><strong>Click Here</strong></a></li>
<li>UK Shape files for different geographic units [Source: <strong>Office for National Statistics, Open Geography Portal</strong>] <a href="https://geoportal.statistics.gov.uk"><strong>Click Here</strong></a></li>
<li>The following indicators for averaged house prices, income and PTAL estimates were obtained from <a href="https://data.london.gov.uk/dataset/"><strong>London DATASTORE</strong></a></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spatial-models-part-1.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": true
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/UCLPG-MSC-SGDS/GEOG0114/edit/main/09-Spatial_regression_models_GWR.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
