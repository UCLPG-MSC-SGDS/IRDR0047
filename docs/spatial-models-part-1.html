<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Spatial Models: Part 1 | GEOG0114: Principles of Spatial Analysis (2023/24)</title>
  <meta name="description" content="GEOG0114: Principles of Spatial Analysis" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Spatial Models: Part 1 | GEOG0114: Principles of Spatial Analysis (2023/24)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="GEOG0114: Principles of Spatial Analysis" />
  <meta name="github-repo" content="UCLPG-MSC-SGDS/GEOG0114" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Spatial Models: Part 1 | GEOG0114: Principles of Spatial Analysis (2023/24)" />
  
  <meta name="twitter:description" content="GEOG0114: Principles of Spatial Analysis" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="geostatistical-modelling.html"/>
<link rel="next" href="spatial-models-part-2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="assets/custom.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo">
<a href="https://www.ucl.ac.uk/module-catalogue/modules/GEOG0114"><img src="images/general/ucl_logo.png">
</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i>Structure</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#moodle"><i class="fa fa-check"></i>Moodle</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#module-tutors-and-contacts-for-geog0114"><i class="fa fa-check"></i>Module tutors and contacts for GEOG0114</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html"><i class="fa fa-check"></i>Reading List for GEOG0114 2023/24</a>
<ul>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-1-spatial-analysis-for-data-science"><i class="fa fa-check"></i>Week 1: Spatial analysis for data science</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-2-graphical-representation-of-spatial-data"><i class="fa fa-check"></i>Week 2: Graphical representation of spatial data</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-3-spatial-autocorrelation"><i class="fa fa-check"></i>Week 3: Spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-4-suitability-mapping-part-1"><i class="fa fa-check"></i>Week 4: Suitability Mapping (Part 1)</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-5-suitability-mapping-part-2"><i class="fa fa-check"></i>Week 5: Suitability Mapping (Part 2)</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-6-geostatistical-modelling"><i class="fa fa-check"></i>Week 6: Geostatistical Modelling</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-9-spatial-models-part-1"><i class="fa fa-check"></i>Week 9: Spatial Models (Part 1)</a></li>
<li class="chapter" data-level="" data-path="reading-list-for-geog0114-202324.html"><a href="reading-list-for-geog0114-202324.html#week-10-spatial-models-part-2"><i class="fa fa-check"></i>Week 10: Spatial Models (Part 2)</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="installation-of-r-and-rstudio.html"><a href="installation-of-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Installation of R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="installation-of-r-and-rstudio.html"><a href="installation-of-r-and-rstudio.html#what-is-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> What is R and RStudio?</a></li>
<li class="chapter" data-level="1.2" data-path="installation-of-r-and-rstudio.html"><a href="installation-of-r-and-rstudio.html#downloading-and-install-r-and-rstudio-on-to-your-laptop"><i class="fa fa-check"></i><b>1.2</b> Downloading and install R and RStudio on to your laptop</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="installation-of-r-and-rstudio.html"><a href="installation-of-r-and-rstudio.html#installation-for-macos-users"><i class="fa fa-check"></i><b>1.2.1</b> Installation for MacOS users</a></li>
<li class="chapter" data-level="1.2.2" data-path="installation-of-r-and-rstudio.html"><a href="installation-of-r-and-rstudio.html#installation-for-windows-users"><i class="fa fa-check"></i><b>1.2.2</b> Installation for Windows users</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html"><i class="fa fa-check"></i><b>2</b> Spatial analysis for data sciences</a>
<ul>
<li class="chapter" data-level="2.1" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#lecture-video-length-010001"><i class="fa fa-check"></i><b>2.1.1</b> Lecture video (Length: 01:00:01)</a></li>
<li class="chapter" data-level="2.1.2" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#computer-practical-video-length-015949"><i class="fa fa-check"></i><b>2.1.2</b> Computer practical video (Length: 01:59:49)</a></li>
<li class="chapter" data-level="2.1.3" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#learning-outcomes"><i class="fa fa-check"></i><b>2.1.3</b> Learning outcomes</a></li>
<li class="chapter" data-level="2.1.4" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#becoming-familiar-with-the-panels-in-rstudio"><i class="fa fa-check"></i><b>2.1.4</b> Becoming familiar with the panels in RStudio</a></li>
<li class="chapter" data-level="2.1.5" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#using-r-console-as-a-calculator"><i class="fa fa-check"></i><b>2.1.5</b> Using R Console as a Calculator</a></li>
<li class="chapter" data-level="2.1.6" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#creating-basic-objects-and-assigning-values-to-it"><i class="fa fa-check"></i><b>2.1.6</b> Creating basic objects and assigning values to it</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#basics-of-managing-data-in-rstudio"><i class="fa fa-check"></i><b>2.2</b> Basics of managing data in RStudio</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#how-do-we-enter-data-into-rstudio"><i class="fa fa-check"></i><b>2.2.1</b> How do we enter data into RStudio?</a></li>
<li class="chapter" data-level="2.2.2" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#how-do-we-create-a-variable-based-on-other-existing-variables-in-our-data-frame"><i class="fa fa-check"></i><b>2.2.2</b> How do we create a variable based on other existing variables in our data frame?</a></li>
<li class="chapter" data-level="2.2.3" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#how-do-we-set-the-working-directory-in-our-computer-by-connecting-our-folder-to-rstudio-with-the-setwd-function"><i class="fa fa-check"></i><b>2.2.3</b> How do we set the working directory in our computer by connecting our folder to RStudio with the <code>setwd()</code> function?</a></li>
<li class="chapter" data-level="2.2.4" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#how-do-we-import-merge-and-export-csv-data-with-rstudio"><i class="fa fa-check"></i><b>2.2.4</b> How do we import, merge and export CSV data with RStudio?</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#basic-visualisation-of-spatial-data-in-rstudio"><i class="fa fa-check"></i><b>2.3</b> Basic visualisation of spatial data in RStudio</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#installing-packages-into-rstudio"><i class="fa fa-check"></i><b>2.3.1</b> Installing packages into RStudio</a></li>
<li class="chapter" data-level="2.3.2" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#adding-shapefiles-in-rstudio"><i class="fa fa-check"></i><b>2.3.2</b> Adding shapefiles in RStudio</a></li>
<li class="chapter" data-level="2.3.3" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#mapping-with-tmap-functions-in-rstudio"><i class="fa fa-check"></i><b>2.3.3</b> Mapping with ‘tmap’ functions in RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#references"><i class="fa fa-check"></i><b>2.4</b> References</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#recommended-reading-see-reading-list"><i class="fa fa-check"></i><b>2.4.1</b> Recommended reading (see reading list)</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#data-sources"><i class="fa fa-check"></i><b>2.5</b> Data Sources</a></li>
<li class="chapter" data-level="2.6" data-path="spatial-analysis-for-data-sciences.html"><a href="spatial-analysis-for-data-sciences.html#practical-homework"><i class="fa fa-check"></i><b>2.6</b> Practical homework</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html"><i class="fa fa-check"></i><b>3</b> Graphical representation of spatial data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#lecture-video-length-4313"><i class="fa fa-check"></i><b>3.1.1</b> Lecture video (Length: 43:13)</a></li>
<li class="chapter" data-level="3.1.2" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#computer-practical-video-length-015948"><i class="fa fa-check"></i><b>3.1.2</b> Computer practical video (Length: 01:59:48)</a></li>
<li class="chapter" data-level="3.1.3" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#learning-outcomes-1"><i class="fa fa-check"></i><b>3.1.3</b> Learning outcomes</a></li>
<li class="chapter" data-level="3.1.4" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#getting_started_w03"><i class="fa fa-check"></i><b>3.1.4</b> Getting started</a></li>
<li class="chapter" data-level="3.1.5" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#datasets-setting-up-the-work-directory"><i class="fa fa-check"></i><b>3.1.5</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="3.1.6" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#loading-and-installing-packages"><i class="fa fa-check"></i><b>3.1.6</b> Loading and installing packages</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#case_study_w03"><i class="fa fa-check"></i><b>3.2</b> Case study</a></li>
<li class="chapter" data-level="3.3" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#loading_data_w03"><i class="fa fa-check"></i><b>3.3</b> Loading our data sets for case study</a></li>
<li class="chapter" data-level="3.4" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#data-processing"><i class="fa fa-check"></i><b>3.4</b> Data Processing</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#reprojecting"><i class="fa fa-check"></i><b>3.4.1</b> Reprojecting</a></li>
<li class="chapter" data-level="3.4.2" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#dissolving"><i class="fa fa-check"></i><b>3.4.2</b> Dissolving</a></li>
<li class="chapter" data-level="3.4.3" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#subsetting"><i class="fa fa-check"></i><b>3.4.3</b> Subsetting</a></li>
<li class="chapter" data-level="3.4.4" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#unioning"><i class="fa fa-check"></i><b>3.4.4</b> Unioning</a></li>
<li class="chapter" data-level="3.4.5" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#clipping"><i class="fa fa-check"></i><b>3.4.5</b> Clipping</a></li>
<li class="chapter" data-level="3.4.6" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#attribute-selection"><i class="fa fa-check"></i><b>3.4.6</b> Attribute selection</a></li>
<li class="chapter" data-level="3.4.7" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#buffering"><i class="fa fa-check"></i><b>3.4.7</b> Buffering</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#greenspace-in-london"><i class="fa fa-check"></i><b>3.5</b> Greenspace in London</a></li>
<li class="chapter" data-level="3.6" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#attributions_w03"><i class="fa fa-check"></i><b>3.6</b> Attributions</a></li>
<li class="chapter" data-level="3.7" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#reading_w03"><i class="fa fa-check"></i><b>3.7</b> References (see reading list)</a></li>
<li class="chapter" data-level="3.8" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#data-sources-1"><i class="fa fa-check"></i><b>3.8</b> Data Sources</a></li>
<li class="chapter" data-level="3.9" data-path="graphical-representation-of-spatial-data.html"><a href="graphical-representation-of-spatial-data.html#practical-homework-1"><i class="fa fa-check"></i><b>3.9</b> Practical homework</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html"><i class="fa fa-check"></i><b>4</b> Spatial autocorrelation and dependence</a>
<ul>
<li class="chapter" data-level="4.1" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#lecture-video-length-010642"><i class="fa fa-check"></i><b>4.1.1</b> Lecture video (Length: 01:06:42)</a></li>
<li class="chapter" data-level="4.1.2" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#computer-practical-video-length-020001"><i class="fa fa-check"></i><b>4.1.2</b> Computer practical video (Length: 02:00:01)</a></li>
<li class="chapter" data-level="4.1.3" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#learning-outcomes-2"><i class="fa fa-check"></i><b>4.1.3</b> Learning outcomes</a></li>
<li class="chapter" data-level="4.1.4" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#getting-started"><i class="fa fa-check"></i><b>4.1.4</b> Getting started</a></li>
<li class="chapter" data-level="4.1.5" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#datasets-setting-up-the-work-directory-1"><i class="fa fa-check"></i><b>4.1.5</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="4.1.6" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#loading-and-installing-packages-1"><i class="fa fa-check"></i><b>4.1.6</b> Loading and installing packages</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#case-study"><i class="fa fa-check"></i><b>4.2</b> Case study</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#neighbours"><i class="fa fa-check"></i><b>4.2.1</b> Neighbours</a></li>
<li class="chapter" data-level="4.2.2" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#theft-in-camden"><i class="fa fa-check"></i><b>4.2.2</b> Theft in Camden</a></li>
<li class="chapter" data-level="4.2.3" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#global-morans-i"><i class="fa fa-check"></i><b>4.2.3</b> Global Moran’s I</a></li>
<li class="chapter" data-level="4.2.4" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#local-morans-i-or-lisa"><i class="fa fa-check"></i><b>4.2.4</b> Local Moran’s I (or LISA)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#attributions"><i class="fa fa-check"></i><b>4.3</b> Attributions</a></li>
<li class="chapter" data-level="4.4" data-path="spatial-autocorrelation-and-dependence.html"><a href="spatial-autocorrelation-and-dependence.html#references-see-reading-list"><i class="fa fa-check"></i><b>4.4</b> References (see reading list)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html"><i class="fa fa-check"></i><b>5</b> Suitability Mapping: Part 1</a>
<ul>
<li class="chapter" data-level="5.1" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#lecture-video-tbc"><i class="fa fa-check"></i><b>5.1.1</b> Lecture video (TBC)</a></li>
<li class="chapter" data-level="5.1.2" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#computer-practical-video-length-020001-1"><i class="fa fa-check"></i><b>5.1.2</b> Computer practical video (Length: 02:00:01)</a></li>
<li class="chapter" data-level="5.1.3" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#learning-outcomes-3"><i class="fa fa-check"></i><b>5.1.3</b> Learning outcomes</a></li>
<li class="chapter" data-level="5.1.4" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#datasets-setting-up-the-work-directory-2"><i class="fa fa-check"></i><b>5.1.4</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="5.1.5" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#loading-and-installing-packages-2"><i class="fa fa-check"></i><b>5.1.5</b> Loading and installing packages</a></li>
<li class="chapter" data-level="5.1.6" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#loading-datasets"><i class="fa fa-check"></i><b>5.1.6</b> Loading datasets</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#suitability-mapping-using-simple-overlays"><i class="fa fa-check"></i><b>5.2</b> Suitability mapping using Simple Overlays</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#setting-up-binary-classification-on-raster"><i class="fa fa-check"></i><b>5.2.1</b> Setting up binary classification on raster</a></li>
<li class="chapter" data-level="5.2.2" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#finding-areas-of-suitability-by-multiplying-the-binary-rasters"><i class="fa fa-check"></i><b>5.2.2</b> Finding areas of suitability by multiplying the binary rasters</a></li>
<li class="chapter" data-level="5.2.3" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#finding-areas-of-suitability-by-summing-the-binary-rasters"><i class="fa fa-check"></i><b>5.2.3</b> Finding areas of suitability by summing the binary rasters</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#analytical-hierarchy-process-ahp"><i class="fa fa-check"></i><b>5.3</b> Analytical Hierarchy Process (AHP)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#standardizing-the-raster-variables-to-the-same-scale-from-1-to-10"><i class="fa fa-check"></i><b>5.3.1</b> Standardizing the raster variables to the same scale (from 1 to 10)</a></li>
<li class="chapter" data-level="5.3.2" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#determining-the-weight-of-each-variable-using-saatys-ahp"><i class="fa fa-check"></i><b>5.3.2</b> Determining the weight of each variable using Saaty’s AHP</a></li>
<li class="chapter" data-level="5.3.3" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#weighted-linear-combination-wlc-and-derivation-of-suitability-maps-based-from-ahp-analysis"><i class="fa fa-check"></i><b>5.3.3</b> Weighted Linear Combination (WLC) and derivation of Suitability Maps based from AHP analysis</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#references-see-reading-list-1"><i class="fa fa-check"></i><b>5.4</b> References (see reading list)</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#recommended-reading"><i class="fa fa-check"></i><b>5.4.1</b> Recommended reading</a></li>
<li class="chapter" data-level="5.4.2" data-path="suitability-mapping-part-1.html"><a href="suitability-mapping-part-1.html#data-sources-2"><i class="fa fa-check"></i><b>5.4.2</b> Data Sources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html"><i class="fa fa-check"></i><b>6</b> Suitability Mapping: Part 2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#lecture-video-length-010642-1"><i class="fa fa-check"></i><b>6.1.1</b> Lecture video (Length: 01:06:42)</a></li>
<li class="chapter" data-level="6.1.2" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#computer-practical-video-length-020001-2"><i class="fa fa-check"></i><b>6.1.2</b> Computer practical video (Length 02:00:01)</a></li>
<li class="chapter" data-level="6.1.3" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#learning-outcomes-4"><i class="fa fa-check"></i><b>6.1.3</b> Learning outcomes</a></li>
<li class="chapter" data-level="6.1.4" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#datasets-setting-up-the-work-directory-3"><i class="fa fa-check"></i><b>6.1.4</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="6.1.5" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#loading-and-installing-packages-3"><i class="fa fa-check"></i><b>6.1.5</b> Loading and installing packages</a></li>
<li class="chapter" data-level="6.1.6" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#loading-datasets-1"><i class="fa fa-check"></i><b>6.1.6</b> Loading datasets</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#data-preparation-for-the-maxent-analysis"><i class="fa fa-check"></i><b>6.2</b> Data preparation for the MAXENT analysis</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#creating-a-multi-band-raster-using-the-stack-function"><i class="fa fa-check"></i><b>6.2.1</b> Creating a multi-band raster using the stack() function</a></li>
<li class="chapter" data-level="6.2.2" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#preparing-data-for-pseudo-background-points-as-absence"><i class="fa fa-check"></i><b>6.2.2</b> Preparing data for pseudo-background points as absence</a></li>
<li class="chapter" data-level="6.2.3" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#extraction-of-all-raster-values-from-predictor-variables-onto-presence-absence-points"><i class="fa fa-check"></i><b>6.2.3</b> Extraction of all raster values from predictor variables onto presence-absence points</a></li>
<li class="chapter" data-level="6.2.4" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#preparation-of-training-test-data-for-prediction-model-cross-validation"><i class="fa fa-check"></i><b>6.2.4</b> Preparation of training &amp; test data for prediction &amp; model cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#maxent-analysis"><i class="fa fa-check"></i><b>6.3</b> MAXENT Analysis</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#examination-of-the-predictors-contribution-and-response-curves"><i class="fa fa-check"></i><b>6.3.1</b> Examination of the predictor’s contribution and response curves</a></li>
<li class="chapter" data-level="6.3.2" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#model-validation"><i class="fa fa-check"></i><b>6.3.2</b> Model validation</a></li>
<li class="chapter" data-level="6.3.3" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#mapping-the-predicted-probability-and-suitability"><i class="fa fa-check"></i><b>6.3.3</b> Mapping the predicted probability and suitability</a></li>
<li class="chapter" data-level="6.3.4" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#supplementary-code-for-4-fold-analysis"><i class="fa fa-check"></i><b>6.3.4</b> Supplementary code for 4-fold analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#attributions-1"><i class="fa fa-check"></i><b>6.4</b> Attributions</a></li>
<li class="chapter" data-level="6.5" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#references-see-reading-list-2"><i class="fa fa-check"></i><b>6.5</b> References (see reading list)</a></li>
<li class="chapter" data-level="6.6" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#data-sources-3"><i class="fa fa-check"></i><b>6.6</b> Data Sources</a></li>
<li class="chapter" data-level="6.7" data-path="suitability-mapping-part-2.html"><a href="suitability-mapping-part-2.html#practical-homework-2"><i class="fa fa-check"></i><b>6.7</b> Practical homework</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html"><i class="fa fa-check"></i><b>7</b> Geostatistical Modelling</a>
<ul>
<li class="chapter" data-level="7.1" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#introduction-5"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#lecture-video-length-010617"><i class="fa fa-check"></i><b>7.1.1</b> Lecture video (Length: 01:06:17)</a></li>
<li class="chapter" data-level="7.1.2" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#computer-practical-video-length-020001-3"><i class="fa fa-check"></i><b>7.1.2</b> Computer practical video (Length: 02:00:01)</a></li>
<li class="chapter" data-level="7.1.3" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#learning-objectives"><i class="fa fa-check"></i><b>7.1.3</b> Learning objectives</a></li>
<li class="chapter" data-level="7.1.4" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#datasets-setting-up-the-work-directory-4"><i class="fa fa-check"></i><b>7.1.4</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="7.1.5" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#loading-and-installing-packages-4"><i class="fa fa-check"></i><b>7.1.5</b> Loading and installing packages</a></li>
<li class="chapter" data-level="7.1.6" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#loading-datasets-2"><i class="fa fa-check"></i><b>7.1.6</b> Loading datasets</a></li>
<li class="chapter" data-level="7.1.7" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#data-preparation"><i class="fa fa-check"></i><b>7.1.7</b> Data preparation</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#semivariogram-analysis"><i class="fa fa-check"></i><b>7.2</b> Semivariogram analysis</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#plotting-the-empirical-semivariogram"><i class="fa fa-check"></i><b>7.2.1</b> Plotting the Empirical Semivariogram</a></li>
<li class="chapter" data-level="7.2.2" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#plotting-the-theoretical-semivariogram"><i class="fa fa-check"></i><b>7.2.2</b> Plotting the Theoretical Semivariogram</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#kriging-modelling-null"><i class="fa fa-check"></i><b>7.3</b> Kriging modelling (null)</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#building-a-blank-raster-template"><i class="fa fa-check"></i><b>7.3.1</b> Building a blank raster template</a></li>
<li class="chapter" data-level="7.3.2" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#implementing-the-spatial-interpolation-on-blank-template-using-kriging"><i class="fa fa-check"></i><b>7.3.2</b> Implementing the spatial interpolation on blank template using Kriging</a></li>
<li class="chapter" data-level="7.3.3" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#how-to-export-the-results-as-.tiff-format-thematic-visualisation-in-tmap"><i class="fa fa-check"></i><b>7.3.3</b> How to export the results as .tiff format thematic visualisation in <code>tmap</code></a></li>
<li class="chapter" data-level="7.3.4" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#thematic-visualisation-of-raster-data-using-tmap"><i class="fa fa-check"></i><b>7.3.4</b> Thematic visualisation of raster data using <code>tmap</code></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#kriging-modelling-non-null"><i class="fa fa-check"></i><b>7.4</b> Kriging modelling (non-null)</a></li>
<li class="chapter" data-level="7.5" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#references-see-reading-list-3"><i class="fa fa-check"></i><b>7.5</b> References (see reading list)</a></li>
<li class="chapter" data-level="7.6" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#data-sources-4"><i class="fa fa-check"></i><b>7.6</b> Data Sources</a></li>
<li class="chapter" data-level="7.7" data-path="geostatistical-modelling.html"><a href="geostatistical-modelling.html#practical-homework-3"><i class="fa fa-check"></i><b>7.7</b> Practical homework</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html"><i class="fa fa-check"></i><b>8</b> Spatial Models: Part 1</a>
<ul>
<li class="chapter" data-level="8.1" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#introduction-6"><i class="fa fa-check"></i><b>8.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#lecture-video-length-004147"><i class="fa fa-check"></i><b>8.1.1</b> Lecture video (Length: 00:41:47)</a></li>
<li class="chapter" data-level="8.1.2" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#computer-practical-video-length-020001-4"><i class="fa fa-check"></i><b>8.1.2</b> Computer practical video (Length: 02:00:01)</a></li>
<li class="chapter" data-level="8.1.3" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#learning-objective"><i class="fa fa-check"></i><b>8.1.3</b> Learning objective</a></li>
<li class="chapter" data-level="8.1.4" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#datasets-setting-up-the-work-directory-5"><i class="fa fa-check"></i><b>8.1.4</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="8.1.5" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#loading-and-installing-packages-5"><i class="fa fa-check"></i><b>8.1.5</b> Loading and installing packages</a></li>
<li class="chapter" data-level="8.1.6" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#loading-datasets-3"><i class="fa fa-check"></i><b>8.1.6</b> Loading datasets</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#diagnostics-of-residuals"><i class="fa fa-check"></i><b>8.2</b> Diagnostics of residuals</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#reporting-basic-summary-statistical-measures"><i class="fa fa-check"></i><b>8.2.1</b> Reporting basic summary statistical measures</a></li>
<li class="chapter" data-level="8.2.2" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#reporting-the-spatial-distribution-of-our-variables"><i class="fa fa-check"></i><b>8.2.2</b> Reporting the spatial distribution of our variables</a></li>
<li class="chapter" data-level="8.2.3" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#fitting-a-non-spatial-linear-regression-on-spatial-data-checking-the-residuals"><i class="fa fa-check"></i><b>8.2.3</b> Fitting a non-spatial Linear Regression on spatial data &amp; checking the residuals</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#spatial-regression-models"><i class="fa fa-check"></i><b>8.3</b> Spatial Regression Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#model-formation-for-spatial-lag-or-error-models"><i class="fa fa-check"></i><b>8.3.1</b> Model formation for spatial lag or error models</a></li>
<li class="chapter" data-level="8.3.2" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#spatial-lag-model-lagged-on-the-dependent-variable"><i class="fa fa-check"></i><b>8.3.2</b> Spatial Lag Model lagged on the dependent variable</a></li>
<li class="chapter" data-level="8.3.3" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#spatial-error-models"><i class="fa fa-check"></i><b>8.3.3</b> Spatial Error Models</a></li>
<li class="chapter" data-level="8.3.4" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#using-a-spatially-lagged-model-based-on-independent-variables"><i class="fa fa-check"></i><b>8.3.4</b> Using a Spatially lagged model based on independent variables</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#references-see-reading-list-4"><i class="fa fa-check"></i><b>8.4</b> References (see reading list)</a></li>
<li class="chapter" data-level="8.5" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#data-sources-5"><i class="fa fa-check"></i><b>8.5</b> Data Sources</a></li>
<li class="chapter" data-level="8.6" data-path="spatial-models-part-1.html"><a href="spatial-models-part-1.html#useful-videos"><i class="fa fa-check"></i><b>8.6</b> Useful videos</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html"><i class="fa fa-check"></i><b>9</b> Spatial Models: Part 2</a>
<ul>
<li class="chapter" data-level="9.1" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#computer-practical-video-length-015753"><i class="fa fa-check"></i><b>9.1</b> Computer practical video (Length: 01:57:53)</a></li>
<li class="chapter" data-level="9.2" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#introduction-7"><i class="fa fa-check"></i><b>9.2</b> Introduction</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#learning-outcomes-5"><i class="fa fa-check"></i><b>9.2.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="9.2.2" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#datasets-setting-up-the-work-directory-6"><i class="fa fa-check"></i><b>9.2.2</b> Datasets &amp; setting up the work directory</a></li>
<li class="chapter" data-level="9.2.3" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#installing-packages"><i class="fa fa-check"></i><b>9.2.3</b> Installing packages</a></li>
<li class="chapter" data-level="9.2.4" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#loading-datasets-4"><i class="fa fa-check"></i><b>9.2.4</b> Loading datasets</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#implementing-the-linear-regression-model"><i class="fa fa-check"></i><b>9.3</b> Implementing the Linear Regression model</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#obtaining-the-residuals-from-a-non-spatial-model"><i class="fa fa-check"></i><b>9.3.1</b> Obtaining the residuals from a non-spatial model</a></li>
<li class="chapter" data-level="9.3.2" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#use-residuals-and-test-for-spatial-autocorrelation"><i class="fa fa-check"></i><b>9.3.2</b> Use residuals and test for spatial autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#geographically-weighted-regression-gwr"><i class="fa fa-check"></i><b>9.4</b> Geographically Weighted Regression (GWR)</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#preparing-the-data-for-gwr-analysis"><i class="fa fa-check"></i><b>9.4.1</b> Preparing the data for GWR analysis</a></li>
<li class="chapter" data-level="9.4.2" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#fitting-a-gwr-using-gwr.sel-and-gwr"><i class="fa fa-check"></i><b>9.4.2</b> Fitting a GWR using <code>gwr.sel()</code> and <code>gwr()</code></a></li>
<li class="chapter" data-level="9.4.3" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#model-results"><i class="fa fa-check"></i><b>9.4.3</b> Model results</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#tasks"><i class="fa fa-check"></i><b>9.5</b> Tasks</a></li>
<li class="chapter" data-level="9.6" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#attributions-2"><i class="fa fa-check"></i><b>9.6</b> Attributions</a></li>
<li class="chapter" data-level="9.7" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#references-see-reading-list-5"><i class="fa fa-check"></i><b>9.7</b> References (see reading list)</a></li>
<li class="chapter" data-level="9.8" data-path="spatial-models-part-2.html"><a href="spatial-models-part-2.html#data-sources-6"><i class="fa fa-check"></i><b>9.8</b> Data Sources</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GEOG0114: Principles of Spatial Analysis (2023/24)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spatial-models-part-1" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">8</span> Spatial Models: Part 1<a href="spatial-models-part-1.html#spatial-models-part-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-6" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Introduction<a href="spatial-models-part-1.html#introduction-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="lecture-video-length-004147" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Lecture video (Length: 00:41:47)<a href="spatial-models-part-1.html#lecture-video-length-004147" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/llsnOzmJYH4" width="711" height="400" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p><a href="https://youtu.be/llsnOzmJYH4">[<strong>Watch on YouTube</strong>]</a></p>
</div>
<div id="computer-practical-video-length-020001-4" class="section level3 hasAnchor" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Computer practical video (Length: 02:00:01)<a href="spatial-models-part-1.html#computer-practical-video-length-020001-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/RnQkzPiPoSw" width="711" height="400" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p><a href="https://youtu.be/RnQkzPiPoSw">[<strong>Watch on YouTube</strong>]</a></p>
<p>This session builds on the techniques taught in week 3’s tutorials focused on spatial dependence &amp; spatial autocorrelation. Today, you will learn how to build spatially-based regression models for dealing with spatial autocorrelation whenever you want to determine relationship between an outcome and other independent variables. These are known as <strong>Spatial Lag</strong> or <strong>Spatial Error</strong> regression models.</p>
</div>
<div id="learning-objective" class="section level3 hasAnchor" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> Learning objective<a href="spatial-models-part-1.html#learning-objective" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this exercise we will be using London’s Lower Super Output Area (LSOA) data from 2015 pertained to house prices (as a dependent variable), and assessing it’s relationship with public transport accessibility (PTA), average income and socioeconomic deprivation (IMD) as independent variables while accounting for spatial autocorrelation.</p>
<p>We will implement three models:</p>
<ul>
<li>Multivariable linear regression</li>
<li>Spatial lag regression</li>
<li>Spatial error regression</li>
</ul>
</div>
<div id="datasets-setting-up-the-work-directory-5" class="section level3 hasAnchor" number="8.1.4">
<h3><span class="header-section-number">8.1.4</span> Datasets &amp; setting up the work directory<a href="spatial-models-part-1.html#datasets-setting-up-the-work-directory-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before you begin do make sure to download all data by <a href="https://github.com/UCLPG-MSC-SGDS/GEOG0114/raw/main/Week%209%20-%20Dataset.zip"><strong>clicking here</strong></a>. Create a folder on called “<strong>Week 9</strong>” within your “<strong>GEOG0114</strong>” folder stored in the desktop of your personal computer. Make sure to extract all data from the zip folder and store it into “<strong>Week 9</strong>” folder. Open a new R script and set the work directory to <strong>Week 9’s</strong> folder.</p>
<p>For Windows, the work directory will be:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="spatial-models-part-1.html#cb176-1" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;C:/Users/AccountName/Desktop/GEOG0114/Week 9&quot;</span>)</span></code></pre></div>
<p>For MAC, the work directory will be:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="spatial-models-part-1.html#cb177-1" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;/Users/AccountName/Desktop/GEOG0114/Week 9&quot;</span>)</span></code></pre></div>
</div>
<div id="loading-and-installing-packages-5" class="section level3 hasAnchor" number="8.1.5">
<h3><span class="header-section-number">8.1.5</span> Loading and installing packages<a href="spatial-models-part-1.html#loading-and-installing-packages-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will need to load the following packages:</p>
<ul>
<li><code>sf</code>: Simple Features</li>
<li><code>tmap</code>: Thematic Mapping</li>
<li><code>spdep</code>: Spatial Dependence (Weighting schemes &amp; Spatial Statistics)</li>
<li><code>sp</code>: Package for providing classes for spatial data (points, lines, polygons and grids)</li>
</ul>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="spatial-models-part-1.html#cb178-1" tabindex="-1"></a><span class="co"># Load packages using library() function</span></span>
<span id="cb178-2"><a href="spatial-models-part-1.html#cb178-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;sf&quot;</span>)</span>
<span id="cb178-3"><a href="spatial-models-part-1.html#cb178-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tmap&quot;</span>)</span>
<span id="cb178-4"><a href="spatial-models-part-1.html#cb178-4" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;spdep&quot;</span>)</span>
<span id="cb178-5"><a href="spatial-models-part-1.html#cb178-5" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;sp&quot;</span>)</span></code></pre></div>
<p>The above packages <code>sf</code>, <code>tmap</code>, <code>spdep</code> &amp; <code>sp</code> should have been installed in the previous session(s).</p>
<p>We will need to install the following packages:</p>
<ul>
<li><code>spatialreg</code>: provides functions for spatial regression modelling.</li>
</ul>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="spatial-models-part-1.html#cb179-1" tabindex="-1"></a><span class="co"># Install the packages: spatialreg using the install.package()</span></span>
<span id="cb179-2"><a href="spatial-models-part-1.html#cb179-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;spatialreg&quot;</span>)</span>
<span id="cb179-3"><a href="spatial-models-part-1.html#cb179-3" tabindex="-1"></a></span>
<span id="cb179-4"><a href="spatial-models-part-1.html#cb179-4" tabindex="-1"></a><span class="co"># Load the packages with library()</span></span>
<span id="cb179-5"><a href="spatial-models-part-1.html#cb179-5" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;spatialreg&quot;</span>)</span></code></pre></div>
</div>
<div id="loading-datasets-3" class="section level3 hasAnchor" number="8.1.6">
<h3><span class="header-section-number">8.1.6</span> Loading datasets<a href="spatial-models-part-1.html#loading-datasets-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let us first import the quantitative data i.e., <code>London LSOA 2015 data.csv</code> into R/RStudio.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="spatial-models-part-1.html#cb180-1" tabindex="-1"></a><span class="co"># Use read.csv() to import </span></span>
<span id="cb180-2"><a href="spatial-models-part-1.html#cb180-2" tabindex="-1"></a>datafile <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;London LSOA 2015 data.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>)</span></code></pre></div>
<p><strong>NOTE</strong>: The description of the column names are as follows:</p>
<table>
<colgroup>
<col width="48%" />
<col width="52%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Column Name</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>LSOACODE</code></td>
<td>Unique identification code for the geographic area</td>
</tr>
<tr class="even">
<td><code>AVEPRICE</code> (Dependent variable)</td>
<td>Average house price estimated for the LSOA in 2015</td>
</tr>
<tr class="odd">
<td><code>AVEINCOME</code></td>
<td>Estimated average annual income for households within an LSOA in 2015</td>
</tr>
<tr class="even">
<td><code>IMDSCORE</code></td>
<td>Deprivation score for an LSOA in 2015</td>
</tr>
<tr class="odd">
<td><code>PTAINDEX</code></td>
<td>Measures levels of access/connectivity to public transport</td>
</tr>
<tr class="even">
<td><code>PTACAT</code></td>
<td><code>PTAINDEX</code> rendered into a categorical variable</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>The above data were sourced from the <a href="https://data.london.gov.uk/dataset/"><strong>London DATASTORE</strong></a>. Next, we import the
shape files for London (i.e., LSOA- and Borough-level):</p>
<ul>
<li>London LSOA shape file: <code>London LSOA Areas.shp</code></li>
<li>London Borough shape file: <code>London Borough Areas.shp</code></li>
</ul>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="spatial-models-part-1.html#cb181-1" tabindex="-1"></a><span class="co"># Use read_sf() function to load shape file </span></span>
<span id="cb181-2"><a href="spatial-models-part-1.html#cb181-2" tabindex="-1"></a>LSOAshp <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">&quot;London LSOA Areas.shp&quot;</span>)</span>
<span id="cb181-3"><a href="spatial-models-part-1.html#cb181-3" tabindex="-1"></a>BOROUGHshp <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">&quot;London Borough Areas.shp&quot;</span>)</span></code></pre></div>
<p>The code chunk below generates an empty map with the <code>tmap</code> functions. It inspects the spatial configuration of London’s
LSOA with the Boroughs superimposed.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="spatial-models-part-1.html#cb182-1" tabindex="-1"></a><span class="co"># Generate an empty map to visualise the spatial configuration and hierarchy of LSOA and Boroughs</span></span>
<span id="cb182-2"><a href="spatial-models-part-1.html#cb182-2" tabindex="-1"></a><span class="co"># First add LSOA layer </span></span>
<span id="cb182-3"><a href="spatial-models-part-1.html#cb182-3" tabindex="-1"></a><span class="fu">tm_shape</span>(LSOAshp) <span class="sc">+</span> <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb182-4"><a href="spatial-models-part-1.html#cb182-4" tabindex="-1"></a><span class="co"># Add Borough layer on top of LSOA layer and make it transparent with alpha = 0</span></span>
<span id="cb182-5"><a href="spatial-models-part-1.html#cb182-5" tabindex="-1"></a><span class="fu">tm_shape</span>(BOROUGHshp) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">border.alpha =</span> <span class="dv">1</span>, <span class="at">border.col =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb182-6"><a href="spatial-models-part-1.html#cb182-6" tabindex="-1"></a><span class="co"># Apply cosmetics by adding compass and scale</span></span>
<span id="cb182-7"><a href="spatial-models-part-1.html#cb182-7" tabindex="-1"></a><span class="fu">tm_compass</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>)) <span class="sc">+</span> <span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>))</span></code></pre></div>
<p><img src="images/general/week10/Tab1-image1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="diagnostics-of-residuals" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Diagnostics of residuals<a href="spatial-models-part-1.html#diagnostics-of-residuals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="reporting-basic-summary-statistical-measures" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Reporting basic summary statistical measures<a href="spatial-models-part-1.html#reporting-basic-summary-statistical-measures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For any statistical &amp; spatial analysis its always useful to conduct some descriptive analysis of your dataset. You can
obtain basic summary measures using the <code>summary()</code> function which reports the overall result i.e., <strong>minimum</strong>, <strong>maximum</strong>, <strong>median</strong>, <strong>mean</strong>, <strong>25th</strong> and <strong>75th</strong> percentile values. For instance, we can report these estimates for the house price variable:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="spatial-models-part-1.html#cb183-1" tabindex="-1"></a><span class="fu">summary</span>(datafile<span class="sc">$</span>AVEPRICE)</span></code></pre></div>
<p>We can see that the mean price across the LSOAs is <code>£528,509</code> with ranges from <code>£133,997</code> to <code>£5,751,342</code>. You can also report the standard deviation across all LSOAs using the <code>sd()</code> function. As you can see the result is large and estimated as <code>±£418,842.5</code>.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="spatial-models-part-1.html#cb184-1" tabindex="-1"></a><span class="fu">sd</span>(datafile<span class="sc">$</span>AVEPRICE)</span></code></pre></div>
<div class="note">
<p><strong>NOTE</strong>: We have compiled some useful functions for reporting basic measures for descriptive analysis of the fly:</p>
<ul>
<li><code>min()</code>: minimum</li>
<li><code>max()</code>: maximum</li>
<li><code>mean()</code>: mean</li>
<li><code>median()</code>: median</li>
<li><code>sd()</code>: standard deviation</li>
</ul>
</div>
</div>
<div id="reporting-the-spatial-distribution-of-our-variables" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Reporting the spatial distribution of our variables<a href="spatial-models-part-1.html#reporting-the-spatial-distribution-of-our-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now lets examine the spatial distribution for the house price. First, the LSOA data is stored in <code>datafile</code> which is just a
data frame object. We need to merge this to the spatial object <code>LSOAshp</code> before using the <code>tmap</code> functions. Lets create a
new spatial data frame and name it <code>spatialdatafile</code></p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="spatial-models-part-1.html#cb185-1" tabindex="-1"></a><span class="co"># Merge datafile to LSOAshp uniquely by using &quot;LSOACODE column</span></span>
<span id="cb185-2"><a href="spatial-models-part-1.html#cb185-2" tabindex="-1"></a>spatialdatafile <span class="ot">&lt;-</span> <span class="fu">merge</span>(LSOAshp, datafile, <span class="at">by.x =</span> <span class="st">&quot;LSOACODE&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;LSOACODE&quot;</span>)</span></code></pre></div>
<p>Lets now generate our first map to inspect the distribution of house prices. We can actually store a picture as an image object called <code>plot1</code></p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="spatial-models-part-1.html#cb186-1" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(spatialdatafile) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">&quot;AVEPRICE&quot;</span>, <span class="at">style =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">n =</span> <span class="dv">7</span>, <span class="at">palette =</span> <span class="st">&quot;Greens&quot;</span>) <span class="sc">+</span></span>
<span id="cb186-2"><a href="spatial-models-part-1.html#cb186-2" tabindex="-1"></a><span class="fu">tm_shape</span>(BOROUGHshp) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">border.alpha =</span> <span class="dv">1</span>, <span class="at">border.col =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb186-3"><a href="spatial-models-part-1.html#cb186-3" tabindex="-1"></a><span class="fu">tm_text</span>(<span class="st">&quot;BOROUGHN&quot;</span>, <span class="at">size =</span> <span class="st">&quot;AREA&quot;</span>) <span class="sc">+</span></span>
<span id="cb186-4"><a href="spatial-models-part-1.html#cb186-4" tabindex="-1"></a><span class="fu">tm_compass</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>)) <span class="sc">+</span></span>
<span id="cb186-5"><a href="spatial-models-part-1.html#cb186-5" tabindex="-1"></a><span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb186-6"><a href="spatial-models-part-1.html#cb186-6" tabindex="-1"></a><span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">legend.title.size =</span> <span class="fl">0.5</span>, <span class="at">legend.text.size =</span> <span class="fl">0.5</span>)</span>
<span id="cb186-7"><a href="spatial-models-part-1.html#cb186-7" tabindex="-1"></a></span>
<span id="cb186-8"><a href="spatial-models-part-1.html#cb186-8" tabindex="-1"></a><span class="co"># plot the image object</span></span>
<span id="cb186-9"><a href="spatial-models-part-1.html#cb186-9" tabindex="-1"></a>plot1</span></code></pre></div>
<p><img src="images/general/week10/Tab2-image1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Descriptively, we can observe already an interesting pattern. LSOAs in parts of North, Central and the central West of Inner London tend to have high-priced properties on average exceeding <code>£758,000.00</code>, whereas in parts of Hillingdon, Enfield, Croydon, Bexley, Barking &amp; Dagenham have on average cheaper properties below <code>£273,000.00</code>. We need to take note that the patterns look clustered; however, this descriptive reporting is by no means an evidence-based analysis for assessing clustering or dispersion (i.e., spatial autocorrelation) - a Moran’s I test will be able to diagnosis this problem for house price but when other factors are involved we will need to use the residuals in the Moran’s I test.</p>
<p>Let us visualise three other variables which will subsequently be treated as independent variables in a regression to eyeball whether they are correlated with the house prices. Let us plot maps for income, deprivation and PAT (categories); and then stitch them together by invoking the <code>tmap_arrange()</code> function.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="spatial-models-part-1.html#cb187-1" tabindex="-1"></a><span class="co"># create 3 separate maps and store them in plot2, plot3 &amp; plot4 objects</span></span>
<span id="cb187-2"><a href="spatial-models-part-1.html#cb187-2" tabindex="-1"></a></span>
<span id="cb187-3"><a href="spatial-models-part-1.html#cb187-3" tabindex="-1"></a><span class="co"># map for income</span></span>
<span id="cb187-4"><a href="spatial-models-part-1.html#cb187-4" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(spatialdatafile) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">&quot;AVEINCOME&quot;</span>, <span class="at">style =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">n =</span> <span class="dv">7</span>, <span class="at">palette =</span> <span class="st">&quot;Oranges&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-5"><a href="spatial-models-part-1.html#cb187-5" tabindex="-1"></a>    <span class="fu">tm_shape</span>(BOROUGHshp) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">border.alpha =</span> <span class="dv">1</span>, <span class="at">border.col =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-6"><a href="spatial-models-part-1.html#cb187-6" tabindex="-1"></a>    <span class="fu">tm_text</span>(<span class="st">&quot;BOROUGHN&quot;</span>, <span class="at">size =</span> <span class="st">&quot;AREA&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-7"><a href="spatial-models-part-1.html#cb187-7" tabindex="-1"></a>    <span class="fu">tm_compass</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>)) <span class="sc">+</span></span>
<span id="cb187-8"><a href="spatial-models-part-1.html#cb187-8" tabindex="-1"></a>    <span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb187-9"><a href="spatial-models-part-1.html#cb187-9" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">legend.title.size =</span> <span class="fl">0.5</span>, <span class="at">legend.text.size =</span> <span class="fl">0.5</span>)</span>
<span id="cb187-10"><a href="spatial-models-part-1.html#cb187-10" tabindex="-1"></a></span>
<span id="cb187-11"><a href="spatial-models-part-1.html#cb187-11" tabindex="-1"></a><span class="co"># map for socioeconomic deprivation</span></span>
<span id="cb187-12"><a href="spatial-models-part-1.html#cb187-12" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(spatialdatafile) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">&quot;IMDSCORE&quot;</span>, <span class="at">style =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">n =</span> <span class="dv">7</span>, <span class="at">palette =</span> <span class="st">&quot;Reds&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-13"><a href="spatial-models-part-1.html#cb187-13" tabindex="-1"></a>    <span class="fu">tm_shape</span>(BOROUGHshp) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">border.alpha =</span> <span class="dv">1</span>, <span class="at">border.col =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-14"><a href="spatial-models-part-1.html#cb187-14" tabindex="-1"></a>    <span class="fu">tm_text</span>(<span class="st">&quot;BOROUGHN&quot;</span>, <span class="at">size =</span> <span class="st">&quot;AREA&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-15"><a href="spatial-models-part-1.html#cb187-15" tabindex="-1"></a>    <span class="fu">tm_compass</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>)) <span class="sc">+</span></span>
<span id="cb187-16"><a href="spatial-models-part-1.html#cb187-16" tabindex="-1"></a>    <span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb187-17"><a href="spatial-models-part-1.html#cb187-17" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">legend.title.size =</span> <span class="fl">0.5</span>, <span class="at">legend.text.size =</span> <span class="fl">0.5</span>)</span>
<span id="cb187-18"><a href="spatial-models-part-1.html#cb187-18" tabindex="-1"></a></span>
<span id="cb187-19"><a href="spatial-models-part-1.html#cb187-19" tabindex="-1"></a><span class="co"># map for public transport accessibility categories (PTACAT)</span></span>
<span id="cb187-20"><a href="spatial-models-part-1.html#cb187-20" tabindex="-1"></a>plot4 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(spatialdatafile) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">&quot;PTACAT&quot;</span>, <span class="at">style =</span> <span class="st">&quot;cat&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Blues&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-21"><a href="spatial-models-part-1.html#cb187-21" tabindex="-1"></a>    <span class="fu">tm_shape</span>(BOROUGHshp) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">border.alpha =</span> <span class="dv">1</span>, <span class="at">border.col =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-22"><a href="spatial-models-part-1.html#cb187-22" tabindex="-1"></a>    <span class="fu">tm_text</span>(<span class="st">&quot;BOROUGHN&quot;</span>, <span class="at">size =</span> <span class="st">&quot;AREA&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-23"><a href="spatial-models-part-1.html#cb187-23" tabindex="-1"></a>    <span class="fu">tm_compass</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>)) <span class="sc">+</span></span>
<span id="cb187-24"><a href="spatial-models-part-1.html#cb187-24" tabindex="-1"></a>    <span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb187-25"><a href="spatial-models-part-1.html#cb187-25" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">legend.title.size =</span> <span class="fl">0.5</span>, <span class="at">legend.text.size =</span> <span class="fl">0.5</span>)</span>
<span id="cb187-26"><a href="spatial-models-part-1.html#cb187-26" tabindex="-1"></a></span>
<span id="cb187-27"><a href="spatial-models-part-1.html#cb187-27" tabindex="-1"></a><span class="co"># stitch the maps together using tmap_arrange() function</span></span>
<span id="cb187-28"><a href="spatial-models-part-1.html#cb187-28" tabindex="-1"></a><span class="fu">tmap_arrange</span>(plot1, plot2, plot3, plot4, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="images/general/week10/Tab2-image2.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Visually, the income appears to be strongly correlated with house price. The patterns for socioeconomic deprivation on the
other hand appears to have a negative correlation with house price. PTAs relationship is unclear.</p>
</div>
<div id="fitting-a-non-spatial-linear-regression-on-spatial-data-checking-the-residuals" class="section level3 hasAnchor" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> Fitting a non-spatial Linear Regression on spatial data &amp; checking the residuals<a href="spatial-models-part-1.html#fitting-a-non-spatial-linear-regression-on-spatial-data-checking-the-residuals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, we are going to fit a linear regression where the response variable is <code>AVEPRICE</code> and the predictors are <code>AVEINCOME</code>,
<code>IMDSCORE</code> and <code>PTACAT</code>, and then extract the residuals from the model in order to test for spatial autocorrelation. When fitting a linear regression - we must test that the residuals have the following properties:</p>
<ul>
<li>The residuals should exhibit a normal distribution.</li>
<li>Residuals must be homoscedasticity and exhibit a constant random when plotted against the fitted prediction</li>
<li>The residual should not deviate too much away from the index line in the <code>QQ-plot</code>.</li>
</ul>
<div class="note">
<p><strong>IMPORTANT NOTEs:</strong>: Things that can violate the above requirements are:</p>
<ul>
<li>A skewed variable. It is best to transform using the <code>log10()</code> function, or in any scale that’s justifiable to normalise it. if your data is skewed then do a transformation in the models since only care about the residuals. Note that there is no right or wrong when it comes to implementing the transformation, as long as the assumption for the residuals from a linear regression are not violated then all is fine.</li>
<li>If one of these characteristics are violated then its an indication that the data are not independent. This could possibly be due to some data artefact (i.e., a critical error in the data itself), or the residuals being correlated with each other.</li>
<li>Presence of collinearity between residual points. Here, we should check first by mapping the residuals on a map to examine it’s spatial patterns for clustering and testing it with the Moran’s I test.</li>
</ul>
</div>
<p>Let’s demonstrate by using the built-in function <code>lm()</code> to create a simple linear or multivariable linear regression.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="spatial-models-part-1.html#cb188-1" tabindex="-1"></a><span class="co"># lm() function builds a regression model and stores model output into the object &#39;modelMLR&#39;</span></span>
<span id="cb188-2"><a href="spatial-models-part-1.html#cb188-2" tabindex="-1"></a>modelMLR <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log10</span>(AVEPRICE) <span class="sc">~</span> <span class="fu">log10</span>(AVEINCOME) <span class="sc">+</span> <span class="fu">log10</span>(IMDSCORE) <span class="sc">+</span> <span class="fu">log10</span>(PTAINDEX), <span class="at">data =</span> spatialdatafile)</span>
<span id="cb188-3"><a href="spatial-models-part-1.html#cb188-3" tabindex="-1"></a><span class="co"># Include the &#39;scipen=7&#39; argument in the summary() function remove those annoying scientific notation!</span></span>
<span id="cb188-4"><a href="spatial-models-part-1.html#cb188-4" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">7</span>)</span>
<span id="cb188-5"><a href="spatial-models-part-1.html#cb188-5" tabindex="-1"></a><span class="co"># summary() calls report the output stored in object &#39;modelMLR&#39;</span></span>
<span id="cb188-6"><a href="spatial-models-part-1.html#cb188-6" tabindex="-1"></a><span class="fu">summary</span>(modelMLR)</span></code></pre></div>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="spatial-models-part-1.html#cb189-1" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb189-2"><a href="spatial-models-part-1.html#cb189-2" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> <span class="fu">log10</span>(AVEPRICE) <span class="sc">~</span> <span class="fu">log10</span>(IMDSCORE) <span class="sc">+</span> <span class="fu">log10</span>(AVEINCOME) <span class="sc">+</span> </span>
<span id="cb189-3"><a href="spatial-models-part-1.html#cb189-3" tabindex="-1"></a>    <span class="fu">log10</span>(PTAINDEX), <span class="at">data =</span> spatialdatafile)</span>
<span id="cb189-4"><a href="spatial-models-part-1.html#cb189-4" tabindex="-1"></a></span>
<span id="cb189-5"><a href="spatial-models-part-1.html#cb189-5" tabindex="-1"></a>Residuals<span class="sc">:</span></span>
<span id="cb189-6"><a href="spatial-models-part-1.html#cb189-6" tabindex="-1"></a>     Min       1Q   Median       3Q      Max </span>
<span id="cb189-7"><a href="spatial-models-part-1.html#cb189-7" tabindex="-1"></a><span class="sc">-</span><span class="fl">0.39249</span> <span class="sc">-</span><span class="fl">0.06489</span> <span class="sc">-</span><span class="fl">0.00572</span>  <span class="fl">0.06046</span>  <span class="fl">0.62993</span> </span>
<span id="cb189-8"><a href="spatial-models-part-1.html#cb189-8" tabindex="-1"></a></span>
<span id="cb189-9"><a href="spatial-models-part-1.html#cb189-9" tabindex="-1"></a>Coefficients<span class="sc">:</span></span>
<span id="cb189-10"><a href="spatial-models-part-1.html#cb189-10" tabindex="-1"></a>                  Estimate Std. Error t value       <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>t<span class="sc">|</span>)    </span>
<span id="cb189-11"><a href="spatial-models-part-1.html#cb189-11" tabindex="-1"></a>(Intercept)      <span class="sc">-</span><span class="fl">4.100992</span>   <span class="fl">0.095592</span> <span class="sc">-</span><span class="fl">42.901</span>        <span class="sc">&lt;</span> <span class="fl">2e-16</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb189-12"><a href="spatial-models-part-1.html#cb189-12" tabindex="-1"></a><span class="fu">log10</span>(IMDSCORE)   <span class="fl">0.136713</span>   <span class="fl">0.007681</span>  <span class="fl">17.798</span>        <span class="sc">&lt;</span> <span class="fl">2e-16</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb189-13"><a href="spatial-models-part-1.html#cb189-13" tabindex="-1"></a><span class="fu">log10</span>(AVEINCOME)  <span class="fl">2.036354</span>   <span class="fl">0.019340</span> <span class="fl">105.292</span>        <span class="sc">&lt;</span> <span class="fl">2e-16</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb189-14"><a href="spatial-models-part-1.html#cb189-14" tabindex="-1"></a><span class="fu">log10</span>(PTAINDEX)   <span class="fl">0.030055</span>   <span class="fl">0.004816</span>   <span class="fl">6.241</span> <span class="fl">0.000000000471</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb189-15"><a href="spatial-models-part-1.html#cb189-15" tabindex="-1"></a><span class="sc">---</span></span>
<span id="cb189-16"><a href="spatial-models-part-1.html#cb189-16" tabindex="-1"></a>Signif. codes<span class="sc">:</span>  <span class="dv">0</span> ‘<span class="sc">**</span><span class="er">*</span>’ <span class="fl">0.001</span> ‘<span class="sc">**</span>’ <span class="fl">0.01</span> ‘<span class="sc">*</span>’ <span class="fl">0.05</span> ‘.’ <span class="fl">0.1</span> ‘ ’ <span class="dv">1</span></span>
<span id="cb189-17"><a href="spatial-models-part-1.html#cb189-17" tabindex="-1"></a></span>
<span id="cb189-18"><a href="spatial-models-part-1.html#cb189-18" tabindex="-1"></a>Residual standard error<span class="sc">:</span> <span class="fl">0.1027</span> on <span class="dv">4964</span> degrees of freedom</span>
<span id="cb189-19"><a href="spatial-models-part-1.html#cb189-19" tabindex="-1"></a>Multiple R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.789</span>, Adjusted R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.7889</span> </span>
<span id="cb189-20"><a href="spatial-models-part-1.html#cb189-20" tabindex="-1"></a>F<span class="sc">-</span>statistic<span class="sc">:</span>  <span class="dv">6189</span> on <span class="dv">3</span> and <span class="dv">4964</span> DF,  p<span class="sc">-</span>value<span class="sc">:</span> <span class="er">&lt;</span> <span class="fl">2.2e-16</span></span></code></pre></div>
<div class="note">
<p><strong>IMPORTANT NOTES:</strong> The above results presented in the above table indicates the relationship between the dependent and independent variable. Under the column for <code>Estimate</code> reports the overall intercept and coefficients for each independent variable. The p-values for the estimates are reported under the column <code>Pr(&gt;|t|)</code> which determines whether the relationship between the dependent and independent variables are statistically significant or not.</p>
</div>
<p>Lastly, the other two important pieces of information is the <code>Adjusted R-Squared</code> value and the model’s <code>p-value</code> at the bottom. These tells us the performance of the model in general. The former tells you the percentage of variation explained in the house price when including <code>AVEINCOME</code>, <code>IMDSCORE</code>, <code>PTAINDEX</code> in the regression, while the latter informs us whether if this is significant or not.</p>
<p><strong>HOW TO INTERPRET RESULTS:</strong> This is how we fully interpret the coefficients and model performance from the above table:</p>
<ul>
<li>On a log transformed scale, if the <code>AVEINCOME</code> was to increase by <code>1.0%</code>, we expect the house prices to increase by
<code>2.04%</code> and this average increase is statistically significant since the p-value = <code>0.00000000002</code> &lt;<code>0.05</code>.</li>
<li>On a log transformed scale, if the <code>PTAINDEX</code> was to increase by <code>1.0%</code>, we expect the house prices to increase marginally
by <code>0.03%</code>. The marginally increase is statistically significant since the p-value = <code>0.000000000471</code> &lt; <code>0.05</code>.</li>
<li>On a log transformed scale, if the <code>IMDSCORE</code> was to increase by <code>1.0%</code>, we expect the house prices to increase marginally by <code>0.13%</code> and this average increase is statistically significant since the p-value = <code>0.00000000002</code> &lt;<code>0.05</code>.</li>
<li>In terms of model performance: according to the <code>Adjusted R-Squared</code> value <code>0.7889 (78.89%)</code> of the variation in the house
prices across LSOAs were explained by the model after accounting for <code>AVEINCOME</code>, <code>IMDSCORE</code>, <code>PTAINDEX</code>. Since the <code>Adjusted R-Squared</code> more than <code>50.0%</code> it is hence a very good model and significant (i.e., p-value = <code>0.0000000002</code> &lt; <code>0.05</code>).</li>
</ul>
<p>Now that we have fitted the model, we can extract the residuals and insert them as a new column into the <code>spatialdatafile</code>.
To perform this action, use the <code>modelMLR</code> object and extract the residuals output from it.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="spatial-models-part-1.html#cb190-1" tabindex="-1"></a><span class="co"># Extract residuals from &quot;modelLMR&quot; object and dump into &quot;spatialdatafile&quot; and call the column &quot;RESIDUALS&quot;</span></span>
<span id="cb190-2"><a href="spatial-models-part-1.html#cb190-2" tabindex="-1"></a>spatialdatafile<span class="sc">$</span>RESIDUALS <span class="ot">&lt;-</span> modelMLR<span class="sc">$</span>residuals</span>
<span id="cb190-3"><a href="spatial-models-part-1.html#cb190-3" tabindex="-1"></a></span>
<span id="cb190-4"><a href="spatial-models-part-1.html#cb190-4" tabindex="-1"></a><span class="co"># Reporting basic summary measures to have an idea of its distribution before plotting them on map</span></span>
<span id="cb190-5"><a href="spatial-models-part-1.html#cb190-5" tabindex="-1"></a><span class="fu">summary</span>(spatialdatafile<span class="sc">$</span>RESIDUALS)</span></code></pre></div>
<p>Let us generate a map to examine if these residuals show patterns of spatial autocorrelation. We have divergent values for
the legends (i.e., negative and positive value) therefore it best to specify in the <code>tm_fill()</code> function that <code>style = "cont"</code> and the <code>midpoint = 0</code>, and a divergent colour scheme e.g. Reds to Blue (<code>-RdBu</code>).</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="spatial-models-part-1.html#cb191-1" tabindex="-1"></a><span class="fu">tm_shape</span>(spatialdatafile) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">&quot;RESIDUALS&quot;</span>, <span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">palette =</span> <span class="st">&quot;-RdBu&quot;</span>) <span class="sc">+</span></span>
<span id="cb191-2"><a href="spatial-models-part-1.html#cb191-2" tabindex="-1"></a><span class="fu">tm_shape</span>(BOROUGHshp) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">border.alpha =</span> <span class="dv">1</span>, <span class="at">border.col =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb191-3"><a href="spatial-models-part-1.html#cb191-3" tabindex="-1"></a><span class="fu">tm_text</span>(<span class="st">&quot;BOROUGHN&quot;</span>, <span class="at">size =</span> <span class="st">&quot;AREA&quot;</span>) <span class="sc">+</span></span>
<span id="cb191-4"><a href="spatial-models-part-1.html#cb191-4" tabindex="-1"></a><span class="fu">tm_compass</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>)) <span class="sc">+</span></span>
<span id="cb191-5"><a href="spatial-models-part-1.html#cb191-5" tabindex="-1"></a><span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb191-6"><a href="spatial-models-part-1.html#cb191-6" tabindex="-1"></a><span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">legend.title.size =</span> <span class="fl">0.5</span>, <span class="at">legend.text.size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="images/general/week10/Tab2-image3.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Notice the spatial patterning and clusters of the LSOAs and the over-prediction (i.e., areas that have negative residuals,
or blue tones) and under-prediction (i.e., areas that positive residuals, or red tones). This visual inspection of the
residuals is telling you that spatial autocorrelation may be present here. This, however, would require a more formal test.</p>
<p>Now, let’s use the Moran’s I test to confirm the presence of spatial autocorrelation. Recall week 3’s lectures and computer labs session on spatial autocorrleation? Here, we create the spatial adjacency matrix and apply the Moran’s I test on the <code>modelMLR</code> object using the <code>lm.morantest()</code> function.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="spatial-models-part-1.html#cb192-1" tabindex="-1"></a><span class="co">#generate unique number for each row</span></span>
<span id="cb192-2"><a href="spatial-models-part-1.html#cb192-2" tabindex="-1"></a>spatialdatafile<span class="sc">$</span>ROWNUM <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(spatialdatafile)</span>
<span id="cb192-3"><a href="spatial-models-part-1.html#cb192-3" tabindex="-1"></a><span class="co"># We need to coerce the sf spatialdatafile object into a new sp object</span></span>
<span id="cb192-4"><a href="spatial-models-part-1.html#cb192-4" tabindex="-1"></a>spatialdatafile_2<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">as</span>(spatialdatafile, <span class="st">&quot;Spatial&quot;</span>)</span>
<span id="cb192-5"><a href="spatial-models-part-1.html#cb192-5" tabindex="-1"></a><span class="co"># Create spatial weights matrix for areas</span></span>
<span id="cb192-6"><a href="spatial-models-part-1.html#cb192-6" tabindex="-1"></a>Weights <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(spatialdatafile_2<span class="fl">.0</span>, <span class="at">row.names =</span> spatialdatafile_2<span class="fl">.0</span><span class="sc">$</span>ROWNUM)</span>
<span id="cb192-7"><a href="spatial-models-part-1.html#cb192-7" tabindex="-1"></a>WeightsMatrix <span class="ot">&lt;-</span> <span class="fu">nb2mat</span>(Weights, <span class="at">style=</span><span class="st">&#39;B&#39;</span>)</span>
<span id="cb192-8"><a href="spatial-models-part-1.html#cb192-8" tabindex="-1"></a>Residual_WeightMatrix <span class="ot">&lt;-</span> <span class="fu">mat2listw</span>(WeightsMatrix , <span class="at">style=</span><span class="st">&#39;W&#39;</span>)</span>
<span id="cb192-9"><a href="spatial-models-part-1.html#cb192-9" tabindex="-1"></a><span class="co"># Run the test on the regression model output object &quot;modelMLR&quot; using lm.morantest()</span></span>
<span id="cb192-10"><a href="spatial-models-part-1.html#cb192-10" tabindex="-1"></a><span class="fu">lm.morantest</span>(modelMLR, Residual_WeightMatrix, <span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="spatial-models-part-1.html#cb193-1" tabindex="-1"></a>Global Moran I <span class="cf">for</span> regression residuals</span>
<span id="cb193-2"><a href="spatial-models-part-1.html#cb193-2" tabindex="-1"></a></span>
<span id="cb193-3"><a href="spatial-models-part-1.html#cb193-3" tabindex="-1"></a>data<span class="sc">:</span>  </span>
<span id="cb193-4"><a href="spatial-models-part-1.html#cb193-4" tabindex="-1"></a>model<span class="sc">:</span> <span class="fu">lm</span>(<span class="at">formula =</span> <span class="fu">log10</span>(AVEPRICE) <span class="sc">~</span> <span class="fu">log10</span>(IMDSCORE) <span class="sc">+</span> <span class="fu">log10</span>(AVEINCOME) <span class="sc">+</span> <span class="fu">log10</span>(PTAINDEX), <span class="at">data =</span> spatialdatafile)</span>
<span id="cb193-5"><a href="spatial-models-part-1.html#cb193-5" tabindex="-1"></a>weights<span class="sc">:</span> Residual_WeightMatrix</span>
<span id="cb193-6"><a href="spatial-models-part-1.html#cb193-6" tabindex="-1"></a></span>
<span id="cb193-7"><a href="spatial-models-part-1.html#cb193-7" tabindex="-1"></a>Moran I statistic standard deviate <span class="ot">=</span> <span class="fl">56.28</span>, p<span class="sc">-</span>value <span class="sc">&lt;</span> <span class="fl">2.2e-16</span></span>
<span id="cb193-8"><a href="spatial-models-part-1.html#cb193-8" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> two.sided</span>
<span id="cb193-9"><a href="spatial-models-part-1.html#cb193-9" tabindex="-1"></a>sample estimates<span class="sc">:</span></span>
<span id="cb193-10"><a href="spatial-models-part-1.html#cb193-10" tabindex="-1"></a>Observed Moran I      Expectation         Variance </span>
<span id="cb193-11"><a href="spatial-models-part-1.html#cb193-11" tabindex="-1"></a>   <span class="fl">0.47489527088</span>   <span class="sc">-</span><span class="fl">0.00060260241</span>    <span class="fl">0.00007138138</span> </span></code></pre></div>
<p>You will notice we obtained a statistically significant value (i.e., p-value &lt;<code>0.001</code>) for Moran’s I of value = <code>0.475</code>. The value of the Moran’s I test somewhat high. This is an indication that the errors (the residuals) are somewhat related to each other and thus not independent. A spatial regression would be much appropriate for modelling this type of data since there’s evidence of spatial autocorrelation.</p>
</div>
</div>
<div id="spatial-regression-models" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Spatial Regression Models<a href="spatial-models-part-1.html#spatial-regression-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="model-formation-for-spatial-lag-or-error-models" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Model formation for spatial lag or error models<a href="spatial-models-part-1.html#model-formation-for-spatial-lag-or-error-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>At this point, we will introduce two kinds of spatial regressions models that can address the issues of spatial autocorrelation. These models are similar in a sense that they all require the inclusion of a spatial weight matrix to account for the spatial configuration of the areas under investigation.</p>
<ul>
<li>Spatial Lag Model lagged on the dependent variable</li>
<li>Spatial Error Model</li>
</ul>
<p>Previously, we fitted a linear regression model that’s non-spatial, which takes the mathematical formula as follows:</p>
<center>
<span class="math display">\[y = \beta_{0} + x_{1}\beta_{1} + x_{2}\beta_{2} + ... +\epsilon\]</span>
</center>
<p>Here, <span class="math inline">\(y\)</span> is the response variable (i.e., <code>AVEPRICE</code>). The <span class="math inline">\(x_{1}\)</span>, <span class="math inline">\(x_{2}\)</span>., etc., are the independent variables (i.e,
<span class="math inline">\(x_{1}\)</span>, <span class="math inline">\(x_{2}\)</span> &amp; <span class="math inline">\(x_{3}\)</span> are <code>AVEINCOME</code>, <code>IMDSCORE</code> and <code>PTAINDEX</code> respectively). <span class="math inline">\(\beta_{1}\)</span>, <span class="math inline">\(\beta_{2}\)</span>., etc., are
the estimated coefficients for the independent variables. The <span class="math inline">\(\epsilon\)</span> represents the uncorrelated error term.</p>
<p>To make this a <strong>Spatial Lag Model</strong> lagged on the <strong>dependent variable</strong>, we tweak the above equation by including the spatial weight matrix <span class="math inline">\(W\)</span> which is multiplied by the dependent variable <span class="math inline">\(y\)</span>. This product will have an estimated coefficient termed <span class="math inline">\(\rho\)</span>. The <span class="math inline">\(\rho\)</span> parameter tells us the degree at which our observed outcome inside the study area of interest is influenced by outcomes measured from its neighbours. It’s model formulation is below:</p>
<center>
<span class="math display">\[y = \rho Wy + \beta_{0} + x_{1}\beta_{1} + x_{2}\beta_{2} + ... +\epsilon\]</span>
</center>
<p>The <strong>Spatial Error Model</strong>, on the other hand, incorporates spatial weight matrix <span class="math inline">\(W\)</span> into the error term, where <span class="math inline">\(\lambda\)</span> is an estimated coefficient for the product between <span class="math inline">\(W\)</span> and <span class="math inline">\(u\)</span>, which <span class="math inline">\(u\)</span> is a correlated spatial error term. It’s model formulation is below:</p>
<center>
<span class="math display">\[y =  + \beta_{0} + x_{1}\beta_{1} + x_{2}\beta_{2} + ...+ \lambda Wu +\epsilon\]</span>
</center>
<p>Here, we show you how to implement these two commonly used models to see which one better address the issue of spatial autocorrelation. But there are some important points:</p>
<ul>
<li>When implementing these models, we want to ensure that the spatial autocorrelation are accounted for, and therefore, we
have to perform the Moran’s I test again. Here, we want to make sure that it is lower than what we observed for the linear regression model.</li>
<li>We want to also compare the spatial model against the non-spatial model by checking the AIC values, the one with lowest is the better model.</li>
<li>Previously, we were able to interpret the coefficients for the linear regression model. For the spatial models however,
the coefficients derived from the model lagged on the dependent variable are difficult to interpret. Therefore, we have to
estimate a quantity called <code>impacts</code> which we will use in the interpretation. <strong>This step is the most crucial part which must be done</strong></li>
</ul>
</div>
<div id="spatial-lag-model-lagged-on-the-dependent-variable" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Spatial Lag Model lagged on the dependent variable<a href="spatial-models-part-1.html#spatial-lag-model-lagged-on-the-dependent-variable" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A Spatial Lag Model on the dependent variable assumes that dependencies exist directly among the levels of the dependent variable. That is, the observed outcome in one primary location is affected by other outcomes in nearby or neighbouring locations. For instance, if we implement this model on the LSOA house price, we are assuming that the property prices in one LSOA is impacted by the property prices from nearby neighbouring LSOAs.</p>
<p>We can perform this analysis in four steps:</p>
<ul>
<li>Step 1: Fit the Spatial Lag Model with the dependent variable lagged using the <code>lagsarlm()</code> function.</li>
<li>Step 2: Use the <code>summary()</code> function to report the results. Here, we are interested in the <span class="math inline">\(\rho\)</span> parameter &amp;
its p-value. Here, we also want to check if the model is appropriate than a non-spatial model - examine the AIC (for lag versus LM)
and the one with the lowest AIC is the better model.</li>
<li>Step 3: Extract the residual lags for the model object and carry out a Moran’s I test using <code>moran.mc()</code> to ensure that the statistic is less than what was obtained for the Moran’s I test for the linear model. Use the <code>tmap</code> to examine its spatial patterning.</li>
<li>Step 4: Interpretation of the parameters using the <code>impact()</code> function</li>
</ul>
<p><strong>STEP ONE</strong></p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="spatial-models-part-1.html#cb194-1" tabindex="-1"></a><span class="co"># Fit model using lagsarlm()</span></span>
<span id="cb194-2"><a href="spatial-models-part-1.html#cb194-2" tabindex="-1"></a><span class="co"># reuse spatial weight matrix created earlier as an object called &quot;Residual_WeighMatrix&quot; </span></span>
<span id="cb194-3"><a href="spatial-models-part-1.html#cb194-3" tabindex="-1"></a>modelSLY <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(<span class="fu">log10</span>(AVEPRICE) <span class="sc">~</span> <span class="fu">log10</span>(IMDSCORE) <span class="sc">+</span> <span class="fu">log10</span>(AVEINCOME) <span class="sc">+</span> <span class="fu">log10</span>(PTAINDEX), <span class="at">data =</span> spatialdatafile_2<span class="fl">.0</span>, Residual_WeightMatrix)</span></code></pre></div>
<p><strong>STEP TWO</strong></p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="spatial-models-part-1.html#cb195-1" tabindex="-1"></a><span class="co"># Report results with summary()</span></span>
<span id="cb195-2"><a href="spatial-models-part-1.html#cb195-2" tabindex="-1"></a><span class="co"># We are interested in the rho-coefficient, log-likelihood ratio test&#39;s p-value and the AIC</span></span>
<span id="cb195-3"><a href="spatial-models-part-1.html#cb195-3" tabindex="-1"></a><span class="fu">summary</span>(modelSLY)</span></code></pre></div>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="spatial-models-part-1.html#cb196-1" tabindex="-1"></a>Call<span class="sc">:</span><span class="fu">lagsarlm</span>(<span class="at">formula =</span> <span class="fu">log10</span>(AVEPRICE) <span class="sc">~</span> <span class="fu">log10</span>(IMDSCORE) <span class="sc">+</span> <span class="fu">log10</span>(AVEINCOME) <span class="sc">+</span> </span>
<span id="cb196-2"><a href="spatial-models-part-1.html#cb196-2" tabindex="-1"></a>    <span class="fu">log10</span>(PTAINDEX), <span class="at">data =</span> spatialdatafile, <span class="at">listw =</span> Residual_WeightMatrix)</span>
<span id="cb196-3"><a href="spatial-models-part-1.html#cb196-3" tabindex="-1"></a></span>
<span id="cb196-4"><a href="spatial-models-part-1.html#cb196-4" tabindex="-1"></a>Residuals<span class="sc">:</span></span>
<span id="cb196-5"><a href="spatial-models-part-1.html#cb196-5" tabindex="-1"></a>       Min         1Q     Median         3Q        Max </span>
<span id="cb196-6"><a href="spatial-models-part-1.html#cb196-6" tabindex="-1"></a><span class="sc">-</span><span class="fl">0.3608275</span> <span class="sc">-</span><span class="fl">0.0540603</span> <span class="sc">-</span><span class="fl">0.0039772</span>  <span class="fl">0.0518209</span>  <span class="fl">0.6492007</span> </span>
<span id="cb196-7"><a href="spatial-models-part-1.html#cb196-7" tabindex="-1"></a></span>
<span id="cb196-8"><a href="spatial-models-part-1.html#cb196-8" tabindex="-1"></a>Type<span class="sc">:</span> lag </span>
<span id="cb196-9"><a href="spatial-models-part-1.html#cb196-9" tabindex="-1"></a>Coefficients<span class="sc">:</span> (asymptotic standard errors) </span>
<span id="cb196-10"><a href="spatial-models-part-1.html#cb196-10" tabindex="-1"></a>                   Estimate Std. Error  z value        <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>)</span>
<span id="cb196-11"><a href="spatial-models-part-1.html#cb196-11" tabindex="-1"></a>(Intercept)      <span class="sc">-</span><span class="fl">2.6649683</span>  <span class="fl">0.0924917</span> <span class="sc">-</span><span class="fl">28.8130</span>       <span class="sc">&lt;</span> <span class="fl">2.2e-16</span></span>
<span id="cb196-12"><a href="spatial-models-part-1.html#cb196-12" tabindex="-1"></a><span class="fu">log10</span>(IMDSCORE)   <span class="fl">0.0435882</span>  <span class="fl">0.0068588</span>   <span class="fl">6.3551</span> <span class="fl">0.0000000002083</span></span>
<span id="cb196-13"><a href="spatial-models-part-1.html#cb196-13" tabindex="-1"></a><span class="fu">log10</span>(AVEINCOME)  <span class="fl">1.2144821</span>  <span class="fl">0.0286833</span>  <span class="fl">42.3412</span>       <span class="sc">&lt;</span> <span class="fl">2.2e-16</span></span>
<span id="cb196-14"><a href="spatial-models-part-1.html#cb196-14" tabindex="-1"></a><span class="fu">log10</span>(PTAINDEX)   <span class="fl">0.0106795</span>  <span class="fl">0.0041275</span>   <span class="fl">2.5874</span>        <span class="fl">0.009671</span></span>
<span id="cb196-15"><a href="spatial-models-part-1.html#cb196-15" tabindex="-1"></a></span>
<span id="cb196-16"><a href="spatial-models-part-1.html#cb196-16" tabindex="-1"></a>Rho<span class="sc">:</span> <span class="fl">0.4522</span>, LR test value<span class="sc">:</span> <span class="fl">1354.5</span>, p<span class="sc">-</span>value<span class="sc">:</span> <span class="er">&lt;</span> <span class="fl">2.22e-16</span></span>
<span id="cb196-17"><a href="spatial-models-part-1.html#cb196-17" tabindex="-1"></a>Asymptotic standard error<span class="sc">:</span> <span class="fl">0.012282</span></span>
<span id="cb196-18"><a href="spatial-models-part-1.html#cb196-18" tabindex="-1"></a>    z<span class="sc">-</span>value<span class="sc">:</span> <span class="fl">36.819</span>, p<span class="sc">-</span>value<span class="sc">:</span> <span class="er">&lt;</span> <span class="fl">2.22e-16</span></span>
<span id="cb196-19"><a href="spatial-models-part-1.html#cb196-19" tabindex="-1"></a>Wald statistic<span class="sc">:</span> <span class="fl">1355.6</span>, p<span class="sc">-</span>value<span class="sc">:</span> <span class="er">&lt;</span> <span class="fl">2.22e-16</span></span>
<span id="cb196-20"><a href="spatial-models-part-1.html#cb196-20" tabindex="-1"></a></span>
<span id="cb196-21"><a href="spatial-models-part-1.html#cb196-21" tabindex="-1"></a>Log likelihood<span class="sc">:</span> <span class="fl">4937.637</span> <span class="cf">for</span> lag model</span>
<span id="cb196-22"><a href="spatial-models-part-1.html#cb196-22" tabindex="-1"></a>ML residual <span class="fu">variance</span> (sigma squared)<span class="sc">:</span> <span class="fl">0.0077091</span>, (sigma<span class="sc">:</span> <span class="fl">0.087801</span>)</span>
<span id="cb196-23"><a href="spatial-models-part-1.html#cb196-23" tabindex="-1"></a>Number of observations<span class="sc">:</span> <span class="dv">4968</span> </span>
<span id="cb196-24"><a href="spatial-models-part-1.html#cb196-24" tabindex="-1"></a>Number of parameters estimated<span class="sc">:</span> <span class="dv">6</span> </span>
<span id="cb196-25"><a href="spatial-models-part-1.html#cb196-25" tabindex="-1"></a>AIC<span class="sc">:</span> <span class="sc">-</span><span class="fl">9863.3</span>, (AIC <span class="cf">for</span> lm<span class="sc">:</span> <span class="sc">-</span><span class="fl">8510.8</span>)</span>
<span id="cb196-26"><a href="spatial-models-part-1.html#cb196-26" tabindex="-1"></a>LM test <span class="cf">for</span> residual autocorrelation</span>
<span id="cb196-27"><a href="spatial-models-part-1.html#cb196-27" tabindex="-1"></a>test value<span class="sc">:</span> <span class="fl">443.54</span>, p<span class="sc">-</span>value<span class="sc">:</span> <span class="er">&lt;</span> <span class="fl">2.22e-16</span></span></code></pre></div>
<div class="note">
<p><strong>INTERPRETATION</strong>: The <span class="math inline">\(\rho\)</span> statistic informs us of how the neighbouring LSOA house price values affect the house price at <span class="math inline">\(y\)</span>. The <span class="math inline">\(\rho\)</span> value is a positive value of <code>0.4522</code> which means the neighbouring LSOAs affect is a positive manner, and it is statistically significant (i.e., p-value &lt; <code>0.05</code>). We can see the AIC for the lag model is lower than the original linear regression model (i.e., Lag: <code>-9863.3</code> vs LM: <code>-8510.8</code>) therefore the lag model is okay.</p>
</div>
<div class="note">
<p><strong>IMPORTANT NOTE</strong>: In a lag model, do not even try to interpret the coefficients for the independent variables - ignore them and their p-values… they are nonsense! Why? This is because there is a global feedback effect happening here - i.e., whenever we change something in our own region (i.e., LSOA) for instance, like the <code>AVEINCOME</code> in a LSOA, that will not only affect our own house price, but when it causes the house price to go up in its own area, this in turn will cause the house prices to increase in its neighbour’s area; and when the neighbour’s house price go up - it is again going to affect our house price… so its an infinite loop. Instead, we interpret the result churn out from the <code>impact</code> function which reports their <code>direct</code> and <code>indirect</code> effects.</p>
</div>
<p><strong>STEP THREE</strong></p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="spatial-models-part-1.html#cb197-1" tabindex="-1"></a><span class="co"># extract the residuals for modelSLY object and dump back to original sf spatialdatafile object</span></span>
<span id="cb197-2"><a href="spatial-models-part-1.html#cb197-2" tabindex="-1"></a>spatialdatafile<span class="sc">$</span>RESID_SLY <span class="ot">&lt;-</span> modelSLY<span class="sc">$</span>residuals</span>
<span id="cb197-3"><a href="spatial-models-part-1.html#cb197-3" tabindex="-1"></a><span class="co"># use Moran&#39;s I test using moran.mc() function</span></span>
<span id="cb197-4"><a href="spatial-models-part-1.html#cb197-4" tabindex="-1"></a><span class="fu">moran.mc</span>(spatialdatafile<span class="sc">$</span>RESID_SLY, Residual_WeightMatrix, <span class="dv">1000</span>, <span class="at">zero.policy =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="spatial-models-part-1.html#cb198-1" tabindex="-1"></a>Monte<span class="sc">-</span>Carlo simulation of Moran I</span>
<span id="cb198-2"><a href="spatial-models-part-1.html#cb198-2" tabindex="-1"></a></span>
<span id="cb198-3"><a href="spatial-models-part-1.html#cb198-3" tabindex="-1"></a>data<span class="sc">:</span>  spatialdatafile<span class="sc">$</span>RESID_SLY </span>
<span id="cb198-4"><a href="spatial-models-part-1.html#cb198-4" tabindex="-1"></a>weights<span class="sc">:</span> Residual_WeightMatrix  </span>
<span id="cb198-5"><a href="spatial-models-part-1.html#cb198-5" tabindex="-1"></a>number of simulations <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span> <span class="dv">1001</span> </span>
<span id="cb198-6"><a href="spatial-models-part-1.html#cb198-6" tabindex="-1"></a></span>
<span id="cb198-7"><a href="spatial-models-part-1.html#cb198-7" tabindex="-1"></a>statistic <span class="ot">=</span> <span class="fl">0.13417</span>, observed rank <span class="ot">=</span> <span class="dv">1001</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.000999</span></span>
<span id="cb198-8"><a href="spatial-models-part-1.html#cb198-8" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> greater</span></code></pre></div>
<div class="note">
<p><strong>INTERPRETATION</strong>: The Moran’s I from the original model was <code>0.4748</code>. Here, it is <code>0.1341</code> which is much lower thus the lag model has accounted for a lot of spatial autocorrelation although it still significantly remains. We can conclude that spatial lag model does address some of the issues of spatial autocorrelation in the model’s residuals but not all since it significantly positive. This is evidenced in the map output of the residual lags.</p>
</div>
<div class="note">
<p><strong>IMPORTANT NOTE</strong>: We have to make a mental note of this and compare it with the performance of the Spatial Error Model.</p>
</div>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="spatial-models-part-1.html#cb199-1" tabindex="-1"></a><span class="co"># generate the map</span></span>
<span id="cb199-2"><a href="spatial-models-part-1.html#cb199-2" tabindex="-1"></a><span class="fu">tm_shape</span>(spatialdatafile) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">&quot;RESID_SLY&quot;</span>, <span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">palette =</span> <span class="st">&quot;-RdBu&quot;</span>) <span class="sc">+</span></span>
<span id="cb199-3"><a href="spatial-models-part-1.html#cb199-3" tabindex="-1"></a>    <span class="fu">tm_shape</span>(BOROUGHshp) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">border.alpha =</span> <span class="dv">1</span>, <span class="at">border.col =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb199-4"><a href="spatial-models-part-1.html#cb199-4" tabindex="-1"></a>    <span class="fu">tm_text</span>(<span class="st">&quot;BOROUGHN&quot;</span>, <span class="at">size =</span> <span class="st">&quot;AREA&quot;</span>) <span class="sc">+</span></span>
<span id="cb199-5"><a href="spatial-models-part-1.html#cb199-5" tabindex="-1"></a>    <span class="fu">tm_compass</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>)) <span class="sc">+</span></span>
<span id="cb199-6"><a href="spatial-models-part-1.html#cb199-6" tabindex="-1"></a>    <span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb199-7"><a href="spatial-models-part-1.html#cb199-7" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">legend.title.size =</span> <span class="fl">0.5</span>, <span class="at">legend.text.size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="images/general/week10/Tab3-image1.png" width="100%" style="display: block; margin: auto;" /></p>
<p><strong>STEP FOUR</strong></p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="spatial-models-part-1.html#cb200-1" tabindex="-1"></a><span class="co"># Interpretation of results using impacts</span></span>
<span id="cb200-2"><a href="spatial-models-part-1.html#cb200-2" tabindex="-1"></a><span class="co"># impacts</span></span>
<span id="cb200-3"><a href="spatial-models-part-1.html#cb200-3" tabindex="-1"></a>Weights_2<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">as</span>(Residual_WeightMatrix, <span class="st">&quot;CsparseMatrix&quot;</span>)</span>
<span id="cb200-4"><a href="spatial-models-part-1.html#cb200-4" tabindex="-1"></a>trMC <span class="ot">&lt;-</span> <span class="fu">trW</span>(Weights_2<span class="fl">.0</span>, <span class="at">type=</span><span class="st">&quot;MC&quot;</span>)</span>
<span id="cb200-5"><a href="spatial-models-part-1.html#cb200-5" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">impacts</span>(modelSLY, <span class="at">tr =</span> trMC, <span class="at">R=</span><span class="dv">100</span>), <span class="at">zstats=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="spatial-models-part-1.html#cb201-1" tabindex="-1"></a>Impact <span class="fu">measures</span> (lag, trace)<span class="sc">:</span></span>
<span id="cb201-2"><a href="spatial-models-part-1.html#cb201-2" tabindex="-1"></a>                     Direct    Indirect      Total</span>
<span id="cb201-3"><a href="spatial-models-part-1.html#cb201-3" tabindex="-1"></a><span class="fu">log10</span>(IMDSCORE)  <span class="fl">0.04550352</span> <span class="fl">0.034066675</span> <span class="fl">0.07957020</span></span>
<span id="cb201-4"><a href="spatial-models-part-1.html#cb201-4" tabindex="-1"></a><span class="fu">log10</span>(AVEINCOME) <span class="fl">1.26784902</span> <span class="fl">0.949188065</span> <span class="fl">2.21703709</span></span>
<span id="cb201-5"><a href="spatial-models-part-1.html#cb201-5" tabindex="-1"></a><span class="fu">log10</span>(PTAINDEX)  <span class="fl">0.01114883</span> <span class="fl">0.008346682</span> <span class="fl">0.01949551</span></span></code></pre></div>
<div class="note">
<p><strong>INTERPRETATION</strong>: Here is where we derive meaningful interpretation of the coefficients. A big table is churned out - all we care about is the <strong>first</strong> table titled: <code>Impact Measures (lag, trace):</code> and the <strong>last</strong> table titled: <code>Simulated p-values</code>. For instance, let’s interpret the <code>log10(AVEINCOME)</code>(on the log-scale), for the <strong>direct effects</strong> in its own LSOA, if the levels of income were to increase by 1%, this will cause an increase in the property prices by <code>1.267%</code> (p &lt; <code>0.05</code>) in its own LSOA. But for the <strong>indirect affects</strong>, if the <code>log10(AVEINCOME)</code> were to change across neighbouring LSOAs, this will affect the value of our house prices by <code>0.949%</code> (p &lt; <code>0.05</code>). The total column is the combined effect.</p>
</div>
</div>
<div id="spatial-error-models" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Spatial Error Models<a href="spatial-models-part-1.html#spatial-error-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In a Spatial Error Model, we assume that the error terms are correlated across observations (i.e., the error of an observed
value affects the errors of its neighbors).</p>
<p>We essentially repeat the first 3 steps highlighted in section 3.2. for this analysis:</p>
<ul>
<li>Step 1: Fit the Spatial Error Model using the <code>errorsarlm()</code> function.</li>
<li>Step 2: Use the <code>summary()</code> function to report the results for the <span class="math inline">\(\lambda\)</span> parameter and it’s p-value to check if the model is appropriate than a non-spatial one. You can also check with the AIC.</li>
<li>Step 3: Extract the residuals errors and carry out a Moran’s I test using <code>moran.mc()</code> to ensure that the statistic is
less than what was obtained for the Moran’s I test for the linear model. Use the <code>tmap</code> to examine its spatial patterning.</li>
</ul>
<p><strong>STEP ONE</strong></p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="spatial-models-part-1.html#cb202-1" tabindex="-1"></a>modelSER <span class="ot">&lt;-</span> <span class="fu">errorsarlm</span>(<span class="fu">log10</span>(AVEPRICE) <span class="sc">~</span> <span class="fu">log10</span>(IMDSCORE) <span class="sc">+</span> <span class="fu">log10</span>(AVEINCOME) <span class="sc">+</span> <span class="fu">log10</span>(PTAINDEX), <span class="at">data =</span> spatialdatafile_2<span class="fl">.0</span>, Residual_WeightMatrix)</span></code></pre></div>
<p><strong>STEP TWO</strong></p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="spatial-models-part-1.html#cb203-1" tabindex="-1"></a><span class="co"># Report results with summary()</span></span>
<span id="cb203-2"><a href="spatial-models-part-1.html#cb203-2" tabindex="-1"></a><span class="co"># We are interested in the rho-coefficient, log-likelihood ratio test&#39;s p-value and the AIC</span></span>
<span id="cb203-3"><a href="spatial-models-part-1.html#cb203-3" tabindex="-1"></a><span class="fu">summary</span>(modelSER)</span></code></pre></div>
<div class="note">
<p><strong>INTERPRETATION</strong>: The <span class="math inline">\(\lambda\)</span> statistic informs us that if there’s a sudden change in the error term for house prices in neighbouring LSOAs how did it impact the error term for the house price in our LSOA at <span class="math inline">\(y\)</span>. The <span class="math inline">\(\lambda\)</span> value is a positive value of <code>0.7221</code> which means the affect of neighbouring LSOAs are positive and the impact is statistically significant (i.e., p-value &lt; <code>0.05</code>). We can see the AIC for the error model is lower than both the original linear regression &amp; lag model (i.e., Error: <code>-10705.3</code> vs LM: <code>-8510.8</code> &amp; Lag:<code>-9863.3</code>) therefore the error model better than the two.</p>
</div>
<p><strong>IMPORTANT NOTE</strong>: Unlike the lag model, we can interpret the coefficients from the error model for the independent variables! We can interpret them the same way we did for the linear regression model (see <code>section 7.3.3.</code>).</p>
<p><strong>STEP THREE</strong></p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="spatial-models-part-1.html#cb204-1" tabindex="-1"></a><span class="co"># extract the residuals for modelSLY object and dump back to original sf spatialdatafile object</span></span>
<span id="cb204-2"><a href="spatial-models-part-1.html#cb204-2" tabindex="-1"></a>spatialdatafile<span class="sc">$</span>RESID_SER <span class="ot">&lt;-</span> modelSER<span class="sc">$</span>residuals</span>
<span id="cb204-3"><a href="spatial-models-part-1.html#cb204-3" tabindex="-1"></a><span class="co"># use Moran&#39;s I test using moran.mc() function</span></span>
<span id="cb204-4"><a href="spatial-models-part-1.html#cb204-4" tabindex="-1"></a><span class="fu">moran.mc</span>(spatialdatafile<span class="sc">$</span>RESID_SER, Residual_WeightMatrix, <span class="dv">1000</span>, <span class="at">zero.policy =</span> T)</span></code></pre></div>
<div class="note">
<p><strong>INTERPRETATION</strong>: The Moran’s I from the original model was <code>0.4748</code>. Here, it is <code>-0.0579</code> which is negative and the lowest for the error model. On top of that there is no evidence of spatial autocorrelation since its p-value is not significant. Therefore, we can conclude that the spatial error model does address the issue of spatial autocorrelation in the residuals. Its a better model than the Linear regression and Lag model for exploring the relationship with those independent variables and accounting for spatial autocorrelation. This is also evidenced in the map output of the residual errors.</p>
</div>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="spatial-models-part-1.html#cb205-1" tabindex="-1"></a><span class="co"># generate the map</span></span>
<span id="cb205-2"><a href="spatial-models-part-1.html#cb205-2" tabindex="-1"></a><span class="fu">tm_shape</span>(spatialdatafile) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">&quot;RESID_SER&quot;</span>, <span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">palette =</span> <span class="st">&quot;-RdBu&quot;</span>) <span class="sc">+</span></span>
<span id="cb205-3"><a href="spatial-models-part-1.html#cb205-3" tabindex="-1"></a>    <span class="fu">tm_shape</span>(BOROUGHshp) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">border.alpha =</span> <span class="dv">1</span>, <span class="at">border.col =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb205-4"><a href="spatial-models-part-1.html#cb205-4" tabindex="-1"></a>    <span class="fu">tm_text</span>(<span class="st">&quot;BOROUGHN&quot;</span>, <span class="at">size =</span> <span class="st">&quot;AREA&quot;</span>) <span class="sc">+</span></span>
<span id="cb205-5"><a href="spatial-models-part-1.html#cb205-5" tabindex="-1"></a>    <span class="fu">tm_compass</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>)) <span class="sc">+</span></span>
<span id="cb205-6"><a href="spatial-models-part-1.html#cb205-6" tabindex="-1"></a>    <span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb205-7"><a href="spatial-models-part-1.html#cb205-7" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">legend.title.size =</span> <span class="fl">0.5</span>, <span class="at">legend.text.size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="images/general/week10/Tab3-image2.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="using-a-spatially-lagged-model-based-on-independent-variables" class="section level3 hasAnchor" number="8.3.4">
<h3><span class="header-section-number">8.3.4</span> Using a Spatially lagged model based on independent variables<a href="spatial-models-part-1.html#using-a-spatially-lagged-model-based-on-independent-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The code below computes the spatially lagged model based on the independent variables. Briefly, the results are a quite tedious to interpret directly from the regression model. Hence, you will want to use the post estimation <code>impacts()</code> to get the <code>direct</code>, <code>indirect</code> and <code>total</code> coefficients from model:</p>
<details>
<summary>
Click here
</summary>
<p><strong>Solutions</strong></p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="spatial-models-part-1.html#cb206-1" tabindex="-1"></a>modelSLX <span class="ot">&lt;-</span> <span class="fu">lmSLX</span>(<span class="fu">log10</span>(AVEPRICE) <span class="sc">~</span> <span class="fu">log10</span>(IMDSCORE) <span class="sc">+</span> <span class="fu">log10</span>(AVEINCOME) <span class="sc">+</span> <span class="fu">log10</span>(PTAINDEX), <span class="at">data =</span> spatialdatafile_2<span class="fl">.0</span>, Residual_WeightMatrix)</span>
<span id="cb206-2"><a href="spatial-models-part-1.html#cb206-2" tabindex="-1"></a><span class="fu">summary</span>(modelSLX)</span>
<span id="cb206-3"><a href="spatial-models-part-1.html#cb206-3" tabindex="-1"></a></span>
<span id="cb206-4"><a href="spatial-models-part-1.html#cb206-4" tabindex="-1"></a>IMPACTS_SLX <span class="ot">&lt;-</span> <span class="fu">impacts</span>(modelSLX, <span class="at">tr =</span> trMC, <span class="at">R=</span><span class="dv">100</span>)</span>
<span id="cb206-5"><a href="spatial-models-part-1.html#cb206-5" tabindex="-1"></a>IMPACTS_SLX</span></code></pre></div>
</details>
</div>
</div>
<div id="references-see-reading-list-4" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> References (see reading list)<a href="spatial-models-part-1.html#references-see-reading-list-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><strong>Paper</strong>: Guangqing Chi and Jun Zhu (2008) Spatial Regression Models for Demographic Analysis, Popul Res Policy Rev,
27:17-42. <a href="https://link.springer.com/article/10.1007/s11113-007-9051-8"><strong>DOI 10.1007/s11113-007-9051-8</strong></a></li>
<li><strong>Book Chapter</strong>: David Darmofal, (2015), Chapter Six: Spatial Lag and Spatial Error Models (2015). Social Analysis for the Social Sciences. Cambridge Press <a href="https://www.cambridge.org/core/books/abs/spatial-analysis-for-the-social-sciences/spatial-lag-and-spatial-error-models/E2266DD3AB2D6C30E3C539BB5190AA8F#access-block"><strong>Gain Access to PDF via Institutional login</strong></a></li>
<li><strong>Paper</strong>: Wen-Ching Wang, Yu-Ju Chang &amp; Hsueh-Ching Wang, (2019), An Application of the Spatial Autocorrelation Method on the Change of Real Estate Prices in Taitung City. Int Jour Geo-Information, (8)249, <a href="https://www.mdpi.com/2220-9964/8/6/249"><strong>doi:10.3390/ijgi8060249</strong></a></li>
<li><strong>Online Tutorial</strong>: [R Programming] Reka Solymosi and Juanjo Medina (2022) <strong>Crime Mapping in R</strong>, <strong>Chapter 9: Spatial Regression Models</strong> <a href="https://maczokni.github.io/crime_mapping_textbook/spatial-regression-models.html#spatial-regression-models"><strong>Click link</strong></a></li>
</ol>
</div>
<div id="data-sources-5" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Data Sources<a href="spatial-models-part-1.html#data-sources-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>English indices for Multiple Deprivation (IMD) for 2019 [Source: <strong>UK Gov</strong>] <a href="https://www.gov.uk/government/statistics/english-indices-of-deprivation-2019"><strong>Click Here</strong></a></li>
<li>UK Shape files for different geographic units [Source: <strong>Office for National Statistics, Open Geography Portal</strong>] <a href="https://geoportal.statistics.gov.uk"><strong>Click Here</strong></a></li>
<li>The following indicators for averaged house prices, income and PTAL estimates were obtained from <a href="https://data.london.gov.uk/dataset/"><strong>London DATASTORE</strong></a></li>
</ol>
</div>
<div id="useful-videos" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Useful videos<a href="spatial-models-part-1.html#useful-videos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Spatial Regression in R (Part One): The Four Simplest Models (Length: 00:40:36)</strong></p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/b3HtV2Mhmvk" width="711" height="400" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p><a href="https://youtu.be/b3HtV2Mhmvk">[<strong>Watch on YouTube</strong>]</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="geostatistical-modelling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spatial-models-part-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": true
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/UCLPG-MSC-SGDS/GEOG0114/edit/main/08-Spatial_regression_models_lags_and_errors.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
